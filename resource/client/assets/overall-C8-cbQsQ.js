import{_ as at}from"./index.vue_vue_type_script_setup_true_lang-CN4QwITc.js";import{a as it,h as dt,i as g,o as f,b as _,f as e,c as o,k,u as y,l as r,F as rt,j as ut,t as b,w as n,A as vt,C as mt,n as ft,G as pt,s as x,v as ct,m as gt,B as _t,g as yt}from"./index-eTN858IF.js";import{P as bt,C as xt,g as kt}from"./common-WSqv98V6.js";import{a as Ct,g as Dt,c as Vt}from"./dataset-CbZsxAcs.js";import{E as wt,L as Yt}from"./index-D3fkmBzT.js";import{I as Mt}from"./ImportOutlined-CehIvsfg.js";import"./index-DpR8vo3Y.js";const W="/assets/no_version-BEzpnnSj.png";function Ot(M,V="YYYY-MM-DD HH:mm:ss"){if(!M)return"";const u=new Date(M);if(isNaN(u.getTime()))throw new Error("Invalid date string");const v=p=>p<10?`0${p}`:`${p}`,O={YYYY:u.getFullYear().toString(),MM:v(u.getMonth()+1),DD:v(u.getDate()),HH:v(u.getHours()),mm:v(u.getMinutes()),ss:v(u.getSeconds())};return V.replace(/YYYY|MM|DD|HH|mm|ss/g,p=>O[p])}const At={class:"content-box"},Et={class:"pageBreadTitle"},Ht={class:"version-main"},Lt={key:0,class:"common-load-box"},Nt={class:"version-main-menu"},Bt={class:"version-main-menu-head"},Tt={key:0,class:"version-scroll-bar"},It=["onClick"],St={class:"txt"},$t={key:1,class:"version-scroll-empty"},Ft={key:1,class:"version-detail"},jt={class:"version-detail-title"},qt={class:"txt"},zt={class:"version-info-flex"},Pt={class:"version-info-item"},Rt={class:"txt2"},Gt={class:"version-info-item"},Jt={class:"txt2"},Ut={class:"version-info-item"},Zt={class:"txt2"},Kt={class:"version-info-item"},Qt={class:"txt2"},Wt={class:"version-info-item"},Xt={class:"txt2"},ht={class:"version-info-flex"},te={class:"common-btn default padding ver-btn-l"},ee={class:"common-btn default padding ver-btn-l"},se={class:"common-btn default padding ver-btn-l"},oe={key:2,class:"version-detail-empty"},le={class:"modal-text"},ne=it({__name:"overall",setup(M){const[V,u]=dt.useMessage(),v=g([]),O=ft(),p=pt(),C=g();C.value=Number(p.query.id)||null;const d=g(!0),c=g(),l=g(),m=g();function X(s){d.value||(c.value=s.id,l.value=s,H())}const D=g(!1),A=g(!1),h=()=>{D.value=!0},L=()=>{A.value=!0,Ct(c.value).then(s=>{s&&s.code===0&&(V.success("删除成功！"),c.value=void 0,l.value=void 0,E())}).finally(()=>{A.value=!1,D.value=!1})},tt=()=>{D.value=!1},N=()=>{xt.show(C.value,s=>{s&&E()})};function E(){if(!p.query.id)return d.value=!1;d.value=!0,Dt({page:1,size:999,dataset_id:C.value}).then(s=>{var t,a;m.value=s.data.list,!c.value&&((t=m.value)!=null&&t.length)&&(c.value=(a=m.value[0])==null?void 0:a.id,l.value=m.value[0],H())}).finally(()=>d.value=!1)}function H(){d.value=!0,Vt(c.value).then(s=>{s&&s.code===0&&(l.value=s.data)}).finally(()=>d.value=!1)}function et(){kt().then(s=>{s&&(s==null?void 0:s.code)===0&&s.data.forEach(t=>{var a;(a=v.value)==null||a.push({value:t.name,label:t.label})})})}function st(s){var a;let t="";return(a=v.value)==null||a.forEach(w=>{w.value===s&&(t=w.label)}),t}function ot(){var t;const s={dataset_id:C.value,version_id:(t=l.value)==null?void 0:t.id};Yt.show(s,a=>{a&&(H(),V.success("数据导入成功！"))})}et(),E();function B(s,t,a){O.push({path:s,query:{id:t,vid:a}})}return(s,t)=>{var $,F,j,q,z,P,R,G,J,U,Z,K,Q;const a=x("a-spin"),w=x("a-tag"),Y=x("a-menu-item"),T=x("a-menu"),I=x("a-dropdown"),S=x("a-button"),lt=x("a-modal");return f(),_("div",At,[e("div",Et,[e("div",{class:"bread-item cursor-bread",onClick:t[0]||(t[0]=i=>B("/home",""))}," 数据总览 "),t[3]||(t[3]=e("div",{class:"bread-item"},">",-1)),t[4]||(t[4]=e("div",{class:"bread-item curr-bread"},"全部版本",-1))]),e("div",Ht,[d.value?(f(),_("div",Lt,[o(a)])):k("",!0),e("div",Nt,[e("div",Bt,[o(at,{options:v.value,marginLeft:"0px"},null,8,["options"]),e("button",{class:"common-btn confirm padding",onClick:N,style:{"margin-left":"10px"}},[o(y(bt)),t[5]||(t[5]=r(" 创建新版本 "))])]),!d.value&&(($=m.value)!=null&&$.length)?(f(),_("div",Tt,[(f(!0),_(rt,null,ut(m.value,(i,nt)=>(f(),_("div",{class:ct(["version-item",{active:c.value===i.id,disabled:d.value}]),key:nt,onClick:ae=>X(i)},[e("div",St,"V"+b(i.version)+"版本",1)],10,It))),128))])):k("",!0),!d.value&&!((F=m.value)!=null&&F.length)?(f(),_("div",$t,t[6]||(t[6]=[e("img",{src:W,alt:""},null,-1),e("span",null,"暂无版本",-1)]))):k("",!0)]),!d.value&&((j=m.value)!=null&&j.length)?(f(),_("div",Ft,[e("div",jt,[e("div",qt,"版本：V"+b((q=l.value)==null?void 0:q.version),1),o(w,{bordered:!1,color:"warning",style:{"margin-inline-end":"0","margin-left":"20px"}},{default:n(()=>t[7]||(t[7]=[r("未发布")])),_:1}),e("button",{onClick:h,class:"common-btn noborder bleft padding"},[o(y(vt)),t[8]||(t[8]=r(" 删除 "))])]),e("div",zt,[e("div",Pt,[t[9]||(t[9]=e("div",{class:"txt1"},"创建时间",-1)),e("div",Rt,b((z=l.value)!=null&&z.created_at?y(Ot)((P=l.value)==null?void 0:P.created_at):""),1)]),e("div",Gt,[t[10]||(t[10]=e("div",{class:"txt1"},"算法类型",-1)),e("div",Jt,b((R=l.value)!=null&&R.alg_type?st((G=l.value)==null?void 0:G.alg_type):""),1)]),t[14]||(t[14]=e("div",{class:"version-info-item"},[e("div",{class:"txt1"},"继承版本"),e("div",{class:"txt2"},"-/-")],-1)),e("div",Ut,[t[11]||(t[11]=e("div",{class:"txt1"},"版本备注",-1)),e("div",Zt,b((J=l.value)!=null&&J.remark?(U=l.value)==null?void 0:U.remark:"-/-"),1)]),t[15]||(t[15]=e("div",{class:"version-info-item"},[e("div",{class:"txt1"},"数据状态"),e("div",{class:"txt2"},"未达到训练标准")],-1)),e("div",Kt,[t[12]||(t[12]=e("div",{class:"txt1"},"有目标标注图片数/总图片数",-1)),e("div",Qt,"0/"+b((Z=l.value)==null?void 0:Z.image_num),1)]),t[16]||(t[16]=e("div",{class:"version-info-item"},[e("div",{class:"txt1"},"标签数量"),e("div",{class:"txt2"},"0")],-1)),e("div",Wt,[t[13]||(t[13]=e("div",{class:"txt1"},"数据状态",-1)),e("div",Xt,b((K=l.value)!=null&&K.status?"已发布":"未发布"),1)])]),e("div",ht,[e("button",{class:"common-btn default padding",onClick:t[1]||(t[1]=i=>B("/data/overall/gallery",C.value,c.value))},[o(y(mt)),t[17]||(t[17]=r(" 查看详情 "))]),o(I,{trigger:["hover"]},{overlay:n(()=>[o(T,null,{default:n(()=>[o(Y,{key:"1"},{default:n(()=>[e("div",{class:"gallery-dropdown",onClick:ot}," 本地数据 ")]),_:1}),o(Y,{key:"2",disabled:!0,style:{opacity:"0.5"}},{default:n(()=>t[19]||(t[19]=[e("div",{class:"gallery-dropdown"},"已有数据集",-1)])),_:1})]),_:1})]),default:n(()=>[e("button",te,[o(y(Mt)),t[18]||(t[18]=r(" 数据导入 "))])]),_:1}),e("button",ee,[o(y(wt)),t[20]||(t[20]=r(" 标注图片 "))]),o(I,{trigger:["hover"]},{overlay:n(()=>[o(T,null,{default:n(()=>{var i;return[(i=l.value)!=null&&i.status?k("",!0):(f(),gt(Y,{key:"1"},{default:n(()=>t[22]||(t[22]=[e("div",{class:"gallery-dropdown"},"发布版本",-1)])),_:1})),o(Y,{key:"2",disabled:!0,style:{opacity:"0.5"}},{default:n(()=>t[23]||(t[23]=[e("div",{class:"gallery-dropdown"},"前往训练",-1)])),_:1})]}),_:1})]),default:n(()=>[e("button",se,[o(y(_t)),t[21]||(t[21]=r(" 更多操作 "))])]),_:1})]),t[24]||(t[24]=e("div",{class:"version-info-flex version-trace"},[e("div",{class:"txt2"},"继承路径")],-1)),t[25]||(t[25]=e("div",{class:"version-traceability"},null,-1))])):k("",!0),!d.value&&!((Q=m.value)!=null&&Q.length)?(f(),_("div",oe,[t[28]||(t[28]=e("img",{src:W,alt:""},null,-1)),e("div",{class:"txt"},[t[26]||(t[26]=r(" 您需要 ")),e("span",{onClick:N},"创建新版本"),t[27]||(t[27]=r(", 才能进行数据的上传、标注等操作 "))])])):k("",!0)]),o(y(u)),o(lt,{open:D.value,"onUpdate:open":t[2]||(t[2]=i=>D.value=i),title:"提示",onOk:L},{footer:n(()=>[o(S,{key:"back",onClick:tt},{default:n(()=>t[29]||(t[29]=[r("取消")])),_:1}),o(S,{key:"submit",type:"primary",loading:A.value,onClick:L},{default:n(()=>t[30]||(t[30]=[r("确认")])),_:1},8,["loading"])]),default:n(()=>{var i;return[e("div",le," 确定删除 V"+b((i=l.value)==null?void 0:i.version)+" 版本 ? ",1),t[31]||(t[31]=e("div",{class:"modal-desc"}," 删除后，该版本的数据不可恢复，但不影响所属数据集下其他版本。 ",-1))]}),_:1},8,["open"])])}}}),pe=yt(ne,[["__scopeId","data-v-c7f0b262"]]);export{pe as default};
