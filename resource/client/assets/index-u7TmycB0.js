const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-B_6PaG0t.js","assets/index-eTN858IF.js","assets/index-CpWHfjKY.css","assets/ImportOutlined-CehIvsfg.js","assets/FilterOutlined-C9itOJfD.js","assets/index-DwDt_gOu.css"])))=>i.map(i=>d[i]);
var vl=Object.defineProperty;var kl=(i,t,e)=>t in i?vl(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e;var x=(i,t,e)=>kl(i,typeof t!="symbol"?t+"":t,e);import{c as J,I as bl,a as fh,i as gt,L as Tl,N as Sl,O as Cl,o as H,b as tt,f as k,v as Qe,Q as dn,k as Xi,F as ve,j as De,T as un,U as Pl,u as ft,K as Bl,V as io,t as we,g as _h,d as Rl,r as El,_ as Ol,h as Il,W as Ml,X as Al,l as fn,Y as Dl,Z as Ll,S as Wl,m as Di,w as Et,n as zl,s as Oe,B as $l,R as Ul,x as Fl,A as so,y as _n,$ as Nl,a0 as Gl}from"./index-eTN858IF.js";import{I as Hl}from"./ImportOutlined-CehIvsfg.js";import{F as jl}from"./FilterOutlined-C9itOJfD.js";var Vl={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm192 472c0 4.4-3.6 8-8 8H544v152c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8V544H328c-4.4 0-8-3.6-8-8v-48c0-4.4 3.6-8 8-8h152V328c0-4.4 3.6-8 8-8h48c4.4 0 8 3.6 8 8v152h152c4.4 0 8 3.6 8 8v48z"}}]},name:"plus-circle",theme:"filled"};function no(i){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?Object(arguments[t]):{},s=Object.keys(e);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(e).filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),s.forEach(function(n){Yl(i,n,e[n])})}return i}function Yl(i,t,e){return t in i?Object.defineProperty(i,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):i[t]=e,i}var Or=function(t,e){var s=no({},t,e.attrs);return J(bl,no({},s,{icon:Vl}),null)};Or.displayName="PlusCircleFilled";Or.inheritAttrs=!1;const Zl="data:image/svg+xml,%3csvg%20t='1735197331781'%20viewBox='0%200%201024%201024'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cpath%20d='M518.4%20965.248c-240%200-435.2-195.2-435.2-435.2s195.2-435.2%20435.2-435.2%20435.2%20195.2%20435.2%20435.2-195.2%20435.2-435.2%20435.2z%20m0-819.2c-211.712%200-384%20172.288-384%20384s172.288%20384%20384%20384%20384-172.288%20384-384-172.288-384-384-384z'%20fill='%23262B3B'%20p-id='7138'%3e%3c/path%3e%3cpath%20d='M352%20440.448m-51.2%200a51.2%2051.2%200%201%200%20102.4%200%2051.2%2051.2%200%201%200-102.4%200Z'%20fill='%23262B3B'%20p-id='7139'%3e%3c/path%3e%3cpath%20d='M518.4%20440.448m-51.2%200a51.2%2051.2%200%201%200%20102.4%200%2051.2%2051.2%200%201%200-102.4%200Z'%20fill='%23262B3B'%20p-id='7140'%3e%3c/path%3e%3cpath%20d='M684.8%20440.448m-51.2%200a51.2%2051.2%200%201%200%20102.4%200%2051.2%2051.2%200%201%200-102.4%200Z'%20fill='%23262B3B'%20p-id='7141'%3e%3c/path%3e%3cpath%20d='M352%20619.648m-51.2%200a51.2%2051.2%200%201%200%20102.4%200%2051.2%2051.2%200%201%200-102.4%200Z'%20fill='%23262B3B'%20p-id='7142'%3e%3c/path%3e%3cpath%20d='M518.4%20619.648m-51.2%200a51.2%2051.2%200%201%200%20102.4%200%2051.2%2051.2%200%201%200-102.4%200Z'%20fill='%23262B3B'%20p-id='7143'%3e%3c/path%3e%3cpath%20d='M684.8%20619.648m-51.2%200a51.2%2051.2%200%201%200%20102.4%200%2051.2%2051.2%200%201%200-102.4%200Z'%20fill='%23262B3B'%20p-id='7144'%3e%3c/path%3e%3c/svg%3e",Kl="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAABIpJREFUSA3dVc9vG0UU/mZ/epM4bnCcFjAlKlKDEg5IoN4Q4VgJiVMQR07tjRMggURjS/wDiBtIXAAhmisSJ4RBXAtIVROIqtAGNQm20rTx2hvPzs7wzW5cHClN7oxkz+68ne9773vvzQD/v2GMKILi3DCOGb5zbvAdOLQP109R4BDs8KvDTQ1AtFpw8BOwuEzbKpxX29BNPtYWYRbIwm+MgYAQMFx+7PiPYAScgB4SeOM+xGYCd6wG0e/AeE8jrSiY3TWYVy5DLQHaIgshHktyhKDBb3dvw88k/MkMvhtjrCfgc3sqPDheCOMGSDb/ItGz0DOAXJ5HehKJZ412WBfeIXjvHwTjGiVVwS8qwjmKrqiE0gYqzSBlgl9npnFNxtjZrEA0V7lxBYq5OjaSgoDyNFtwq7MQngN/4KCSKpwzMJOWnIFZwfnjCjBrHDHvOnjLeYCdrRqc8BIOmk2kx5HQwcL7rTJRQjg9hTCIMJEaZEoL0GtMBwbnI+pE9JSqqwzPJym+pVzP9O9hrPskot1L8EkiHlWdBebICVgJWP8OJtmC7/gIe/0cRKfUpRYKfPSCwLvzAi+eIQEJ7XqamblkgK9NCXXVRdSNChILOkqSE9jF7uuslDYMPTTw4RMokwQLHZudYpRsQtgGlkTlkZiLWuIr46I+iBCu+ShdvcEKzEfRL4VExLjCxZ0IOmVCjYZLOVILcusB8OkfBl/cNvhhu/BeZjTSlkej9EWZ4kup8ZTyuv56txNe/eyGl1cNc0sCYxXCN12Y0hOUaYBMp0gIsJbrTfKf28D394CEntuojkRBR6U2c9kAn5dVecxTNVcGVXdphfITmQRFkywuQk/3oKsBtBhDz1P4JM3EHQtIvYvkDr22a/Y5fy9sA6VforuzRnS9P8c90WFz2tLLJSo0A3oB1E4bsiehEhdbnov36O3d3GOCWWmUrST7s6SWyOaEtsw42yqSexVVDur1OmrsfIvr5uCsrxb7vby+KMpVdmvIVQ1Pa0gm8Hdq/DILp6LpVMaHjKDEh85nA63FvnDF+2Hi3mEUfSeExD6y1QVi5QT2r9Uyb//YQIfnV6XOHuizoh6ynlwkwhO/SVWQ2APOFpptPjuYx24pFB+Q9+YgQ5yUED8XI43fgF6lSEckagihcQvZ3h4Uj4w+z5/d9EB2KcFG6OkPiXc379ZH4Oh6Qlxj462qAWIdo3exDDn4G3qhab0QjPGYsXTduPEEPD9F4E1hIk5kVWdiAo5/nnIv88CY57a2K8zH1Oem8b37PCDvR8D+2Yg57CBdeVMwQ8M4TyFRkxiPe3LKEUFIfc4gwFmK23YVeupAJk4Q7HkxutEe0tIVDFZEAX4igTUOI0mijo9yraR2MOmNw9GKueFQMQvLQVwe4GCKRcbSTFuvCWVtw3GsREOjnS3JxgU4geQFFCDo7yKsRDBZAiFnIIM20rmM5c0LaNTzIcaRJA8XR2er5YUNaMke8ds4MGUmlo24HmA/2kZSeYi0epmaj8gyuv/UCIYfFxc+35Z5Pq0g71R7P19nO5x0Zf4LtgB6dLgAC38AAAAASUVORK5CYII=",Xl="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAAGXcA1uAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAGKADAAQAAAABAAAAGAAAAADiNXWtAAAFx0lEQVRIDbVVW2hcVRRd59zHzCSTmSQT+5jW2sbGR4IoBgXRaLWiIhVUTBEVFF8ICiJ++CPMpIj44V+xIFjwS8RB/bA/9VWxVRGt9mH6sDUmMZ2myUzmPfd5znGfmSZO9MMf3cw9c+89Z6/9WHvvC3QIU0qxU7sK8ojdDZbNKt4/K8Rcvdlxhm7Z/t3lLfG8nPrsfCVm5o7OYzAYwnxsKcHaBxXpwigWzxrz8z+HudxOqcHMMa8WqHyI7e/24Y0nFZbqzpGWht5cnDqVZGZ3xDeDRjo9WFttsuPpokaWA+NmPu+ot98eDRlj2qgyH4kXg2ZR4VxXBD+cts9g6xtXcY197gxw7esDuO2FOLoSxlA+vyNqqrj0Tsj+yk9PyqQDhkWn+nBaxEKyodizz56PAX4ywUPhWaqye/eQ1+HHP24vBr/6/cWX2rmvjJvXX5m+oqvrN89RpssY5hZN/HLaeKe5Zep5YDjMZlkrU7xevxB7LGXXVVFCNgSu37OmBTv5WYBD+4GFYoBGGO4odSU+NWmHOwul6Cm26Yis4DrpcvBPBIbGOPa9x0HJQanchJcqnAYaVovliQkYTn6q2wWScd43llTJjOsF6wr1+n6WKLwKbpd5z3w1mbzJ6wisxax+puyf4MWizTyvIkt3jsoPxiHJEAlTev1PpMPyarzlDR0Ldu7M8b6+QR6JJHkq5ZP5YQlMyGw2Q/dtd1oKuqLJb/OJKza8JZviaVcwOLaF775hYcH3L8fg0Xw2u01oJSKMSmz6cfvRGxLHZEUO+U0Fjyqjatuo9lg4PinhmcaguTH6RyYDQfWirAeHCnetq7J9qqKw9t5urL+bSohk70sewpiBmSkfwaW1eDy+1iFXDlvcs18rVQ2U6wb6b4ysRFkoGqiWDIShgCaXNjgpAJ/MLjx0QURwXkXx/otUBiWF7/dJhNwg90IEEsfQ08Yx06VYOJ9itSnpjyfMnlxANb7nZQVfUT5MicJio9y45ML9tpK6tCXHyHAYiy3UZmXh60kxc5UXDT4SJpyGV5spNApPYe3StZxbS2vWDLsUtIYBdFqp2S2gPxIJSlHXt03flMpyHT+IJp10er1PA6Gd1rZniogDdubA+z4//DfiQMRhhbj2+f9xXS6lv5uguiEn6KdlYmKCzmXaDyvrBDIZXWIktMv0sqKhb9uyyoCesBpscnKYjYyMMz0kn7t+4OruuPm8EPJWz2EbaosSv5/GuYpnfd2MqbemoudPplJbxeRkTo2MnFDaqB54HQba+aSm1saoTqbN7QPxTZdGrU+lLy4TnoIIFKRkCOmIzzg8q325RPrJ44DrGTMB8+/CYHEW2BwSjmwxrCPTXueIrIMHz+pxE3nm8oGPLVfcoVwCJXDpM+hOXHNPvFXF2rW5HwMc+yKEa9AIsgw4rsTcjE4q+7KSmnuAjnhjY1vDcT04stkDJqY3m44tI/cNDewz6vIW1qAuJiUE5Ar5M/pmP+zeVhOQbluaZYW9rwRU/RzMJkNSoLjgkxHjEHrzO2I+97B5OiStbcjbEV4iX2bL8sOia6Ho0xVEsOjZrev3gzrq1XL8EFCjs45nwHUUKuUAfiDIJzensTSmxl6JoIxyVJjxeDp2yfBaGc9RYyVUSGOcciKImpD+9fclpN7RXBAlLcaYIWlK14knNGSPeEBGl04a8Xq9t7eXZvR02OLg9omvjGuKGw1SiXDHiAn4Xb3R3i0DIrVLSX6zJliQJamByZAeyAEhVmtNBEp9i6i7S3RVfzVgN2VMOITjHU/NiQOZbTQKqZ11V3ZWUXPWsxqxuM0cGQltYduutKTNDcZ0SklDmZL7UvhRHpi+4fum4/eG/V7XpnqQzxdFOj0qVqpIKyzLch8MT2bYiRG0+oA+JUYisZFxbnDH4SxFh5sxqer1BRWG5EEkKfTn5s7SqCQd6gPyeHUfLMN3/uuodJIpNJJ/7WRKXRvzrwZrKdLyJ7hdE8tU1XvDAAAAAElFTkSuQmCC",S={toURL(i,t){let e=encodeURIComponent(i);return t==="text"?e="data:text/plain;charset=utf-8,"+e:t==="svg"&&(e="data:image/svg+xml,"+e),e},image:{hitCanvasSize:100,maxCacheSize:2560*1600,maxPatternSize:4096*2160,crossOrigin:"anonymous",getRealURL(i){const{prefix:t,suffix:e}=S.image;return e&&!i.startsWith("data:")&&!i.startsWith("blob:")&&(i+=(i.includes("?")?"&":"?")+e),t&&i[0]==="/"&&(i=t+i),i}}},ct={},Te={RUNTIME:"runtime",LEAF:"leaf",TASK:"task",CNAVAS:"canvas",IMAGE:"image",types:{},create(i){const{types:t}=ql;return t[i]?t[i]++:(t[i]=1,0)}},ql=Te,{round:Ql,pow:Jl,PI:Ir}=Math,bt={within(i,t,e){return typeof t=="object"&&(e=t.max,t=t.min),t!==void 0&&i<t&&(i=t),e!==void 0&&i>e&&(i=e),i},fourNumber(i,t){let e;if(i instanceof Array)switch(i.length){case 4:e=t===void 0?i:[...i];break;case 2:e=[i[0],i[1],i[0],i[1]];break;case 3:e=[i[0],i[1],i[2],i[1]];break;case 1:i=i[0];break;default:i=0}if(e||(e=[i,i,i,i]),t)for(let s=0;s<4;s++)e[s]>t&&(e[s]=t);return e},formatRotation(i,t){return i%=360,t?i<0&&(i+=360):(i>180&&(i-=360),i<-180&&(i+=360)),bt.float(i)},getGapRotation(i,t,e=0){let s=i+e;if(t>1){const n=Math.abs(s%t);(n<1||n>t-1)&&(s=Math.round(s/t)*t)}return s-e},float(i,t){const e=t!==void 0?Jl(10,t):1e12;return i=Ql(i*e)/e,i===-0?0:i},getScaleData(i,t,e,s){return s||(s={}),t?(s.scaleX=(typeof t=="number"?t:t.width)/e.width,s.scaleY=(typeof t=="number"?t:t.height)/e.height):i&&bt.assignScale(s,i),s},assignScale(i,t){typeof t=="number"?i.scaleX=i.scaleY=t:(i.scaleX=t.x,i.scaleY=t.y)}},Z=Ir/180,Ht=Ir*2,xi=Ir/2;function ph(){return{x:0,y:0}}function gh(){return{x:0,y:0,width:0,height:0}}function Fs(){return{a:1,b:0,c:0,d:1,e:0,f:0}}const{sin:pn,cos:gn,acos:ps,sqrt:yn}=Math,{float:ci}=bt,di={};function ro(){return Object.assign(Object.assign(Object.assign({},Fs()),gh()),{scaleX:1,scaleY:1,rotation:0,skewX:0,skewY:0})}const z={defaultMatrix:Fs(),defaultWorld:ro(),tempMatrix:{},set(i,t=1,e=0,s=0,n=1,r=0,o=0){i.a=t,i.b=e,i.c=s,i.d=n,i.e=r,i.f=o},get:Fs,getWorld:ro,copy(i,t){i.a=t.a,i.b=t.b,i.c=t.c,i.d=t.d,i.e=t.e,i.f=t.f},translate(i,t,e){i.e+=t,i.f+=e},translateInner(i,t,e,s){i.e+=i.a*t+i.c*e,i.f+=i.b*t+i.d*e,s&&(i.e-=t,i.f-=e)},scale(i,t,e=t){i.a*=t,i.b*=t,i.c*=e,i.d*=e},scaleOfOuter(i,t,e,s){it.toInnerPoint(i,t,di),it.scaleOfInner(i,di,e,s)},scaleOfInner(i,t,e,s=e){it.translateInner(i,t.x,t.y),it.scale(i,e,s),it.translateInner(i,-t.x,-t.y)},rotate(i,t){const{a:e,b:s,c:n,d:r}=i;t*=Z;const o=gn(t),a=pn(t);i.a=e*o-s*a,i.b=e*a+s*o,i.c=n*o-r*a,i.d=n*a+r*o},rotateOfOuter(i,t,e){it.toInnerPoint(i,t,di),it.rotateOfInner(i,di,e)},rotateOfInner(i,t,e){it.translateInner(i,t.x,t.y),it.rotate(i,e),it.translateInner(i,-t.x,-t.y)},skew(i,t,e){const{a:s,b:n,c:r,d:o}=i;e&&(e*=Z,i.a=s+r*e,i.b=n+o*e),t&&(t*=Z,i.c=r+s*t,i.d=o+n*t)},skewOfOuter(i,t,e,s){it.toInnerPoint(i,t,di),it.skewOfInner(i,di,e,s)},skewOfInner(i,t,e,s=0){it.translateInner(i,t.x,t.y),it.skew(i,e,s),it.translateInner(i,-t.x,-t.y)},multiply(i,t){const{a:e,b:s,c:n,d:r,e:o,f:a}=i;i.a=t.a*e+t.b*n,i.b=t.a*s+t.b*r,i.c=t.c*e+t.d*n,i.d=t.c*s+t.d*r,i.e=t.e*e+t.f*n+o,i.f=t.e*s+t.f*r+a},multiplyParent(i,t,e,s,n,r){let{e:o,f:a}=i;if(r&&(o+=r.scrollX,a+=r.scrollY),e||(e=i),s===void 0&&(s=i.a!==1||i.b||i.c||i.d!==1),s){const{a:h,b:l,c,d:p}=i;e.a=h*t.a+l*t.c,e.b=h*t.b+l*t.d,e.c=c*t.a+p*t.c,e.d=c*t.b+p*t.d,n&&(e.scaleX=t.scaleX*n.scaleX,e.scaleY=t.scaleY*n.scaleY)}else e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,n&&(e.scaleX=t.scaleX,e.scaleY=t.scaleY);e.e=o*t.a+a*t.c+t.e,e.f=o*t.b+a*t.d+t.f},divide(i,t){it.multiply(i,it.tempInvert(t))},divideParent(i,t){it.multiplyParent(i,it.tempInvert(t))},tempInvert(i){const{tempMatrix:t}=it;return it.copy(t,i),it.invert(t),t},invert(i){const{a:t,b:e,c:s,d:n,e:r,f:o}=i;if(!e&&!s)if(t===1&&n===1)i.e=-r,i.f=-o;else{const a=1/(t*n);i.a=n*a,i.d=t*a,i.e=-r*n*a,i.f=-o*t*a}else{const a=1/(t*n-e*s);i.a=n*a,i.b=-e*a,i.c=-s*a,i.d=t*a,i.e=-(r*n-o*s)*a,i.f=-(o*t-r*e)*a}},toOuterPoint(i,t,e,s){const{x:n,y:r}=t;e||(e=t),e.x=n*i.a+r*i.c,e.y=n*i.b+r*i.d,s||(e.x+=i.e,e.y+=i.f)},toInnerPoint(i,t,e,s){const{a:n,b:r,c:o,d:a}=i,h=1/(n*a-r*o),{x:l,y:c}=t;if(e||(e=t),e.x=(l*a-c*o)*h,e.y=(c*n-l*r)*h,!s){const{e:p,f}=i;e.x-=(p*a-f*o)*h,e.y-=(f*n-p*r)*h}},setLayout(i,t,e,s,n){const{x:r,y:o,scaleX:a,scaleY:h}=t;if(n===void 0&&(n=t.rotation||t.skewX||t.skewY),n){const{rotation:l,skewX:c,skewY:p}=t,f=l*Z,d=gn(f),u=pn(f);if(c||p){const y=c*Z,v=p*Z;i.a=(d+v*-u)*a,i.b=(u+v*d)*a,i.c=(-u+y*d)*h,i.d=(d+y*u)*h}else i.a=d*a,i.b=u*a,i.c=-u*h,i.d=d*h}else i.a=a,i.b=0,i.c=0,i.d=h;i.e=r,i.f=o,(e=e||s)&&it.translateInner(i,-e.x,-e.y,!s)},getLayout(i,t,e,s){const{a:n,b:r,c:o,d:a,e:h,f:l}=i;let c=h,p=l,f,d,u,y,v;if(r||o){const C=n*a-r*o;if(o&&!s){f=yn(n*n+r*r),d=C/f;const T=n/f;u=r>0?ps(T):-ps(T)}else{d=yn(o*o+a*a),f=C/d;const T=o/d;u=xi-(a>0?ps(-T):-ps(T))}const m=ci(gn(u)),I=pn(u);f=ci(f),d=ci(d),y=m?ci((o/d+I)/m/Z,9):0,v=m?ci((r/f-I)/m/Z,9):0,u=ci(u/Z)}else f=n,d=a,u=y=v=0;return(t=e||t)&&(c+=t.x*n+t.y*o,p+=t.x*r+t.y*a,e||(c-=t.x,p-=t.y)),{x:c,y:p,scaleX:f,scaleY:d,rotation:u,skewX:y,skewY:v}},withScale(i,t,e=t){const s=i;if(!t||!e){const{a:n,b:r,c:o,d:a}=i;r||o?(t=yn(n*n+r*r),e=(n*a-r*o)/t):(t=n,e=a)}return s.scaleX=t,s.scaleY=e,s},reset(i){it.set(i)}},it=z,{toInnerPoint:mn,toOuterPoint:oo}=z,{sin:ao,cos:ho,abs:lo,sqrt:tc,atan2:xn,min:ec,PI:ic}=Math,D={defaultPoint:ph(),tempPoint:{},tempRadiusPoint:{},set(i,t=0,e=0){i.x=t,i.y=e},setRadius(i,t,e){i.radiusX=t,i.radiusY=e===void 0?t:e},copy(i,t){i.x=t.x,i.y=t.y},copyFrom(i,t,e){i.x=t,i.y=e},move(i,t,e){i.x+=t,i.y+=e},scale(i,t,e=t){i.x&&(i.x*=t),i.y&&(i.y*=e)},scaleOf(i,t,e,s=e){i.x+=(i.x-t.x)*(e-1),i.y+=(i.y-t.y)*(s-1)},rotate(i,t,e){e||(e=qe.defaultPoint),t*=Z;const s=ho(t),n=ao(t),r=i.x-e.x,o=i.y-e.y;i.x=e.x+r*s-o*n,i.y=e.y+r*n+o*s},tempToInnerOf(i,t){const{tempPoint:e}=qe;return vn(e,i),mn(t,e,e),e},tempToOuterOf(i,t){const{tempPoint:e}=qe;return vn(e,i),oo(t,e,e),e},tempToInnerRadiusPointOf(i,t){const{tempRadiusPoint:e}=qe;return vn(e,i),qe.toInnerRadiusPointOf(i,t,e),e},toInnerRadiusPointOf(i,t,e){e||(e=i),mn(t,i,e),e.radiusX=Math.abs(i.radiusX/t.scaleX),e.radiusY=Math.abs(i.radiusY/t.scaleY)},toInnerOf(i,t,e){mn(t,i,e)},toOuterOf(i,t,e){oo(t,i,e)},getCenter(i,t){return{x:i.x+(t.x-i.x)/2,y:i.y+(t.y-i.y)/2}},getCenterX(i,t){return i+(t-i)/2},getCenterY(i,t){return i+(t-i)/2},getDistance(i,t){return wn(i.x,i.y,t.x,t.y)},getDistanceFrom(i,t,e,s){const n=lo(e-i),r=lo(s-t);return tc(n*n+r*r)},getMinDistanceFrom(i,t,e,s,n,r){return ec(wn(i,t,e,s),wn(e,s,n,r))},getAngle(i,t){return co(i,t)/Z},getRotation(i,t,e,s){return s||(s=t),qe.getRadianFrom(i.x,i.y,t.x,t.y,e.x,e.y,s.x,s.y)/Z},getRadianFrom(i,t,e,s,n,r,o,a){o===void 0&&(o=e,a=s);let h=xn(t-s,i-e);const c=xn(r-a,n-o)-h;return c<-ic?c+Ht:c},getAtan2(i,t){return xn(t.y-i.y,t.x-i.x)},getDistancePoint(i,t,e,s){const n=co(i,t);return t=s?t:{},t.x=i.x+ho(n)*e,t.y=i.y+ao(n)*e,t},toNumberPoints(i){let t=i;return typeof i[0]=="object"&&(t=[],i.forEach(e=>t.push(e.x,e.y))),t},reset(i){}},qe=D,{getDistanceFrom:wn,copy:vn,getAtan2:co}=qe;class qi{constructor(t,e){this.set(t,e)}set(t,e){return typeof t=="object"?D.copy(this,t):D.set(this,t,e),this}get(){const{x:t,y:e}=this;return{x:t,y:e}}clone(){return new qi(this)}move(t,e){return D.move(this,t,e),this}scale(t,e){return D.scale(this,t,e),this}scaleOf(t,e,s){return D.scaleOf(this,t,e,s),this}rotate(t,e){return D.rotate(this,t,e),this}rotateOf(t,e){return D.rotate(this,e,t),this}getRotation(t,e,s){return D.getRotation(this,t,e,s)}toInnerOf(t,e){return D.toInnerOf(this,t,e),this}toOuterOf(t,e){return D.toOuterOf(this,t,e),this}getCenter(t){return new qi(D.getCenter(this,t))}getDistance(t){return D.getDistance(this,t)}getDistancePoint(t,e,s){return new qi(D.getDistancePoint(this,t,e,s))}getAngle(t){return D.getAngle(this,t)}getAtan2(t){return D.getAtan2(this,t)}reset(){return this}}new qi;class ze{constructor(t,e,s,n,r,o){this.set(t,e,s,n,r,o)}set(t,e,s,n,r,o){return typeof t=="object"?z.copy(this,t):z.set(this,t,e,s,n,r,o),this}setWith(t){return z.copy(this,t),this.scaleX=t.scaleX,this.scaleY=t.scaleY,this}get(){const{a:t,b:e,c:s,d:n,e:r,f:o}=this;return{a:t,b:e,c:s,d:n,e:r,f:o}}clone(){return new ze(this)}translate(t,e){return z.translate(this,t,e),this}translateInner(t,e){return z.translateInner(this,t,e),this}scale(t,e){return z.scale(this,t,e),this}scaleWith(t,e){return z.scale(this,t,e),this.scaleX*=t,this.scaleY*=e||t,this}scaleOfOuter(t,e,s){return z.scaleOfOuter(this,t,e,s),this}scaleOfInner(t,e,s){return z.scaleOfInner(this,t,e,s),this}rotate(t){return z.rotate(this,t),this}rotateOfOuter(t,e){return z.rotateOfOuter(this,t,e),this}rotateOfInner(t,e){return z.rotateOfInner(this,t,e),this}skew(t,e){return z.skew(this,t,e),this}skewOfOuter(t,e,s){return z.skewOfOuter(this,t,e,s),this}skewOfInner(t,e,s){return z.skewOfInner(this,t,e,s),this}multiply(t){return z.multiply(this,t),this}multiplyParent(t){return z.multiplyParent(this,t),this}divide(t){return z.divide(this,t),this}divideParent(t){return z.divideParent(this,t),this}invert(){return z.invert(this),this}invertWith(){return z.invert(this),this.scaleX=1/this.scaleX,this.scaleY=1/this.scaleY,this}toOuterPoint(t,e,s){z.toOuterPoint(this,t,e,s)}toInnerPoint(t,e,s){z.toInnerPoint(this,t,e,s)}setLayout(t,e,s){return z.setLayout(this,t,e,s),this}getLayout(t,e,s){return z.getLayout(this,t,e,s)}withScale(t,e){return z.withScale(this,t,e)}reset(){z.reset(this)}}new ze;const as={tempPointBounds:{},setPoint(i,t,e){i.minX=i.maxX=t,i.minY=i.maxY=e},addPoint(i,t,e){i.minX=t<i.minX?t:i.minX,i.minY=e<i.minY?e:i.minY,i.maxX=t>i.maxX?t:i.maxX,i.maxY=e>i.maxY?e:i.maxY},addBounds(i,t,e,s,n){uo(i,t,e),uo(i,t+s,e+n)},copy(i,t){i.minX=t.minX,i.minY=t.minY,i.maxX=t.maxX,i.maxY=t.maxY},addPointBounds(i,t){i.minX=t.minX<i.minX?t.minX:i.minX,i.minY=t.minY<i.minY?t.minY:i.minY,i.maxX=t.maxX>i.maxX?t.maxX:i.maxX,i.maxY=t.maxY>i.maxY?t.maxY:i.maxY},toBounds(i,t){t.x=i.minX,t.y=i.minY,t.width=i.maxX-i.minX,t.height=i.maxY-i.minY}},{addPoint:uo}=as,{tempPointBounds:Ie,setPoint:fo,addPoint:gs,toBounds:_o}=as,{toOuterPoint:ys}=z,{float:ms,fourNumber:sc}=bt,{floor:po,ceil:xs}=Math;let oe,ae,He,je;const _e={},Ut={},O={tempBounds:{},set(i,t=0,e=0,s=0,n=0){i.x=t,i.y=e,i.width=s,i.height=n},copy(i,t){i.x=t.x,i.y=t.y,i.width=t.width,i.height=t.height},copyAndSpread(i,t,e,s,n){const{x:r,y:o,width:a,height:h}=t;if(e instanceof Array){const l=sc(e);s?G.set(i,r+l[3],o+l[0],a-l[1]-l[3],h-l[2]-l[0]):G.set(i,r-l[3],o-l[0],a+l[1]+l[3],h+l[2]+l[0])}else s&&(e=-e),G.set(i,r-e,o-e,a+e*2,h+e*2);n&&(n==="width"?(i.y=o,i.height=h):(i.x=r,i.width=a))},minX(i){return i.width>0?i.x:i.x+i.width},minY(i){return i.height>0?i.y:i.y+i.height},maxX(i){return i.width>0?i.x+i.width:i.x},maxY(i){return i.height>0?i.y+i.height:i.y},move(i,t,e){i.x+=t,i.y+=e},getByMove(i,t,e){return i=Object.assign({},i),G.move(i,t,e),i},toOffsetOutBounds(i,t,e){t?yo(t,i):t=i,e?(t.offsetX=-(G.maxX(e)-i.x),t.offsetY=-(G.maxY(e)-i.y)):(t.offsetX=i.x+i.width,t.offsetY=i.y+i.height),G.move(t,-t.offsetX,-t.offsetY)},scale(i,t,e=t){D.scale(i,t,e),i.width*=t,i.height*=e},scaleOf(i,t,e,s=e){D.scaleOf(i,t,e,s),i.width*=e,i.height*=s},tempToOuterOf(i,t){return G.copy(G.tempBounds,i),G.toOuterOf(G.tempBounds,t),G.tempBounds},getOuterOf(i,t){return i=Object.assign({},i),G.toOuterOf(i,t),i},toOuterOf(i,t,e){if(e||(e=i),t.b===0&&t.c===0){const{a:s,d:n}=t;s>0?(e.width=i.width*s,e.x=t.e+i.x*s):(e.width=i.width*-s,e.x=t.e+i.x*s-e.width),n>0?(e.height=i.height*n,e.y=t.f+i.y*n):(e.height=i.height*-n,e.y=t.f+i.y*n-e.height)}else _e.x=i.x,_e.y=i.y,ys(t,_e,Ut),fo(Ie,Ut.x,Ut.y),_e.x=i.x+i.width,ys(t,_e,Ut),gs(Ie,Ut.x,Ut.y),_e.y=i.y+i.height,ys(t,_e,Ut),gs(Ie,Ut.x,Ut.y),_e.x=i.x,ys(t,_e,Ut),gs(Ie,Ut.x,Ut.y),_o(Ie,e)},toInnerOf(i,t,e){e||(e=i),G.move(e,-t.e,-t.f),G.scale(e,1/t.a,1/t.d)},getFitMatrix(i,t,e=1){const s=Math.min(e,Math.min(i.width/t.width,i.height/t.height));return new ze(s,0,0,s,-t.x*s,-t.y*s)},getSpread(i,t,e){const s={};return G.copyAndSpread(s,i,t,!1,e),s},spread(i,t,e){G.copyAndSpread(i,i,t,!1,e)},shrink(i,t,e){G.copyAndSpread(i,i,t,!0,e)},ceil(i){const{x:t,y:e}=i;i.x=po(i.x),i.y=po(i.y),i.width=t>i.x?xs(i.width+t-i.x):xs(i.width),i.height=e>i.y?xs(i.height+e-i.y):xs(i.height)},unsign(i){i.width<0&&(i.x+=i.width,i.width=-i.width),i.height<0&&(i.y+=i.height,i.height=-i.height)},float(i,t){i.x=ms(i.x,t),i.y=ms(i.y,t),i.width=ms(i.width,t),i.height=ms(i.height,t)},add(i,t,e){oe=i.x+i.width,ae=i.y+i.height,He=t.x,je=t.y,e||(He+=t.width,je+=t.height),oe=oe>He?oe:He,ae=ae>je?ae:je,i.x=i.x<t.x?i.x:t.x,i.y=i.y<t.y?i.y:t.y,i.width=oe-i.x,i.height=ae-i.y},addList(i,t){G.setListWithFn(i,t,void 0,!0)},setList(i,t,e=!1){G.setListWithFn(i,t,void 0,e)},addListWithFn(i,t,e){G.setListWithFn(i,t,e,!0)},setListWithFn(i,t,e,s=!1){let n,r=!0;for(let o=0,a=t.length;o<a;o++)n=e?e(t[o]):t[o],n&&(n.width||n.height)&&(r?(r=!1,s||yo(i,n)):go(i,n));r&&G.reset(i)},setPoints(i,t){t.forEach((e,s)=>s===0?fo(Ie,e.x,e.y):gs(Ie,e.x,e.y)),_o(Ie,i)},setPoint(i,t){G.set(i,t.x,t.y)},addPoint(i,t){go(i,t,!0)},getPoints(i){const{x:t,y:e,width:s,height:n}=i;return[{x:t,y:e},{x:t+s,y:e},{x:t+s,y:e+n},{x:t,y:e+n}]},hitRadiusPoint(i,t,e){return e&&(t=D.tempToInnerRadiusPointOf(t,e)),t.x>=i.x-t.radiusX&&t.x<=i.x+i.width+t.radiusX&&t.y>=i.y-t.radiusY&&t.y<=i.y+i.height+t.radiusY},hitPoint(i,t,e){return e&&(t=D.tempToInnerOf(t,e)),t.x>=i.x&&t.x<=i.x+i.width&&t.y>=i.y&&t.y<=i.y+i.height},hit(i,t,e){return e&&(t=G.tempToOuterOf(t,e)),!(i.y+i.height<t.y||t.y+t.height<i.y||i.x+i.width<t.x||t.x+t.width<i.x)},includes(i,t,e){return e&&(t=G.tempToOuterOf(t,e)),i.x<=t.x&&i.y<=t.y&&i.x+i.width>=t.x+t.width&&i.y+i.height>=t.y+t.height},getIntersectData(i,t,e){if(e&&(t=G.tempToOuterOf(t,e)),!G.hit(i,t))return gh();let{x:s,y:n,width:r,height:o}=t;return oe=s+r,ae=n+o,He=i.x+i.width,je=i.y+i.height,s=s>i.x?s:i.x,n=n>i.y?n:i.y,oe=oe<He?oe:He,ae=ae<je?ae:je,r=oe-s,o=ae-n,{x:s,y:n,width:r,height:o}},intersect(i,t,e){G.copy(i,G.getIntersectData(i,t,e))},isSame(i,t){return i.x===t.x&&i.y===t.y&&i.width===t.width&&i.height===t.height},isEmpty(i){return i.x===0&&i.y===0&&i.width===0&&i.height===0},reset(i){G.set(i)}},G=O,{add:go,copy:yo}=G;class nt{get minX(){return O.minX(this)}get minY(){return O.minY(this)}get maxX(){return O.maxX(this)}get maxY(){return O.maxY(this)}constructor(t,e,s,n){this.set(t,e,s,n)}set(t,e,s,n){return typeof t=="object"?O.copy(this,t):O.set(this,t,e,s,n),this}get(){const{x:t,y:e,width:s,height:n}=this;return{x:t,y:e,width:s,height:n}}clone(){return new nt(this)}move(t,e){return O.move(this,t,e),this}scale(t,e){return O.scale(this,t,e),this}scaleOf(t,e,s){return O.scaleOf(this,t,e,s),this}toOuterOf(t,e){return O.toOuterOf(this,t,e),this}toInnerOf(t,e){return O.toInnerOf(this,t,e),this}getFitMatrix(t,e){return O.getFitMatrix(this,t,e)}spread(t,e){return O.spread(this,t,e),this}shrink(t,e){return O.shrink(this,t,e),this}ceil(){return O.ceil(this),this}unsign(){return O.unsign(this),this}float(t){return O.float(this,t),this}add(t){return O.add(this,t),this}addList(t){return O.setList(this,t,!0),this}setList(t){return O.setList(this,t),this}addListWithFn(t,e){return O.setListWithFn(this,t,e,!0),this}setListWithFn(t,e){return O.setListWithFn(this,t,e),this}setPoint(t){return O.setPoint(this,t),this}setPoints(t){return O.setPoints(this,t),this}addPoint(t){return O.addPoint(this,t),this}getPoints(){return O.getPoints(this)}hitPoint(t,e){return O.hitPoint(this,t,e)}hitRadiusPoint(t,e){return O.hitRadiusPoint(this,t,e)}hit(t,e){return O.hit(this,t,e)}includes(t,e){return O.includes(this,t,e)}intersect(t,e){return O.intersect(this,t,e),this}getIntersect(t,e){return new nt(O.getIntersectData(this,t,e))}isSame(t){return O.isSame(this,t)}isEmpty(){return O.isEmpty(this)}reset(){O.reset(this)}}const F=new nt;class nc{constructor(t,e,s,n,r,o){typeof t=="object"?this.copy(t):this.set(t,e,s,n,r,o)}set(t=0,e=0,s=0,n=0,r=0,o=0){this.top=t,this.right=e,this.bottom=s,this.left=n,this.width=r,this.height=o}copy(t){const{top:e,right:s,bottom:n,left:r,width:o,height:a}=t;this.set(e,s,n,r,o,a)}getBoundsFrom(t){const{top:e,right:s,bottom:n,left:r,width:o,height:a}=this;return new nt(r,e,o||t.width-r-s,a||t.height-e-n)}}var mr;(function(i){i[i.top=0]="top",i[i.right=1]="right",i[i.bottom=2]="bottom",i[i.left=3]="left"})(mr||(mr={}));var Ns;(function(i){i[i.topLeft=0]="topLeft",i[i.top=1]="top",i[i.topRight=2]="topRight",i[i.right=3]="right",i[i.bottomRight=4]="bottomRight",i[i.bottom=5]="bottom",i[i.bottomLeft=6]="bottomLeft",i[i.left=7]="left",i[i.center=8]="center",i[i["top-left"]=0]="top-left",i[i["top-right"]=2]="top-right",i[i["bottom-right"]=4]="bottom-right",i[i["bottom-left"]=6]="bottom-left"})(Ns||(Ns={}));const Mr=[{x:0,y:0},{x:.5,y:0},{x:1,y:0},{x:1,y:.5},{x:1,y:1},{x:.5,y:1},{x:0,y:1},{x:0,y:.5},{x:.5,y:.5}];Mr.forEach(i=>i.type="percent");const Oi={directionData:Mr,tempPoint:{},get:mo,toPoint(i,t,e,s,n){const r=mo(i);e.x=r.x,e.y=r.y,r.type==="percent"&&(e.x*=t.width,e.y*=t.height,n&&(e.x-=n.x,e.y-=n.y,r.x&&(e.x-=r.x===1?n.width:r.x===.5?r.x*n.width:0),r.y&&(e.y-=r.y===1?n.height:r.y===.5?r.y*n.height:0))),s||(e.x+=t.x,e.y+=t.y)}};function mo(i){return typeof i=="string"?Mr[Ns[i]]:i}const{toPoint:rc}=Oi,yh={toPoint(i,t,e,s,n){rc(i,e,s,n,t)}},oc={0:1,1:1,2:1,3:1,4:1,5:1,6:1,7:1,8:1,9:1,".":1,e:1,E:1};class K{constructor(t){this.repeatMap={},this.name=t}static get(t){return new K(t)}static set filter(t){this.filterList=xo(t)}static set exclude(t){this.excludeList=xo(t)}log(...t){if(Ve.enable){if(Ve.filterList.length&&Ve.filterList.every(e=>e!==this.name)||Ve.excludeList.length&&Ve.excludeList.some(e=>e===this.name))return;console.log("%c"+this.name,"color:#21ae62",...t)}}tip(...t){Ve.enable&&this.warn(...t)}warn(...t){Ve.showWarn&&console.warn(this.name,...t)}repeat(t,...e){this.repeatMap[t]||(this.warn("repeat:"+t,...e),this.repeatMap[t]=!0)}error(...t){try{throw new Error}catch(e){console.error(this.name,...t,e)}}}K.filterList=[];K.excludeList=[];K.showWarn=!0;function xo(i){return i?typeof i=="string"&&(i=[i]):i=[],i}const Ve=K,ac=K.get("RunTime"),te={currentId:0,currentName:"",idMap:{},nameMap:{},nameToIdMap:{},start(i,t){const e=Te.create(Te.RUNTIME);return Ft.currentId=Ft.idMap[e]=t?performance.now():Date.now(),Ft.currentName=Ft.nameMap[e]=i,Ft.nameToIdMap[i]=e,e},end(i,t){const e=Ft.idMap[i],s=Ft.nameMap[i],n=t?(performance.now()-e)/1e3:Date.now()-e;Ft.idMap[i]=Ft.nameMap[i]=Ft.nameToIdMap[s]=void 0,ac.log(s,n,"ms")},endOfName(i,t){const e=Ft.nameToIdMap[i];e!==void 0&&Ft.end(e,t)}},Ft=te;function Pi(i){console.error("need plugin: @leafer-in/"+i)}const wo=K.get("UICreator"),Zs={list:{},register(i){const{__tag:t}=i.prototype;ws[t]&&wo.repeat(t),ws[t]=i},get(i,t,e,s,n,r){ws[i]||wo.error("not register "+i);const o=new ws[i](t);return e!==void 0&&(o.x=e,s&&(o.y=s),n&&(o.width=n),r&&(o.height=r)),o}},{list:ws}=Zs,hc=K.get("EventCreator"),Bi={nameList:{},register(i){let t;Object.keys(i).forEach(e=>{t=i[e],typeof t=="string"&&(Li[t]&&hc.repeat(t),Li[t]=i)})},changeName(i,t){const e=Li[i];if(e){const s=Object.keys(e).find(n=>e[n]===i);s&&(e[s]=t,Li[t]=e)}},has(i){return!!this.nameList[i]},get(i,...t){return new Li[i](...t)}},{nameList:Li}=Bi;class mh{constructor(){this.list=[]}add(t){t.manager=this,this.list.push(t)}get(t){let e;const{list:s}=this;for(let r=0,o=s.length;r<o;r++)if(e=s[r],e.recycled&&e.isSameSize(t))return e.recycled=!1,e.manager||(e.manager=this),e;const n=ct.canvas(t);return this.add(n),n}recycle(t){t.recycled=!0}clearRecycled(){let t;const e=[];for(let s=0,n=this.list.length;s<n;s++)t=this.list[s],t.recycled?t.destroy():e.push(t);this.list=e}clear(){this.list.forEach(t=>{t.destroy()}),this.list.length=0}destroy(){this.clear()}}const _t={default(i,t){return kn(t,i),kn(i,t),i},assign(i,t){let e;Object.keys(t).forEach(s=>{var n;e=t[s],(e==null?void 0:e.constructor)===Object&&((n=i[s])===null||n===void 0?void 0:n.constructor)===Object?kn(i[s],t[s]):i[s]=t[s]})},copyAttrs(i,t,e){return e.forEach(s=>{t[s]!==void 0&&(i[s]=t[s])}),i},clone(i){return JSON.parse(JSON.stringify(i))},toMap(i){const t={};for(let e=0,s=i.length;e<s;e++)t[i[e]]=!0;return t}},{assign:kn}=_t;class xh{get __useNaturalRatio(){return!0}get __isLinePath(){const{path:t}=this;return t&&t.length===6&&t[0]===1}get __blendMode(){if(this.eraser&&this.eraser!=="path")return"destination-out";const{blendMode:t}=this;return t==="pass-through"?null:t}constructor(t){this.__leaf=t}__get(t){if(this.__input){const e=this.__input[t];if(e!==void 0)return e}return this[t]}__getData(){const t={tag:this.__leaf.tag},{__input:e}=this;let s;for(let n in this)n[0]!=="_"&&(s=e?e[n]:void 0,t[n]=s===void 0?this[n]:s);return t}__setInput(t,e){this.__input||(this.__input={}),this.__input[t]=e}__getInput(t){if(this.__input){const e=this.__input[t];if(e!==void 0)return e}if(!(t==="path"&&!this.__pathInputed))return this["_"+t]}__removeInput(t){this.__input&&this.__input[t]!==void 0&&(this.__input[t]=void 0)}__getInputData(t,e){const s={};if(t)if(t instanceof Array)for(let n of t)s[n]=this.__getInput(n);else for(let n in t)s[n]=this.__getInput(n);else{let n,r,{__input:o}=this;s.tag=this.__leaf.tag;for(let a in this)if(a[0]!=="_"&&(n=this["_"+a],n!==void 0)){if(a==="path"&&!this.__pathInputed)continue;r=o?o[a]:void 0,s[a]=r===void 0?n:r}}if(e&&e.matrix){const{a:n,b:r,c:o,d:a,e:h,f:l}=this.__leaf.__localMatrix;s.matrix={a:n,b:r,c:o,d:a,e:h,f:l}}return s}__setMiddle(t,e){this.__middle||(this.__middle={}),this.__middle[t]=e}__getMiddle(t){return this.__middle&&this.__middle[t]}__checkSingle(){const t=this;if(t.blendMode==="pass-through"){const e=this.__leaf;t.opacity<1&&(e.isBranch||t.__hasMultiPaint)||e.__hasEraser||t.eraser?t.__single=!0:t.__single&&(t.__single=!1)}else t.__single=!0}__removeNaturalSize(){this.__naturalWidth=this.__naturalHeight=void 0}destroy(){this.__input=this.__middle=null}}var xr;(function(i){i[i.No=0]="No",i[i.Yes=1]="Yes",i[i.NoAndSkip=2]="NoAndSkip",i[i.YesAndSkip=3]="YesAndSkip"})(xr||(xr={}));function R(i,t,e,s){var n=arguments.length,r=n<3?t:s===null?s=Object.getOwnPropertyDescriptor(t,e):s,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(i,t,e,s);else for(var a=i.length-1;a>=0;a--)(o=i[a])&&(r=(n<3?o(r):n>3?o(t,e,r):o(t,e))||r);return n>3&&r&&Object.defineProperty(t,e,r),r}function wh(i,t,e,s){function n(r){return r instanceof e?r:new e(function(o){o(r)})}return new(e||(e=Promise))(function(r,o){function a(c){try{l(s.next(c))}catch(p){o(p)}}function h(c){try{l(s.throw(c))}catch(p){o(p)}}function l(c){c.done?r(c.value):n(c.value).then(a,h)}l((s=s.apply(i,[])).next())})}function et(i){return(t,e)=>{i||(i=e),Object.defineProperty(t,e,{get(){return this.context[i]},set(s){this.context[i]=s}})}}const vh=[];function N(){return(i,t)=>{vh.push(t)}}const lc=[];let E=class{set blendMode(t){t==="normal"&&(t="source-over"),this.context.globalCompositeOperation=t}get blendMode(){return this.context.globalCompositeOperation}set dashPattern(t){this.context.setLineDash(t||lc)}get dashPattern(){return this.context.getLineDash()}__bindContext(){let t;vh.forEach(e=>{t=this.context[e],t&&(this[e]=t.bind(this.context))}),this.textBaseline="alphabetic"}setTransform(t,e,s,n,r,o){}resetTransform(){}getTransform(){}save(){}restore(){}transform(t,e,s,n,r,o){typeof t=="object"?this.context.transform(t.a,t.b,t.c,t.d,t.e,t.f):this.context.transform(t,e,s,n,r,o)}translate(t,e){}scale(t,e){}rotate(t){}fill(t,e){}stroke(t){}clip(t,e){}fillRect(t,e,s,n){}strokeRect(t,e,s,n){}clearRect(t,e,s,n){}drawImage(t,e,s,n,r,o,a,h,l){switch(arguments.length){case 9:if(e<0){const c=-e/n*h;n+=e,e=0,o+=c,h-=c}if(s<0){const c=-s/r*l;r+=s,s=0,a+=c,l-=c}this.context.drawImage(t,e,s,n,r,o,a,h,l);break;case 5:this.context.drawImage(t,e,s,n,r);break;case 3:this.context.drawImage(t,e,s)}}beginPath(){}moveTo(t,e){}lineTo(t,e){}bezierCurveTo(t,e,s,n,r,o){}quadraticCurveTo(t,e,s,n){}closePath(){}arc(t,e,s,n,r,o){}arcTo(t,e,s,n,r){}ellipse(t,e,s,n,r,o,a,h){}rect(t,e,s,n){}roundRect(t,e,s,n,r){}createConicGradient(t,e,s){}createLinearGradient(t,e,s,n){}createPattern(t,e){}createRadialGradient(t,e,s,n,r,o){}fillText(t,e,s,n){}measureText(t){}strokeText(t,e,s,n){}destroy(){this.context=null}};R([et("imageSmoothingEnabled")],E.prototype,"smooth",void 0);R([et("imageSmoothingQuality")],E.prototype,"smoothLevel",void 0);R([et("globalAlpha")],E.prototype,"opacity",void 0);R([et()],E.prototype,"fillStyle",void 0);R([et()],E.prototype,"strokeStyle",void 0);R([et("lineWidth")],E.prototype,"strokeWidth",void 0);R([et("lineCap")],E.prototype,"strokeCap",void 0);R([et("lineJoin")],E.prototype,"strokeJoin",void 0);R([et("lineDashOffset")],E.prototype,"dashOffset",void 0);R([et()],E.prototype,"miterLimit",void 0);R([et()],E.prototype,"shadowBlur",void 0);R([et()],E.prototype,"shadowColor",void 0);R([et()],E.prototype,"shadowOffsetX",void 0);R([et()],E.prototype,"shadowOffsetY",void 0);R([et()],E.prototype,"filter",void 0);R([et()],E.prototype,"font",void 0);R([et()],E.prototype,"fontKerning",void 0);R([et()],E.prototype,"fontStretch",void 0);R([et()],E.prototype,"fontVariantCaps",void 0);R([et()],E.prototype,"textAlign",void 0);R([et()],E.prototype,"textBaseline",void 0);R([et()],E.prototype,"textRendering",void 0);R([et()],E.prototype,"wordSpacing",void 0);R([et()],E.prototype,"letterSpacing",void 0);R([et()],E.prototype,"direction",void 0);R([N()],E.prototype,"setTransform",null);R([N()],E.prototype,"resetTransform",null);R([N()],E.prototype,"getTransform",null);R([N()],E.prototype,"save",null);R([N()],E.prototype,"restore",null);R([N()],E.prototype,"translate",null);R([N()],E.prototype,"scale",null);R([N()],E.prototype,"rotate",null);R([N()],E.prototype,"fill",null);R([N()],E.prototype,"stroke",null);R([N()],E.prototype,"clip",null);R([N()],E.prototype,"fillRect",null);R([N()],E.prototype,"strokeRect",null);R([N()],E.prototype,"clearRect",null);R([N()],E.prototype,"beginPath",null);R([N()],E.prototype,"moveTo",null);R([N()],E.prototype,"lineTo",null);R([N()],E.prototype,"bezierCurveTo",null);R([N()],E.prototype,"quadraticCurveTo",null);R([N()],E.prototype,"closePath",null);R([N()],E.prototype,"arc",null);R([N()],E.prototype,"arcTo",null);R([N()],E.prototype,"ellipse",null);R([N()],E.prototype,"rect",null);R([N()],E.prototype,"roundRect",null);R([N()],E.prototype,"createConicGradient",null);R([N()],E.prototype,"createLinearGradient",null);R([N()],E.prototype,"createPattern",null);R([N()],E.prototype,"createRadialGradient",null);R([N()],E.prototype,"fillText",null);R([N()],E.prototype,"measureText",null);R([N()],E.prototype,"strokeText",null);const{copy:cc}=z,dc={width:1,height:1,pixelRatio:1},Qt=["width","height","pixelRatio"];class Ar extends E{get width(){return this.size.width}get height(){return this.size.height}get pixelRatio(){return this.size.pixelRatio}get pixelWidth(){return this.width*this.pixelRatio}get pixelHeight(){return this.height*this.pixelRatio}get allowBackgroundColor(){return this.view&&this.parentView}constructor(t,e){super(),this.size={},this.worldTransform={},t||(t=dc),t.pixelRatio||(t.pixelRatio=S.devicePixelRatio),this.manager=e,this.innerId=Te.create(Te.CNAVAS);const{width:s,height:n,pixelRatio:r}=t;this.autoLayout=!s||!n,this.size.pixelRatio=r,this.config=t,this.init()}init(){}__createContext(){const{view:t}=this,{contextSettings:e}=this.config;this.context=e?t.getContext("2d",e):t.getContext("2d"),this.__bindContext()}export(t,e){}toBlob(t,e){}toDataURL(t,e){}saveAs(t,e){}resize(t){if(this.isSameSize(t))return;let e;this.context&&!this.unreal&&this.width&&(e=this.getSameCanvas(),e.copyWorld(this));const s=this.size;_t.copyAttrs(s,t,Qt),Qt.forEach(n=>s[n]||(s[n]=1)),this.bounds=new nt(0,0,this.width,this.height),this.context&&!this.unreal&&(this.updateViewSize(),this.smooth=this.config.smooth),this.updateClientBounds(),this.context&&!this.unreal&&e&&(this.clearWorld(e.bounds),this.copyWorld(e),e.recycle())}updateViewSize(){}updateClientBounds(){}getClientBounds(t){return t&&this.updateClientBounds(),this.clientBounds||this.bounds}startAutoLayout(t,e){}stopAutoLayout(){}setCursor(t){}setWorld(t,e){const{pixelRatio:s}=this,n=this.worldTransform;if(e){const{a:r,b:o,c:a,d:h,e:l,f:c}=e;this.setTransform(n.a=(t.a*r+t.b*a)*s,n.b=(t.a*o+t.b*h)*s,n.c=(t.c*r+t.d*a)*s,n.d=(t.c*o+t.d*h)*s,n.e=(t.e*r+t.f*a+l)*s,n.f=(t.e*o+t.f*h+c)*s)}else this.setTransform(n.a=t.a*s,n.b=t.b*s,n.c=t.c*s,n.d=t.d*s,n.e=t.e*s,n.f=t.f*s)}useWorldTransform(t){t&&(this.worldTransform=t);const e=this.worldTransform;e&&this.setTransform(e.a,e.b,e.c,e.d,e.e,e.f)}setStroke(t,e,s){e&&(this.strokeWidth=e),t&&(this.strokeStyle=t),s&&this.setStrokeOptions(s)}setStrokeOptions(t){this.strokeCap=t.strokeCap==="none"?"butt":t.strokeCap,this.strokeJoin=t.strokeJoin,this.dashPattern=t.dashPattern,this.dashOffset=t.dashOffset,this.miterLimit=t.miterLimit}saveBlendMode(t){this.savedBlendMode=this.blendMode,this.blendMode=t}restoreBlendMode(){this.blendMode=this.savedBlendMode}hitFill(t,e){return!0}hitStroke(t,e){return!0}hitPixel(t,e,s=1){return!0}setWorldShadow(t,e,s,n){const{pixelRatio:r}=this;this.shadowOffsetX=t*r,this.shadowOffsetY=e*r,this.shadowBlur=s*r,this.shadowColor=n||"black"}setWorldBlur(t){const{pixelRatio:e}=this;this.filter=`blur(${t*e}px)`}copyWorld(t,e,s,n){if(n&&(this.blendMode=n),e){const{pixelRatio:r}=this;s||(s=e),this.drawImage(t.view,e.x*r,e.y*r,e.width*r,e.height*r,s.x*r,s.y*r,s.width*r,s.height*r)}else this.drawImage(t.view,0,0);n&&(this.blendMode="source-over")}copyWorldToInner(t,e,s,n){if(n&&(this.blendMode=n),e.b||e.c)this.save(),this.resetTransform(),this.copyWorld(t,e,O.tempToOuterOf(s,e)),this.restore();else{const{pixelRatio:r}=this;this.drawImage(t.view,e.x*r,e.y*r,e.width*r,e.height*r,s.x,s.y,s.width,s.height)}n&&(this.blendMode="source-over")}copyWorldByReset(t,e,s,n,r){this.resetTransform(),this.copyWorld(t,e,s,n),r||this.useWorldTransform()}useGrayscaleAlpha(t){this.setTempBounds(t,!0,!0);let e,s;const{context:n}=this,r=n.getImageData(F.x,F.y,F.width,F.height),{data:o}=r;for(let a=0,h=o.length;a<h;a+=4)s=o[a]*.299+o[a+1]*.587+o[a+2]*.114,(e=o[a+3])&&(o[a+3]=e===255?s:e*(s/255));n.putImageData(r,F.x,F.y)}useMask(t,e,s){this.copyWorld(t,e,s,"destination-in")}useEraser(t,e,s){this.copyWorld(t,e,s,"destination-out")}fillWorld(t,e,s){s&&(this.blendMode=s),this.fillStyle=e,this.setTempBounds(t),this.fillRect(F.x,F.y,F.width,F.height),s&&(this.blendMode="source-over")}strokeWorld(t,e,s){s&&(this.blendMode=s),this.strokeStyle=e,this.setTempBounds(t),this.strokeRect(F.x,F.y,F.width,F.height),s&&(this.blendMode="source-over")}clearWorld(t,e){this.setTempBounds(t,e),this.clearRect(F.x,F.y,F.width,F.height)}clipWorld(t,e){this.beginPath(),this.setTempBounds(t,e),this.rect(F.x,F.y,F.width,F.height),this.clip()}clear(){const{pixelRatio:t}=this;this.clearRect(0,0,this.width*t+2,this.height*t+2)}setTempBounds(t,e,s){F.set(t),s&&F.intersect(this.bounds),F.scale(this.pixelRatio),e&&F.ceil()}isSameSize(t){return this.width===t.width&&this.height===t.height&&this.pixelRatio===t.pixelRatio}getSameCanvas(t,e){const s=this.manager?this.manager.get(this.size):ct.canvas(Object.assign({},this.size));return s.save(),t&&(cc(s.worldTransform,this.worldTransform),s.useWorldTransform()),e&&(s.smooth=this.smooth),s}recycle(t){this.recycled||(this.restore(),t?this.clearWorld(t,!0):this.clear(),this.manager?this.manager.recycle(this):this.destroy())}updateRender(t){}unrealCanvas(){}destroy(){this.manager=this.view=this.parentView=null}}const le={creator:{},parse(i,t){},convertToCanvasData(i,t){}},kh={N:21,D:22,X:23,G:24,F:25,O:26,P:27,U:28},Vt=Object.assign({M:1,m:10,L:2,l:20,H:3,h:30,V:4,v:40,C:5,c:50,S:6,s:60,Q:7,q:70,T:8,t:80,A:9,a:90,Z:11,z:11,R:12},kh),bh={M:3,m:3,L:3,l:3,H:2,h:2,V:2,v:2,C:7,c:7,S:5,s:5,Q:5,q:5,T:3,t:3,A:8,a:8,Z:1,z:1,N:5,D:9,X:6,G:9,F:5,O:7,P:4,U:6},Th={m:10,l:20,H:3,h:30,V:4,v:40,c:50,S:6,s:60,q:70,T:8,t:80,A:9,a:90},uc=Object.assign(Object.assign({},Th),kh),Gs=Vt,Sh={};for(let i in Gs)Sh[Gs[i]]=i;const Ch={};for(let i in Gs)Ch[Gs[i]]=bh[i];const Ph={drawRoundRect(i,t,e,s,n,r){const o=bt.fourNumber(r,Math.min(s/2,n/2)),a=t+s,h=e+n;o[0]?i.moveTo(t+o[0],e):i.moveTo(t,e),o[1]?i.arcTo(a,e,a,h,o[1]):i.lineTo(a,e),o[2]?i.arcTo(a,h,t,h,o[2]):i.lineTo(a,h),o[3]?i.arcTo(t,h,t,e,o[3]):i.lineTo(t,h),o[0]?i.arcTo(t,e,a,e,o[0]):i.lineTo(t,e)}},{sin:ui,cos:Wi,atan2:vo,ceil:fc,abs:bn,PI:ko,sqrt:bo,pow:vs}=Math,{setPoint:Tn,addPoint:ks}=as,{set:bs,toNumberPoints:_c}=D,{M:To,L:Sn,C:Cn,Q:So,Z:pc}=Vt,Pn={},Je={points(i,t,e,s){let n=_c(t);if(i.push(To,n[0],n[1]),e&&n.length>5){let r,o,a,h,l,c,p,f,d,u,y,v,C,m=n.length;const I=e===!0?.5:e;s&&(n=[n[m-2],n[m-1],...n,n[0],n[1],n[2],n[3]],m=n.length);for(let T=2;T<m-2;T+=2)r=n[T-2],o=n[T-1],a=n[T],h=n[T+1],l=n[T+2],c=n[T+3],y=bo(vs(a-r,2)+vs(h-o,2)),v=bo(vs(l-a,2)+vs(c-h,2)),C=y+v,y=I*y/C,v=I*v/C,l-=r,c-=o,p=a-y*l,f=h-y*c,T===2?s||i.push(So,p,f,a,h):i.push(Cn,d,u,p,f,a,h),d=a+v*l,u=h+v*c;s||i.push(So,d,u,n[m-2],n[m-1])}else for(let r=2,o=n.length;r<o;r+=2)i.push(Sn,n[r],n[r+1]);s&&i.push(pc)},rect(i,t,e,s,n){le.creator.path=i,le.creator.moveTo(t,e).lineTo(t+s,e).lineTo(t+s,e+n).lineTo(t,e+n).lineTo(t,e)},roundRect(i,t,e,s,n,r){le.creator.path=[],Ph.drawRoundRect(le.creator,t,e,s,n,r),i.push(...le.convertToCanvasData(le.creator.path,!0))},arcTo(i,t,e,s,n,r,o,a,h,l,c){const p=s-t,f=n-e,d=r-s,u=o-n;let y=vo(f,p),v=vo(u,d),C=v-y;if(C<0&&(C+=Ht),C===ko||bn(p+f)<1e-12||bn(d+u)<1e-12){i&&i.push(Sn,s,n),h&&(Tn(h,t,e),ks(h,s,n)),c&&bs(c,t,e),l&&bs(l,s,n);return}const m=p*u-d*f<0,I=m?-1:1,T=a/Wi(C/2),L=s+T*Wi(y+C/2+xi*I),W=n+T*ui(y+C/2+xi*I);return y-=xi*I,v-=xi*I,Bo(i,L,W,a,a,0,y/Z,v/Z,m,h,l,c)},arc(i,t,e,s,n,r,o,a,h,l){return Bo(i,t,e,s,s,0,n,r,o,a,h,l)},ellipse(i,t,e,s,n,r,o,a,h,l,c,p){const f=r*Z,d=ui(f),u=Wi(f);let y=o*Z,v=a*Z;y>ko&&(y-=Ht),v<0&&(v+=Ht);let C=v-y;C<0?C+=Ht:C>Ht&&(C-=Ht),h&&(C-=Ht);const m=fc(bn(C/xi)),I=C/m,T=ui(I/4),L=8/3*T*T/ui(I/2);v=y+I;let W=Wi(y),M=ui(y),g,A,P,B,$,mt,Tt,$t,re=P=u*s*W-d*n*M,rt=B=d*s*W+u*n*M,j=t+P,Dt=e+B;i&&i.push(i.length?Sn:To,j,Dt),l&&Tn(l,j,Dt),p&&bs(p,j,Dt);for(let Ee=0;Ee<m;Ee++)g=Wi(v),A=ui(v),P=u*s*g-d*n*A,B=d*s*g+u*n*A,$=t+re-L*(u*s*M+d*n*W),mt=e+rt-L*(d*s*M-u*n*W),Tt=t+P+L*(u*s*A+d*n*g),$t=e+B+L*(d*s*A-u*n*g),i&&i.push(Cn,$,mt,Tt,$t,t+P,e+B),l&&Po(t+re,e+rt,$,mt,Tt,$t,t+P,e+B,l,!0),re=P,rt=B,W=g,M=A,y=v,v+=I;c&&bs(c,t+P,e+B)},quadraticCurveTo(i,t,e,s,n,r,o){i.push(Cn,(t+2*s)/3,(e+2*n)/3,(r+2*s)/3,(o+2*n)/3,r,o)},toTwoPointBoundsByQuadraticCurve(i,t,e,s,n,r,o,a){Po(i,t,(i+2*e)/3,(t+2*s)/3,(n+2*e)/3,(r+2*s)/3,n,r,o,a)},toTwoPointBounds(i,t,e,s,n,r,o,a,h,l){const c=[];let p,f,d,u,y,v,C,m,I=i,T=e,L=n,W=o;for(let M=0;M<2;++M){if(M==1&&(I=t,T=s,L=r,W=a),p=-3*I+9*T-9*L+3*W,f=6*I-12*T+6*L,d=3*T-3*I,Math.abs(p)<1e-12){if(Math.abs(f)<1e-12)continue;u=-d/f,0<u&&u<1&&c.push(u);continue}C=f*f-4*d*p,m=Math.sqrt(C),!(C<0)&&(y=(-f+m)/(2*p),0<y&&y<1&&c.push(y),v=(-f-m)/(2*p),0<v&&v<1&&c.push(v))}l?ks(h,i,t):Tn(h,i,t),ks(h,o,a);for(let M=0,g=c.length;M<g;M++)Co(c[M],i,t,e,s,n,r,o,a,Pn),ks(h,Pn.x,Pn.y)},getPointAndSet(i,t,e,s,n,r,o,a,h,l){const c=1-i,p=c*c*c,f=3*c*c*i,d=3*c*i*i,u=i*i*i;l.x=p*t+f*s+d*r+u*a,l.y=p*e+f*n+d*o+u*h},getPoint(i,t,e,s,n,r,o,a,h){const l={};return Co(i,t,e,s,n,r,o,a,h,l),l}},{getPointAndSet:Co,toTwoPointBounds:Po,ellipse:Bo}=Je,{sin:gc,cos:yc,sqrt:Ro,atan2:Eo}=Math,{ellipse:mc}=Je,xc={ellipticalArc(i,t,e,s,n,r,o,a,h,l,c){const p=(h-t)/2,f=(l-e)/2,d=r*Z,u=gc(d),y=yc(d),v=-y*p-u*f,C=-y*f+u*p,m=s*s,I=n*n,T=C*C,L=v*v,W=m*I-m*T-I*L;let M=0;if(W<0){const re=Ro(1-W/(m*I));s*=re,n*=re}else M=(o===a?-1:1)*Ro(W/(m*T+I*L));const g=M*s*C/n,A=-M*n*v/s,P=Eo((C-A)/n,(v-g)/s),B=Eo((-C-A)/n,(-v-g)/s);let $=B-P;a===0&&$>0?$-=Ht:a===1&&$<0&&($+=Ht);const mt=t+p+y*g-u*A,Tt=e+f+u*g+y*A,$t=$<0?1:0;c||S.ellipseToCurve?mc(i,mt,Tt,s,n,r,P/Z,B/Z,$t):s===n&&!r?i.push(Vt.O,mt,Tt,s,P/Z,B/Z,$t):i.push(Vt.G,mt,Tt,s,n,r,P/Z,B/Z,$t)}},{M:Bn,m:wc,L:zi,l:vc,H:kc,h:bc,V:Tc,v:Sc,C:fi,c:Cc,S:Rn,s:Pc,Q:_i,q:Bc,T:En,t:Rc,A:Ec,a:Oc,Z:On,z:Ic,N:Mc,D:Ac,X:Dc,G:Lc,F:Wc,O:zc,P:$c,U:Uc}=Vt,{rect:Fc,roundRect:Oo,arcTo:Nc,arc:Io,ellipse:Mo,quadraticCurveTo:Ao}=Je,{ellipticalArc:Gc}=xc,Hc=K.get("PathConvert"),pe={},ti={current:{dot:0},stringify(i,t){let e=0,s=i.length,n,r="",o,a;for(;e<s;){o=i[e],n=Ch[o],o===a?r+=" ":r+=Sh[o];for(let h=1;h<n;h++)r+=bt.float(i[e+h],t),h===n-1||(r+=" ");a=o,e+=n}return r},parse(i,t){let e,s,n,r="";const o=[],a=t?uc:Th;for(let h=0,l=i.length;h<l;h++)s=i[h],oc[s]?(s==="."&&(Nt.dot&&(Ye(o,r),r=""),Nt.dot++),r==="0"&&s!=="."&&(Ye(o,r),r=""),r+=s):Vt[s]?(r&&(Ye(o,r),r=""),Nt.name=Vt[s],Nt.length=bh[s],Nt.index=0,Ye(o,Nt.name),!e&&a[s]&&(e=!0)):s==="-"||s==="+"?n==="e"||n==="E"?r+=s:(r&&Ye(o,r),r=s):r&&(Ye(o,r),r=""),n=s;return r&&Ye(o,r),e?ti.toCanvasData(o,t):o},toCanvasData(i,t){let e=0,s=0,n=0,r=0,o=0,a=i.length,h,l,c,p,f;const d=[];for(;o<a;){switch(c=i[o],c){case wc:i[o+1]+=e,i[o+2]+=s;case Bn:e=i[o+1],s=i[o+2],d.push(Bn,e,s),o+=3;break;case bc:i[o+1]+=e;case kc:e=i[o+1],d.push(zi,e,s),o+=2;break;case Sc:i[o+1]+=s;case Tc:s=i[o+1],d.push(zi,e,s),o+=2;break;case vc:i[o+1]+=e,i[o+2]+=s;case zi:e=i[o+1],s=i[o+2],d.push(zi,e,s),o+=3;break;case Pc:i[o+1]+=e,i[o+2]+=s,i[o+3]+=e,i[o+4]+=s,c=Rn;case Rn:f=p===fi||p===Rn,n=f?e*2-h:i[o+1],r=f?s*2-l:i[o+2],h=i[o+1],l=i[o+2],e=i[o+3],s=i[o+4],d.push(fi,n,r,h,l,e,s),o+=5;break;case Cc:i[o+1]+=e,i[o+2]+=s,i[o+3]+=e,i[o+4]+=s,i[o+5]+=e,i[o+6]+=s,c=fi;case fi:h=i[o+3],l=i[o+4],e=i[o+5],s=i[o+6],d.push(fi,i[o+1],i[o+2],h,l,e,s),o+=7;break;case Rc:i[o+1]+=e,i[o+2]+=s,c=En;case En:f=p===_i||p===En,h=f?e*2-h:i[o+1],l=f?s*2-l:i[o+2],t?Ao(d,e,s,h,l,i[o+1],i[o+2]):d.push(_i,h,l,i[o+1],i[o+2]),e=i[o+1],s=i[o+2],o+=3;break;case Bc:i[o+1]+=e,i[o+2]+=s,i[o+3]+=e,i[o+4]+=s,c=_i;case _i:h=i[o+1],l=i[o+2],t?Ao(d,e,s,h,l,i[o+3],i[o+4]):d.push(_i,h,l,i[o+3],i[o+4]),e=i[o+3],s=i[o+4],o+=5;break;case Oc:i[o+6]+=e,i[o+7]+=s;case Ec:Gc(d,e,s,i[o+1],i[o+2],i[o+3],i[o+4],i[o+5],i[o+6],i[o+7],t),e=i[o+6],s=i[o+7],o+=8;break;case Ic:case On:d.push(On),o++;break;case Mc:e=i[o+1],s=i[o+2],t?Fc(d,e,s,i[o+3],i[o+4]):Me(d,i,o,5),o+=5;break;case Ac:e=i[o+1],s=i[o+2],t?Oo(d,e,s,i[o+3],i[o+4],[i[o+5],i[o+6],i[o+7],i[o+8]]):Me(d,i,o,9),o+=9;break;case Dc:e=i[o+1],s=i[o+2],t?Oo(d,e,s,i[o+3],i[o+4],i[o+5]):Me(d,i,o,6),o+=6;break;case Lc:Mo(t?d:Me(d,i,o,9),i[o+1],i[o+2],i[o+3],i[o+4],i[o+5],i[o+6],i[o+7],i[o+8],null,pe),e=pe.x,s=pe.y,o+=9;break;case Wc:t?Mo(d,i[o+1],i[o+2],i[o+3],i[o+4],0,0,360,!1):Me(d,i,o,5),e=i[o+1]+i[o+3],s=i[o+2],o+=5;break;case zc:Io(t?d:Me(d,i,o,7),i[o+1],i[o+2],i[o+3],i[o+4],i[o+5],i[o+6],null,pe),e=pe.x,s=pe.y,o+=7;break;case $c:t?Io(d,i[o+1],i[o+2],i[o+3],0,360,!1):Me(d,i,o,4),e=i[o+1]+i[o+3],s=i[o+2],o+=4;break;case Uc:Nc(t?d:Me(d,i,o,6),e,s,i[o+1],i[o+2],i[o+3],i[o+4],i[o+5],null,pe),e=pe.x,s=pe.y,o+=6;break;default:return Hc.error(`command: ${c} [index:${o}]`,i),d}p=c}return d},objectToCanvasData(i){const t=[];return i.forEach(e=>{switch(e.name){case"M":t.push(Bn,e.x,e.y);break;case"L":t.push(zi,e.x,e.y);break;case"C":t.push(fi,e.x1,e.y1,e.x2,e.y2,e.x,e.y);break;case"Q":t.push(_i,e.x1,e.y1,e.x,e.y);break;case"Z":t.push(On)}}),t},copyData(i,t,e,s){for(let n=e,r=e+s;n<r;n++)i.push(t[n])},pushData(i,t){Nt.index===Nt.length&&(Nt.index=1,i.push(Nt.name)),i.push(Number(t)),Nt.index++,Nt.dot=0}},{current:Nt,pushData:Ye,copyData:Me}=ti,{M:In,L:jc,C:Vc,Q:Yc,Z:Zc,N:Do,D:Kc,X:Xc,G:qc,F:Qc,O:Jc,P:td,U:Lo}=Vt,{getMinDistanceFrom:ed,getRadianFrom:id}=D,{tan:sd,min:nd,abs:rd}=Math,pi={},oi={beginPath(i){i.length=0},moveTo(i,t,e){i.push(In,t,e)},lineTo(i,t,e){i.push(jc,t,e)},bezierCurveTo(i,t,e,s,n,r,o){i.push(Vc,t,e,s,n,r,o)},quadraticCurveTo(i,t,e,s,n){i.push(Yc,t,e,s,n)},closePath(i){i.push(Zc)},rect(i,t,e,s,n){i.push(Do,t,e,s,n)},roundRect(i,t,e,s,n,r){if(typeof r=="number")i.push(Xc,t,e,s,n,r);else{const o=bt.fourNumber(r);o?i.push(Kc,t,e,s,n,...o):i.push(Do,t,e,s,n)}},ellipse(i,t,e,s,n,r,o,a,h){r===void 0?i.push(Qc,t,e,s,n):(o===void 0&&(o=0),a===void 0&&(a=360),i.push(qc,t,e,s,n,r,o,a,h?1:0))},arc(i,t,e,s,n,r,o){n===void 0?i.push(td,t,e,s):(r===void 0&&(r=360),i.push(Jc,t,e,s,n,r,o?1:0))},arcTo(i,t,e,s,n,r,o,a){if(o!==void 0){const h=sd(id(o,a,t,e,s,n)/2)*(ed(o,a,t,e,s,n)/2);i.push(Lo,t,e,s,n,nd(r,rd(h)))}else i.push(Lo,t,e,s,n,r)},drawEllipse(i,t,e,s,n,r,o,a,h){Je.ellipse(null,t,e,s,n,r===void 0?0:r,o===void 0?0:o,a===void 0?360:a,h,null,null,pi),i.push(In,pi.x,pi.y),od(i,t,e,s,n,r,o,a,h)},drawArc(i,t,e,s,n,r,o){Je.arc(null,t,e,s,n===void 0?0:n,r===void 0?360:r,o,null,null,pi),i.push(In,pi.x,pi.y),ad(i,t,e,s,n,r,o)},drawPoints(i,t,e,s){Je.points(i,t,e,s)}},{ellipse:od,arc:ad}=oi,{moveTo:hd,lineTo:ld,quadraticCurveTo:cd,bezierCurveTo:dd,closePath:ud,beginPath:fd,rect:_d,roundRect:pd,ellipse:gd,arc:yd,arcTo:md,drawEllipse:xd,drawArc:wd,drawPoints:vd}=oi;class Dr{set path(t){this.__path=t}get path(){return this.__path}constructor(t){this.set(t)}set(t){return t?this.__path=typeof t=="string"?le.parse(t):t:this.__path=[],this}beginPath(){return fd(this.__path),this.paint(),this}moveTo(t,e){return hd(this.__path,t,e),this.paint(),this}lineTo(t,e){return ld(this.__path,t,e),this.paint(),this}bezierCurveTo(t,e,s,n,r,o){return dd(this.__path,t,e,s,n,r,o),this.paint(),this}quadraticCurveTo(t,e,s,n){return cd(this.__path,t,e,s,n),this.paint(),this}closePath(){return ud(this.__path),this.paint(),this}rect(t,e,s,n){return _d(this.__path,t,e,s,n),this.paint(),this}roundRect(t,e,s,n,r){return pd(this.__path,t,e,s,n,r),this.paint(),this}ellipse(t,e,s,n,r,o,a,h){return gd(this.__path,t,e,s,n,r,o,a,h),this.paint(),this}arc(t,e,s,n,r,o){return yd(this.__path,t,e,s,n,r,o),this.paint(),this}arcTo(t,e,s,n,r){return md(this.__path,t,e,s,n,r),this.paint(),this}drawEllipse(t,e,s,n,r,o,a,h){return xd(this.__path,t,e,s,n,r,o,a,h),this.paint(),this}drawArc(t,e,s,n,r,o){return wd(this.__path,t,e,s,n,r,o),this.paint(),this}drawPoints(t,e,s){return vd(this.__path,t,e,s),this.paint(),this}clearPath(){return this.beginPath()}paint(){}}const{M:kd,L:bd,C:Td,Q:Sd,Z:Cd,N:Pd,D:Bd,X:Rd,G:Ed,F:Od,O:Id,P:Md,U:Ad}=Vt,Dd=K.get("PathDrawer"),Ld={drawPathByData(i,t){if(!t)return;let e,s=0,n=t.length;for(;s<n;)switch(e=t[s],e){case kd:i.moveTo(t[s+1],t[s+2]),s+=3;break;case bd:i.lineTo(t[s+1],t[s+2]),s+=3;break;case Td:i.bezierCurveTo(t[s+1],t[s+2],t[s+3],t[s+4],t[s+5],t[s+6]),s+=7;break;case Sd:i.quadraticCurveTo(t[s+1],t[s+2],t[s+3],t[s+4]),s+=5;break;case Cd:i.closePath(),s+=1;break;case Pd:i.rect(t[s+1],t[s+2],t[s+3],t[s+4]),s+=5;break;case Bd:i.roundRect(t[s+1],t[s+2],t[s+3],t[s+4],[t[s+5],t[s+6],t[s+7],t[s+8]]),s+=9;break;case Rd:i.roundRect(t[s+1],t[s+2],t[s+3],t[s+4],t[s+5]),s+=6;break;case Ed:i.ellipse(t[s+1],t[s+2],t[s+3],t[s+4],t[s+5]*Z,t[s+6]*Z,t[s+7]*Z,t[s+8]),s+=9;break;case Od:i.ellipse(t[s+1],t[s+2],t[s+3],t[s+4],0,0,Ht,!1),s+=5;break;case Id:i.arc(t[s+1],t[s+2],t[s+3],t[s+4]*Z,t[s+5]*Z,t[s+6]),s+=7;break;case Md:i.arc(t[s+1],t[s+2],t[s+3],0,Ht,!1),s+=4;break;case Ad:i.arcTo(t[s+1],t[s+2],t[s+3],t[s+4],t[s+5]),s+=6;break;default:Dd.error(`command: ${e} [index:${s}]`,t);return}}},{M:Wd,L:zd,C:Wo,Q:zo,Z:$o,N:$d,D:Uo,X:Ud,G:Fd,F:Nd,O:Gd,P:Hd,U:jd}=Vt,{toTwoPointBounds:Vd,toTwoPointBoundsByQuadraticCurve:Yd,arcTo:Zd,arc:Kd,ellipse:Xd}=Je,{addPointBounds:$i,copy:Mn,addPoint:qd,setPoint:An,addBounds:Ts,toBounds:Qd}=as,Jd=K.get("PathBounds");let gi,Ss,Dn;const zt={},Fo={},ge={},Lr={toBounds(i,t){Lr.toTwoPointBounds(i,Fo),Qd(Fo,t)},toTwoPointBounds(i,t){if(!i||!i.length)return An(t,0,0);let e=0,s=0,n=0,r,o,a,h,l;const c=i.length;for(;e<c;)switch(l=i[e],e===0&&(l===$o||l===Wo||l===zo?An(t,s,n):An(t,i[e+1],i[e+2])),l){case Wd:case zd:s=i[e+1],n=i[e+2],qd(t,s,n),e+=3;break;case Wo:a=i[e+5],h=i[e+6],Vd(s,n,i[e+1],i[e+2],i[e+3],i[e+4],a,h,zt),$i(t,zt),s=a,n=h,e+=7;break;case zo:r=i[e+1],o=i[e+2],a=i[e+3],h=i[e+4],Yd(s,n,r,o,a,h,zt),$i(t,zt),s=a,n=h,e+=5;break;case $o:e+=1;break;case $d:s=i[e+1],n=i[e+2],Ts(t,s,n,i[e+3],i[e+4]),e+=5;break;case Uo:case Ud:s=i[e+1],n=i[e+2],Ts(t,s,n,i[e+3],i[e+4]),e+=l===Uo?9:6;break;case Fd:Xd(null,i[e+1],i[e+2],i[e+3],i[e+4],i[e+5],i[e+6],i[e+7],i[e+8],zt,ge),e===0?Mn(t,zt):$i(t,zt),s=ge.x,n=ge.y,e+=9;break;case Nd:s=i[e+1],n=i[e+2],Ss=i[e+3],Dn=i[e+4],Ts(t,s-Ss,n-Dn,Ss*2,Dn*2),s+=Ss,e+=5;break;case Gd:Kd(null,i[e+1],i[e+2],i[e+3],i[e+4],i[e+5],i[e+6],zt,ge),e===0?Mn(t,zt):$i(t,zt),s=ge.x,n=ge.y,e+=7;break;case Hd:s=i[e+1],n=i[e+2],gi=i[e+3],Ts(t,s-gi,n-gi,gi*2,gi*2),s+=gi,e+=4;break;case jd:Zd(null,s,n,i[e+1],i[e+2],i[e+3],i[e+4],i[e+5],zt,ge),e===0?Mn(t,zt):$i(t,zt),s=ge.x,n=ge.y,e+=6;break;default:Jd.error(`command: ${l} [index:${e}]`,i);return}}},{M:Ln,L:Cs,C:No,Z:Ps}=Vt,{getCenterX:tu,getCenterY:eu}=D,{arcTo:Wn}=oi,iu={smooth(i,t,e){let s,n=0,r=0,o=0,a=0,h=0,l=0,c=0,p=0,f=0;const d=i.length,u=[];for(;n<d;)switch(s=i[n],s){case Ln:a=p=i[n+1],h=f=i[n+2],n+=3,i[n]===Cs?(l=i[n+1],c=i[n+2],u.push(Ln,tu(a,l),eu(h,c))):u.push(Ln,a,h);break;case Cs:switch(r=i[n+1],o=i[n+2],n+=3,i[n]){case Cs:Wn(u,r,o,i[n+1],i[n+2],t,p,f);break;case Ps:Wn(u,r,o,a,h,t,p,f);break;default:u.push(Cs,r,o)}p=r,f=o;break;case No:u.push(No,i[n+1],i[n+2],i[n+3],i[n+4],i[n+5],i[n+6]),n+=7;break;case Ps:Wn(u,a,h,l,c,t,p,f),u.push(Ps),n+=1;break}return s!==Ps&&(u[1]=a,u[2]=h),u}};le.creator=new Dr;le.parse=ti.parse;le.convertToCanvasData=ti.toCanvasData;const Ui=new Dr,{drawRoundRect:su}=Ph;function nu(i){i&&!i.roundRect&&(i.roundRect=function(t,e,s,n,r){su(this,t,e,s,n,r)})}function Bh(i){nu(i)}const be={opacityTypes:["png","webp","svg"],upperCaseTypeMap:{},mineType(i){return!i||i.startsWith("image")?i:(i==="jpg"&&(i="jpeg"),"image/"+i)},fileType(i){const t=i.split(".");return t[t.length-1]},isOpaqueImage(i){const t=wr.fileType(i);return["jpg","jpeg"].some(e=>e===t)},getExportOptions(i){switch(typeof i){case"object":return i;case"number":return{quality:i};case"boolean":return{blob:i};default:return{}}}},wr=be;wr.opacityTypes.forEach(i=>wr.upperCaseTypeMap[i]=i.toUpperCase());const ru=K.get("TaskProcessor");class ou{constructor(t){this.parallel=!0,this.time=1,this.id=Te.create(Te.TASK),this.task=t}run(){return wh(this,void 0,void 0,function*(){try{this.task&&!this.isComplete&&this.parent.running&&(yield this.task())}catch(t){ru.error(t)}})}complete(){this.isComplete=!0,this.parent=null,this.task=null}cancel(){this.isCancel=!0,this.complete()}}class vr{get total(){return this.list.length+this.delayNumber}get finishedIndex(){return this.isComplete?0:this.index+this.parallelSuccessNumber}get remain(){return this.isComplete?this.total:this.total-this.finishedIndex}get percent(){const{total:t}=this;let e=0,s=0;for(let n=0;n<t;n++)n<=this.finishedIndex?(s+=this.list[n].time,n===this.finishedIndex&&(e=s)):e+=this.list[n].time;return this.isComplete?1:s/e}constructor(t){this.config={parallel:6},this.list=[],this.running=!1,this.isComplete=!0,this.index=0,this.delayNumber=0,t&&_t.assign(this.config,t),this.empty()}add(t,e){let s,n,r,o;const a=new ou(t);return a.parent=this,typeof e=="number"?o=e:e&&(n=e.parallel,s=e.start,r=e.time,o=e.delay),r&&(a.time=r),n===!1&&(a.parallel=!1),o===void 0?this.push(a,s):(this.delayNumber++,setTimeout(()=>{this.delayNumber&&(this.delayNumber--,this.push(a,s))},o)),this.isComplete=!1,a}push(t,e){this.list.push(t),e!==!1&&!this.timer&&(this.timer=setTimeout(()=>this.start()))}empty(){this.index=0,this.parallelSuccessNumber=0,this.list=[],this.parallelList=[],this.delayNumber=0}start(){this.running||(this.running=!0,this.isComplete=!1,this.run())}pause(){clearTimeout(this.timer),this.timer=null,this.running=!1}resume(){this.start()}skip(){this.index++,this.resume()}stop(){this.isComplete=!0,this.list.forEach(t=>{t.isComplete||t.cancel()}),this.pause(),this.empty()}run(){this.running&&(this.setParallelList(),this.parallelList.length>1?this.runParallelTasks():this.remain?this.runTask():this.onComplete())}runTask(){const t=this.list[this.index];if(!t){this.nextTask();return}t.run().then(()=>{this.onTask(t),this.index++,this.nextTask()}).catch(e=>{this.onError(e)})}runParallelTasks(){this.parallelList.forEach(t=>this.runParallelTask(t))}runParallelTask(t){t.run().then(()=>{this.onTask(t),this.fillParallelTask()}).catch(e=>{this.onParallelError(e)})}nextTask(){this.total===this.finishedIndex?this.onComplete():this.timer=setTimeout(()=>this.run())}setParallelList(){let t;this.parallelList=[],this.parallelSuccessNumber=0;let e=this.index+this.config.parallel;e>this.list.length&&(e=this.list.length);for(let s=this.index;s<e&&(t=this.list[s],t.parallel);s++)this.parallelList.push(t)}fillParallelTask(){let t;const e=this.parallelList;this.parallelSuccessNumber++,e.pop();const s=e.length,n=this.finishedIndex+s;if(e.length){if(!this.running)return;n<this.total&&(t=this.list[n],t&&t.parallel&&(e.push(t),this.runParallelTask(t)))}else this.index+=this.parallelSuccessNumber,this.parallelSuccessNumber=0,this.nextTask()}onComplete(){this.stop(),this.config.onComplete&&this.config.onComplete()}onTask(t){t.complete(),this.config.onTask&&this.config.onTask()}onParallelError(t){this.parallelList.forEach(e=>{e.parallel=!1}),this.parallelList.length=0,this.parallelSuccessNumber=0,this.onError(t)}onError(t){this.pause(),this.config.onError&&this.config.onError(t)}destroy(){this.stop()}}const At={map:{},recycledList:[],tasker:new vr,patternTasker:new vr,get isComplete(){return ye.tasker.isComplete},get(i){let t=ye.map[i.url];return t||(t=ct.image(i),ye.map[i.url]=t),t.use++,t},recycle(i){i.use--,setTimeout(()=>{i.use||ye.recycledList.push(i)})},clearRecycled(){const i=ye.recycledList;i.length>100&&(i.forEach(t=>{!t.use&&t.url&&(delete ye.map[t.url],t.destroy())}),i.length=0)},hasOpacityPixel(i){return be.opacityTypes.some(t=>ye.isFormat(t,i))},isFormat(i,t){if(t.format===i)return!0;const{url:e}=t;if(e.startsWith("data:")){if(e.startsWith("data:"+be.mineType(i)))return!0}else{if(e.includes("."+i)||e.includes("."+be.upperCaseTypeMap[i]))return!0;if(i==="png"&&!e.includes("."))return!0}return!1},destroy(){ye.map={},ye.recycledList=[]}},ye=At,{IMAGE:au,create:hu}=Te;class Rh{get url(){return this.config.url}get completed(){return this.ready||!!this.error}constructor(t){this.use=0,this.waitComplete=[],this.innerId=hu(au),this.config=t||{url:""},this.isSVG=At.isFormat("svg",t),this.hasOpacityPixel=At.hasOpacityPixel(t)}load(t,e){return this.loading||(this.loading=!0,At.tasker.add(()=>wh(this,void 0,void 0,function*(){return yield S.origin.loadImage(this.url).then(s=>{this.ready=!0,this.width=s.naturalWidth||s.width,this.height=s.naturalHeight||s.height,this.view=s,this.onComplete(!0)}).catch(s=>{this.error=s,this.onComplete(!1)})}))),this.waitComplete.push(t,e),this.waitComplete.length-2}unload(t,e){const s=this.waitComplete;if(e){const n=s[t+1];n&&n({type:"stop"})}s[t]=s[t+1]=void 0}onComplete(t){let e;this.waitComplete.forEach((s,n)=>{e=n%2,s&&(t?e||s(this):e&&s(this.error))}),this.waitComplete.length=0,this.loading=!1}getCanvas(t,e,s,n){if(t||(t=this.width),e||(e=this.height),this.cache){let{params:a,data:h}=this.cache;for(let l in a)if(a[l]!==arguments[l]){h=null;break}if(h)return h}const r=S.origin.createCanvas(t,e),o=r.getContext("2d");return s&&(o.globalAlpha=s),o.drawImage(this.view,0,0,t,e),this.cache=this.use>1?{data:r,params:arguments}:null,r}getPattern(t,e,s,n){const r=S.canvas.createPattern(t,e);try{s&&r.setTransform&&(r.setTransform(s),s=null)}catch{}return n&&(n.transform=s),r}destroy(){this.config={url:""},this.cache=null,this.waitComplete.length=0}}function Ii(i,t,e,s){e.configurable=e.enumerable=!0,Object.defineProperty(i,t,e)}function Eh(i,t){return Object.getOwnPropertyDescriptor(i,t)}function lu(i){return Object.getOwnPropertyNames(i)}function ut(i,t){return(e,s)=>cu(e,s,i,t&&t(s))}function cu(i,t,e,s){Ii(i,t,Object.assign({get(){return this.__getAttr(t)},set(r){this.__setAttr(t,r)}},s||{})),Mh(i,t,e)}function ue(i){return ut(i)}function Mi(i,t){return ut(i,e=>({set(s){this.__setAttr(e,s,t)&&(this.__layout.matrixChanged||this.__layout.matrixChange())}}))}function Ks(i){return ut(i,t=>({set(e){this.__setAttr(t,e)&&(this.__layout.matrixChanged||this.__layout.matrixChange(),this.__hasAutoLayout=!!(this.origin||this.around||this.flow),this.__local||this.__layout.createLocal())}}))}function Oh(i,t){return ut(i,e=>({set(s){this.__setAttr(e,s,t)&&(this.__layout.scaleChanged||this.__layout.scaleChange())}}))}function Wr(i,t){return ut(i,e=>({set(s){this.__setAttr(e,s,t)&&(this.__layout.rotationChanged||this.__layout.rotationChange())}}))}function U(i,t){return ut(i,e=>({set(s){this.__setAttr(e,s,t)&&Ai(this)}}))}function du(i){return ut(i,t=>({set(e){this.__setAttr(t,e)&&(Ai(this),this.__.__removeNaturalSize())}}))}function Ai(i){i.__layout.boxChanged||i.__layout.boxChange(),i.__hasAutoLayout&&(i.__layout.matrixChanged||i.__layout.matrixChange())}function uu(i){return ut(i,t=>({set(e){const s=this.__;s.__pathInputed!==2&&(s.__pathInputed=e?1:0),e||(s.__pathForRender=void 0),this.__setAttr(t,e),Ai(this)}}))}const Rt=U;function Xs(i){return ut(i,t=>({set(e){this.__setAttr(t,e)&&fu(this)}}))}function fu(i){i.__layout.strokeChanged||i.__layout.strokeChange(),i.__.__useArrow&&Ai(i)}const fe=Xs;function Ih(i){return ut(i,t=>({set(e){this.__setAttr(t,e),this.__layout.renderChanged||this.__layout.renderChange()}}))}function hs(i){return ut(i,t=>({set(e){this.__setAttr(t,e)&&(this.__layout.surfaceChanged||this.__layout.surfaceChange())}}))}function _u(i){return ut(i,t=>({set(e){this.__setAttr(t,e)&&(this.__layout.opacityChanged||this.__layout.opacityChange())}}))}function pu(i){return ut(i,t=>({set(e){const s=this.visible;if(s===!0&&e===0){if(this.animationOut)return this.__runAnimation("out",()=>Go(this,t,e,s))}else s===0&&e===!0&&this.animation&&this.__runAnimation("in");Go(this,t,e,s)}}))}function Go(i,t,e,s){i.__setAttr(t,e)&&(i.__layout.opacityChanged||i.__layout.opacityChange(),(s===0||e===0)&&Ai(i))}function gu(i){return ut(i,t=>({set(e){this.__setAttr(t,e)&&(this.__layout.surfaceChanged||this.__layout.surfaceChange(),this.waitParent(()=>{this.parent.__layout.childrenSortChange()}))}}))}function yu(i){return ut(i,t=>({set(e){this.__setAttr(t,e)&&(this.__layout.boxChanged||this.__layout.boxChange(),this.waitParent(()=>{this.parent.__updateMask(e)}))}}))}function mu(i){return ut(i,t=>({set(e){this.__setAttr(t,e)&&this.waitParent(()=>{this.parent.__updateEraser(e)})}}))}function ai(i){return ut(i,t=>({set(e){this.__setAttr(t,e)&&(this.__layout.hitCanvasChanged=!0,K.showHitView&&(this.__layout.surfaceChanged||this.__layout.surfaceChange()),this.leafer&&this.leafer.updateCursor())}}))}function xu(i){return ut(i,t=>({set(e){this.__setAttr(t,e),this.leafer&&this.leafer.updateCursor()}}))}function vt(i){return(t,e)=>{Ii(t,"__DataProcessor",{get(){return i}})}}function wu(i){return"set"+i.charAt(0).toUpperCase()+i.slice(1)}function Mh(i,t,e){const s=i.__DataProcessor.prototype,n="_"+t,r=wu(t),o={get(){const l=this[n];return l===void 0?e:l},set(l){this[n]=l}};if(e===void 0)o.get=function(){return this[n]};else if(typeof e=="object"){const{clone:l}=_t;o.get=function(){let c=this[n];return c===void 0&&(this[n]=c=l(e)),c}}t==="width"?o.get=function(){const l=this[n];if(l===void 0){const c=this;return c._height&&c.__naturalWidth&&c.__useNaturalRatio?c._height*c.__naturalWidth/c.__naturalHeight:c.__naturalWidth||e}else return l}:t==="height"&&(o.get=function(){const l=this[n];if(l===void 0){const c=this;return c._width&&c.__naturalHeight&&c.__useNaturalRatio?c._width*c.__naturalHeight/c.__naturalWidth:c.__naturalHeight||e}else return l});let a,h=s;for(;!a&&h;)a=Eh(h,t),h=h.__proto__;a&&a.set&&(o.set=a.set),s[r]&&(o.set=s[r],delete s[r]),Ii(s,t,o)}const vu=new K("rewrite"),Ds=[],ku=["destroy","constructor"];function ne(i){return(t,e)=>{Ds.push({name:t.constructor.name+"."+e,run:()=>{t[e]=i}})}}function qs(){return i=>{Ah()}}function Ah(i){Ds.length&&(Ds.forEach(t=>{i&&vu.error(t.name,"需在Class上装饰@rewriteAble()"),t.run()}),Ds.length=0)}setTimeout(()=>Ah(!0));function Jt(i,t){return e=>{(i.prototype?lu(i.prototype):Object.keys(i)).forEach(n=>{!ku.includes(n)&&(!t||!t.includes(n))&&(i.prototype?Eh(i.prototype,n).writable&&(e.prototype[n]=i.prototype[n]):e.prototype[n]=i[n])})}}function kt(){return i=>{Zs.register(i)}}function Ne(){return i=>{Bi.register(i)}}const{copy:yi,toInnerPoint:bu,toOuterPoint:Tu,scaleOfOuter:Ho,rotateOfOuter:Su,skewOfOuter:Cu,multiplyParent:jo,divideParent:Vo,getLayout:Pu}=z,ot={},Yt={updateAllMatrix(i,t,e){if(t&&i.__hasAutoLayout&&i.__layout.matrixChanged&&(e=!0),Ru(i,t,e),i.isBranch){const{children:s}=i;for(let n=0,r=s.length;n<r;n++)Bu(s[n],t,e)}},updateMatrix(i,t,e){const s=i.__layout;t?e&&(s.waitAutoLayout=!0,i.__hasAutoLayout&&(s.matrixChanged=!1)):s.waitAutoLayout&&(s.waitAutoLayout=!1),s.matrixChanged&&i.__updateLocalMatrix(),s.waitAutoLayout||i.__updateWorldMatrix()},updateBounds(i){const t=i.__layout;t.boundsChanged&&i.__updateLocalBounds(),t.waitAutoLayout||i.__updateWorldBounds()},updateAllWorldOpacity(i){if(i.__updateWorldOpacity(),i.isBranch){const{children:t}=i;for(let e=0,s=t.length;e<s;e++)Yo(t[e])}},updateAllChange(i){if(Yo(i),i.__updateChange(),i.isBranch){const{children:t}=i;for(let e=0,s=t.length;e<s;e++)Eu(t[e])}},worldHittable(i){for(;i;){if(!i.__.hittable)return!1;i=i.parent}return!0},moveWorld(i,t,e=0,s,n){const r=typeof t=="object"?Object.assign({},t):{x:t,y:e};s?Tu(i.localTransform,r,r,!0):i.parent&&bu(i.parent.worldTransform,r,r,!0),Ct.moveLocal(i,r.x,r.y,n)},moveLocal(i,t,e=0,s){typeof t=="object"&&(e=t.y,t=t.x),t+=i.x,e+=i.y,s?i.animate({x:t,y:e},s):(i.x=t,i.y=e)},zoomOfWorld(i,t,e,s,n){Ct.zoomOfLocal(i,zn(i,t),e,s,n)},zoomOfLocal(i,t,e,s=e,n){yi(ot,i.__localMatrix),Ho(ot,t,e,s),i.origin||i.around?Ct.setTransform(i,ot,n):(Zo(i,ot),i.scaleResize(e,s,n!==!0))},rotateOfWorld(i,t,e){Ct.rotateOfLocal(i,zn(i,t),e)},rotateOfLocal(i,t,e){yi(ot,i.__localMatrix),Su(ot,t,e),i.origin||i.around?Ct.setTransform(i,ot):(Zo(i,ot),i.rotation=bt.formatRotation(i.rotation+e))},skewOfWorld(i,t,e,s,n){Ct.skewOfLocal(i,zn(i,t),e,s,n)},skewOfLocal(i,t,e,s=0,n){yi(ot,i.__localMatrix),Cu(ot,t,e,s),Ct.setTransform(i,ot,n)},transformWorld(i,t,e){yi(ot,i.worldTransform),jo(ot,t),i.parent&&Vo(ot,i.parent.worldTransform),Ct.setTransform(i,ot,e)},transform(i,t,e){yi(ot,i.localTransform),jo(ot,t),Ct.setTransform(i,ot,e)},setTransform(i,t,e){const s=Pu(t,i.origin&&Ct.getInnerOrigin(i,i.origin),i.around&&Ct.getInnerOrigin(i,i.around));if(e){const n=s.scaleX/i.scaleX,r=s.scaleY/i.scaleY;delete s.scaleX,delete s.scaleY,i.set(s),i.scaleResize(n,r,e!==!0)}else i.set(s)},getFlipTransform(i,t){const e=Fs(),s=t==="x"?1:-1;return Ho(e,Ct.getLocalOrigin(i,"center"),-1*s,1*s),e},getLocalOrigin(i,t){return D.tempToOuterOf(Ct.getInnerOrigin(i,t),i.localTransform)},getInnerOrigin(i,t){const e={};return Oi.toPoint(t,i.boxBounds,e),e},getRelativeWorld(i,t,e){return yi(ot,i.worldTransform),Vo(ot,t.worldTransform),e?ot:Object.assign({},ot)},drop(i,t,e,s){i.setTransform(Ct.getRelativeWorld(i,t,!0),s),t.add(i,e)},hasParent(i,t){if(!t)return!1;for(;i;){if(t===i)return!0;i=i.parent}}},Ct=Yt,{updateAllMatrix:Bu,updateMatrix:Ru,updateAllWorldOpacity:Yo,updateAllChange:Eu}=Ct;function Zo(i,t){const{e,f:s}=i.__localMatrix;i.x+=t.e-e,i.y+=t.f-s}function zn(i,t){return i.__layout.update(),i.parent?D.tempToInnerOf(t,i.parent.__world):t}const Qs={worldBounds(i){return i.__world},localBoxBounds(i){return i.__.eraser||i.__.visible===0?null:i.__local||i.__layout},localStrokeBounds(i){return i.__.eraser||i.__.visible===0?null:i.__layout.localStrokeBounds},localRenderBounds(i){return i.__.eraser||i.__.visible===0?null:i.__layout.localRenderBounds},maskLocalBoxBounds(i){return i.__.mask?i.__localBoxBounds:null},maskLocalStrokeBounds(i){return i.__.mask?i.__layout.localStrokeBounds:null},maskLocalRenderBounds(i){return i.__.mask?i.__layout.localRenderBounds:null},excludeRenderBounds(i,t){return!!(t.bounds&&!t.bounds.hit(i.__world,t.matrix)||t.hideBounds&&t.hideBounds.includes(i.__world,t.matrix))}},{updateBounds:Ko}=Yt,ls={sort(i,t){return i.__.zIndex===t.__.zIndex?i.__tempNumber-t.__tempNumber:i.__.zIndex-t.__.zIndex},pushAllChildBranch(i,t){if(i.__tempNumber=1,i.__.__childBranchNumber){const{children:e}=i;for(let s=0,n=e.length;s<n;s++)i=e[s],i.isBranch&&(i.__tempNumber=1,t.add(i),Ou(i,t))}},pushAllParent(i,t){const{keys:e}=t;if(e)for(;i.parent&&e[i.parent.innerId]===void 0;)t.add(i.parent),i=i.parent;else for(;i.parent;)t.add(i.parent),i=i.parent},pushAllBranchStack(i,t){let e=t.length;const{children:s}=i;for(let n=0,r=s.length;n<r;n++)s[n].isBranch&&t.push(s[n]);for(let n=e,r=t.length;n<r;n++)Xo(t[n],t)},updateBounds(i,t){const e=[i];Xo(i,e),Iu(e,t)},updateBoundsByBranchStack(i,t){let e,s;for(let n=i.length-1;n>-1;n--){e=i[n],s=e.children;for(let r=0,o=s.length;r<o;r++)Ko(s[r]);t&&t===e||Ko(e)}}},{pushAllChildBranch:Ou,pushAllBranchStack:Xo,updateBoundsByBranchStack:Iu}=ls,Fi={run(i){if(i&&i.length){const t=i.length;for(let e=0;e<t;e++)i[e]();i.length===t?i.length=0:i.splice(0,t)}}},{getRelativeWorld:qo}=Yt,{toOuterOf:Bs,getPoints:Mu,copy:Au}=O,$n="_localContentBounds",Un="_worldContentBounds",Fn="_worldBoxBounds",Nn="_worldStrokeBounds";class Du{get contentBounds(){return this._contentBounds||this.boxBounds}set contentBounds(t){this._contentBounds=t}get strokeBounds(){return this._strokeBounds||this.boxBounds}get renderBounds(){return this._renderBounds||this.boxBounds}get localContentBounds(){return Bs(this.contentBounds,this.leaf.__localMatrix,this[$n]||(this[$n]={})),this[$n]}get localStrokeBounds(){return this._localStrokeBounds||this}get localRenderBounds(){return this._localRenderBounds||this}get worldContentBounds(){return Bs(this.contentBounds,this.leaf.__world,this[Un]||(this[Un]={})),this[Un]}get worldBoxBounds(){return Bs(this.boxBounds,this.leaf.__world,this[Fn]||(this[Fn]={})),this[Fn]}get worldStrokeBounds(){return Bs(this.strokeBounds,this.leaf.__world,this[Nn]||(this[Nn]={})),this[Nn]}get a(){return 1}get b(){return 0}get c(){return 0}get d(){return 1}get e(){return this.leaf.__.x}get f(){return this.leaf.__.y}get x(){return this.e+this.boxBounds.x}get y(){return this.f+this.boxBounds.y}get width(){return this.boxBounds.width}get height(){return this.boxBounds.height}constructor(t){this.leaf=t,this.boxBounds={x:0,y:0,width:0,height:0},this.leaf.__local&&(this._localRenderBounds=this._localStrokeBounds=this.leaf.__local),this.boxChange(),this.matrixChange()}createLocal(){const t=this.leaf.__local={a:1,b:0,c:0,d:1,e:0,f:0,x:0,y:0,width:0,height:0};this._localStrokeBounds||(this._localStrokeBounds=t),this._localRenderBounds||(this._localRenderBounds=t)}update(){const{leafer:t}=this.leaf;if(t)t.ready?t.watcher.changed&&t.layouter.layout():t.start();else{let e=this.leaf;for(;e.parent&&!e.parent.leafer;)e=e.parent;S.layout(e)}}getTransform(t="world"){this.update();const{leaf:e}=this;switch(t){case"world":return e.__world;case"local":return e.__localMatrix;case"inner":return z.defaultMatrix;case"page":t=e.zoomLayer;default:return qo(e,t)}}getBounds(t,e="world"){switch(this.update(),e){case"world":return this.getWorldBounds(t);case"local":return this.getLocalBounds(t);case"inner":return this.getInnerBounds(t);case"page":e=this.leaf.zoomLayer;default:return new nt(this.getInnerBounds(t)).toOuterOf(this.getTransform(e))}}getInnerBounds(t="box"){switch(t){case"render":return this.renderBounds;case"content":if(this.contentBounds)return this.contentBounds;case"box":return this.boxBounds;case"stroke":return this.strokeBounds}}getLocalBounds(t="box"){switch(t){case"render":return this.localRenderBounds;case"stroke":return this.localStrokeBounds;case"content":if(this.contentBounds)return this.localContentBounds;case"box":return this.leaf.__localBoxBounds}}getWorldBounds(t="box"){switch(t){case"render":return this.leaf.__world;case"stroke":return this.worldStrokeBounds;case"content":if(this.contentBounds)return this.worldContentBounds;case"box":return this.worldBoxBounds}}getLayoutBounds(t,e="world",s){const{leaf:n}=this;let r,o,a,h=this.getInnerBounds(t);switch(e){case"world":r=n.getWorldPoint(h),o=n.__world;break;case"local":const{scaleX:l,scaleY:c,rotation:p,skewX:f,skewY:d}=n.__;a={scaleX:l,scaleY:c,rotation:p,skewX:f,skewY:d},r=n.getLocalPointByInner(h);break;case"inner":r=h,o=z.defaultMatrix;break;case"page":e=n.zoomLayer;default:r=n.getWorldPoint(h,e),o=qo(n,e,!0)}if(a||(a=z.getLayout(o)),Au(a,h),D.copy(a,r),s){const{scaleX:l,scaleY:c}=a,p=Math.abs(l),f=Math.abs(c);(p!==1||f!==1)&&(a.scaleX/=p,a.scaleY/=f,a.width*=p,a.height*=f)}return a}getLayoutPoints(t,e="world"){const{leaf:s}=this,n=Mu(this.getInnerBounds(t));let r;switch(e){case"world":r=null;break;case"local":r=s.parent;break;case"inner":break;case"page":e=s.zoomLayer;default:r=e}return r!==void 0&&n.forEach(o=>s.innerToWorld(o,null,!1,r)),n}shrinkContent(){const{x:t,y:e,width:s,height:n}=this.boxBounds;this._contentBounds={x:t,y:e,width:s,height:n}}spreadStroke(){const{x:t,y:e,width:s,height:n}=this.strokeBounds;this._strokeBounds={x:t,y:e,width:s,height:n},this._localStrokeBounds={x:t,y:e,width:s,height:n},this.renderSpread||this.spreadRenderCancel()}spreadRender(){const{x:t,y:e,width:s,height:n}=this.renderBounds;this._renderBounds={x:t,y:e,width:s,height:n},this._localRenderBounds={x:t,y:e,width:s,height:n}}shrinkContentCancel(){this._contentBounds=void 0}spreadStrokeCancel(){const t=this.renderBounds===this.strokeBounds;this._strokeBounds=this.boxBounds,this._localStrokeBounds=this.leaf.__localBoxBounds,t&&this.spreadRenderCancel()}spreadRenderCancel(){this._renderBounds=this._strokeBounds,this._localRenderBounds=this._localStrokeBounds}boxChange(){this.boxChanged=!0,this.localBoxChanged||this.localBoxChange(),this.hitCanvasChanged=!0}localBoxChange(){this.localBoxChanged=!0,this.boundsChanged=!0}strokeChange(){this.strokeChanged=!0,this.strokeSpread||(this.strokeSpread=1),this.boundsChanged=!0,this.hitCanvasChanged=!0}renderChange(){this.renderChanged=!0,this.renderSpread||(this.renderSpread=1),this.boundsChanged=!0}scaleChange(){this.scaleChanged=!0,this._scaleOrRotationChange()}rotationChange(){this.rotationChanged=!0,this.affectRotation=!0,this._scaleOrRotationChange()}_scaleOrRotationChange(){this.affectScaleOrRotation=!0,this.matrixChange(),this.leaf.__local||this.createLocal()}matrixChange(){this.matrixChanged=!0,this.localBoxChanged||this.localBoxChange()}surfaceChange(){this.surfaceChanged=!0}opacityChange(){this.opacityChanged=!0,this.surfaceChanged||this.surfaceChange()}childrenSortChange(){this.childrenSortChanged||(this.childrenSortChanged=!0,this.leaf.forceUpdate("surface"))}destroy(){}}class Ce{constructor(t,e){this.bubbles=!1,this.type=t,e&&(this.target=e)}stopDefault(){this.isStopDefault=!0,this.origin&&S.event.stopDefault(this.origin)}stopNow(){this.isStopNow=!0,this.isStop=!0,this.origin&&S.event.stopNow(this.origin)}stop(){this.isStop=!0,this.origin&&S.event.stop(this.origin)}}class ht extends Ce{constructor(t,e,s){super(t,e),this.parent=s,this.child=e}}ht.ADD="child.add";ht.REMOVE="child.remove";ht.CREATED="created";ht.MOUNTED="mounted";ht.UNMOUNTED="unmounted";ht.DESTROY="destroy";class ke extends Ce{constructor(t,e,s,n,r){super(t,e),this.attrName=s,this.oldValue=n,this.newValue=r}}ke.CHANGE="property.change";ke.LEAFER_CHANGE="property.leafer_change";class Zt extends Ce{constructor(t,e){super(t),Object.assign(this,e)}}Zt.LOAD="image.load";Zt.LOADED="image.loaded";Zt.ERROR="image.error";class Ge extends Ce{get bigger(){if(!this.old)return!0;const{width:t,height:e}=this.old;return this.width>=t&&this.height>=e}get smaller(){return!this.bigger}get samePixelRatio(){return this.old?this.pixelRatio===this.old.pixelRatio:!0}constructor(t,e){typeof t=="object"?(super(Ge.RESIZE),Object.assign(this,t)):super(t),this.old=e}}Ge.RESIZE="resize";class Le extends Ce{constructor(t,e){super(t),this.data=e}}Le.REQUEST="watch.request";Le.DATA="watch.data";class q extends Ce{constructor(t,e,s){super(t),e&&(this.data=e,this.times=s)}}q.CHECK_UPDATE="layout.check_update";q.REQUEST="layout.request";q.START="layout.start";q.BEFORE="layout.before";q.LAYOUT="layout";q.AFTER="layout.after";q.AGAIN="layout.again";q.END="layout.end";class Q extends Ce{constructor(t,e,s,n){super(t),e&&(this.times=e),s&&(this.renderBounds=s,this.renderOptions=n)}}Q.REQUEST="render.request";Q.CHILD_START="render.child_start";Q.START="render.start";Q.BEFORE="render.before";Q.RENDER="render";Q.AFTER="render.after";Q.AGAIN="render.again";Q.END="render.end";Q.NEXT="render.next";class at extends Ce{}at.START="leafer.start";at.BEFORE_READY="leafer.before_ready";at.READY="leafer.ready";at.AFTER_READY="leafer.after_ready";at.VIEW_READY="leafer.view_ready";at.VIEW_COMPLETED="leafer.view_completed";at.STOP="leafer.stop";at.RESTART="leafer.restart";at.END="leafer.end";const Qo={};class Lu{set event(t){this.on(t)}on(t,e,s){if(!e){let c,p=t;for(let f in p)c=p[f],c instanceof Array?this.on(f,c[0],c[1]):this.on(f,c);return}let n,r;s&&(s==="once"?r=!0:typeof s=="boolean"?n=s:(n=s.capture,r=s.once));let o;const a=Gn(this,n,!0),h=typeof t=="string"?t.split(" "):t,l=r?{listener:e,once:r}:{listener:e};h.forEach(c=>{c&&(o=a[c],o?o.findIndex(p=>p.listener===e)===-1&&o.push(l):a[c]=[l])})}off(t,e,s){if(t){const n=typeof t=="string"?t.split(" "):t;if(e){let r;s&&(r=typeof s=="boolean"?s:s==="once"?!1:s.capture);let o,a;const h=Gn(this,r);n.forEach(l=>{l&&(o=h[l],o&&(a=o.findIndex(c=>c.listener===e),a>-1&&o.splice(a,1),o.length||delete h[l]))})}else{const{__bubbleMap:r,__captureMap:o}=this;n.forEach(a=>{r&&delete r[a],o&&delete o[a]})}}else this.__bubbleMap=this.__captureMap=void 0}on_(t,e,s,n){return s&&(e=e.bind(s)),this.on(t,e,n),{type:t,current:this,listener:e,options:n}}off_(t){if(!t)return;const e=t instanceof Array?t:[t];e.forEach(s=>s.current.off(s.type,s.listener,s.options)),e.length=0}once(t,e,s){this.on(t,e,{once:!0,capture:s})}emit(t,e,s){!e&&Bi.has(t)&&(e=Bi.get(t,{type:t,target:this,current:this}));const r=Gn(this,s)[t];if(r){let o;for(let a=0,h=r.length;a<h&&(o=r[a],o.listener(e),o.once&&(this.off(t,o.listener,s),a--,h--),!(e&&e.isStopNow));a++);}this.syncEventer&&this.syncEventer.emitEvent(e,s)}emitEvent(t,e){t.current=this,this.emit(t.type,t,e)}hasEvent(t,e){if(this.syncEventer&&this.syncEventer.hasEvent(t,e))return!0;const{__bubbleMap:s,__captureMap:n}=this,r=s&&s[t],o=n&&n[t];return!!(e===void 0?r||o:e?o:r)}destroy(){this.__captureMap=this.__bubbleMap=this.syncEventer=null}}function Gn(i,t,e){if(t){const{__captureMap:s}=i;return s||(e?i.__captureMap={}:Qo)}else{const{__bubbleMap:s}=i;return s||(e?i.__bubbleMap={}:Qo)}}const{on:Wu,on_:zu,off:$u,off_:Uu,once:Fu,emit:Nu,emitEvent:Gu,hasEvent:Hu,destroy:ju}=Lu.prototype,Vu={on:Wu,on_:zu,off:$u,off_:Uu,once:Fu,emit:Nu,emitEvent:Gu,hasEvent:Hu,destroyEventer:ju},{isFinite:Yu}=Number,Zu=K.get("setAttr"),Ku={__setAttr(i,t,e){if(this.leaferIsCreated){const s=this.__.__getInput(i);if(e&&!Yu(t)&&t!==void 0&&(Zu.warn(this.innerName,i,t),t=void 0),typeof t=="object"||s!==t){this.__realSetAttr(i,t);const{CHANGE:n}=ke,r=new ke(n,this,i,s,t);return this.isLeafer?this.emitEvent(new ke(ke.LEAFER_CHANGE,this,i,s,t)):this.hasEvent(n)&&this.emitEvent(r),this.leafer.emitEvent(r),!0}else return!1}else return this.__realSetAttr(i,t),!0},__realSetAttr(i,t){const e=this.__;e[i]=t,this.__proxyData&&this.setProxyAttr(i,t),e.normalStyle&&(this.lockNormalStyle||e.normalStyle[i]===void 0||(e.normalStyle[i]=t))},__getAttr(i){return this.__proxyData?this.getProxyAttr(i):this.__.__get(i)}},{setLayout:Xu,multiplyParent:qu,translateInner:Qu,defaultWorld:Ju}=z,{toPoint:tf,tempPoint:Hn}=Oi,ef={__updateWorldMatrix(){qu(this.__local||this.__layout,this.parent?this.parent.__world:Ju,this.__world,!!this.__layout.affectScaleOrRotation,this.__,this.parent&&this.parent.__)},__updateLocalMatrix(){if(this.__local){const i=this.__layout,t=this.__local,e=this.__;i.affectScaleOrRotation&&(i.scaleChanged||i.rotationChanged)&&(Xu(t,e,null,null,i.affectRotation),i.scaleChanged=i.rotationChanged=!1),t.e=e.x+e.offsetX,t.f=e.y+e.offsetY,(e.around||e.origin)&&(tf(e.around||e.origin,i.boxBounds,Hn),Qu(t,-Hn.x,-Hn.y,!e.around))}this.__layout.matrixChanged=!1}},{updateMatrix:sf,updateAllMatrix:Jo}=Yt,{updateBounds:ta}=ls,{toOuterOf:Rs,copyAndSpread:ea,copy:nf}=O,{toBounds:rf}=Lr,of={__updateWorldBounds(){Rs(this.__layout.renderBounds,this.__world,this.__world),this.__layout.resized&&(this.__onUpdateSize(),this.__layout.resized=!1)},__updateLocalBounds(){const i=this.__layout;i.boxChanged&&(this.__.__pathInputed||this.__updatePath(),this.__updateRenderPath(),this.__updateBoxBounds(),i.resized=!0),i.localBoxChanged&&(this.__local&&this.__updateLocalBoxBounds(),i.localBoxChanged=!1,i.strokeSpread&&(i.strokeChanged=!0),i.renderSpread&&(i.renderChanged=!0),this.parent&&this.parent.__layout.boxChange()),i.boxChanged=!1,i.strokeChanged&&(i.strokeSpread=this.__updateStrokeSpread(),i.strokeSpread?(i.strokeBounds===i.boxBounds&&i.spreadStroke(),this.__updateStrokeBounds(),this.__updateLocalStrokeBounds()):i.spreadStrokeCancel(),i.strokeChanged=!1,(i.renderSpread||i.strokeSpread!==i.strokeBoxSpread)&&(i.renderChanged=!0),this.parent&&this.parent.__layout.strokeChange(),i.resized=!0),i.renderChanged&&(i.renderSpread=this.__updateRenderSpread(),i.renderSpread?((i.renderBounds===i.boxBounds||i.renderBounds===i.strokeBounds)&&i.spreadRender(),this.__updateRenderBounds(),this.__updateLocalRenderBounds()):i.spreadRenderCancel(),i.renderChanged=!1,this.parent&&this.parent.__layout.renderChange()),i.boundsChanged=!1},__updateLocalBoxBounds(){this.__hasMotionPath&&this.__updateMotionPath(),this.__hasAutoLayout&&this.__updateAutoLayout(),Rs(this.__layout.boxBounds,this.__local,this.__local)},__updateLocalStrokeBounds(){Rs(this.__layout.strokeBounds,this.__localMatrix,this.__layout.localStrokeBounds)},__updateLocalRenderBounds(){Rs(this.__layout.renderBounds,this.__localMatrix,this.__layout.localRenderBounds)},__updateBoxBounds(){const i=this.__layout.boxBounds,t=this.__;t.__pathInputed?rf(t.path,i):(i.x=0,i.y=0,i.width=t.width,i.height=t.height)},__updateAutoLayout(){this.__layout.matrixChanged=!0,this.isBranch?(this.leaferIsReady&&this.leafer.layouter.addExtra(this),this.__.flow?(this.__layout.boxChanged&&this.__updateFlowLayout(),Jo(this),ta(this,this),this.__.__autoSide&&this.__updateBoxBounds(!0)):(Jo(this),ta(this,this))):sf(this)},__updateNaturalSize(){const{__:i,__layout:t}=this;i.__naturalWidth=t.boxBounds.width,i.__naturalHeight=t.boxBounds.height},__updateStrokeBounds(){const i=this.__layout;ea(i.strokeBounds,i.boxBounds,i.strokeBoxSpread)},__updateRenderBounds(){const i=this.__layout;i.renderSpread>0?ea(i.renderBounds,i.boxBounds,i.renderSpread):nf(i.renderBounds,i.strokeBounds)}},af={__render(i,t){if(this.__worldOpacity)if(i.setWorld(this.__nowWorld=this.__getNowWorld(t)),i.opacity=this.__.opacity,this.__.__single){if(this.__.eraser==="path")return this.__renderEraser(i,t);const e=i.getSameCanvas(!0,!0);this.__draw(e,t),this.__worldFlipped?i.copyWorldByReset(e,this.__nowWorld,null,this.__.__blendMode,!0):i.copyWorldToInner(e,this.__nowWorld,this.__layout.renderBounds,this.__.__blendMode),e.recycle(this.__nowWorld)}else this.__draw(i,t)},__clip(i,t){this.__worldOpacity&&(i.setWorld(this.__nowWorld=this.__getNowWorld(t)),this.__drawRenderPath(i),this.windingRule?i.clip(this.windingRule):i.clip())},__updateWorldOpacity(){this.__worldOpacity=this.__.visible?this.parent?this.parent.__worldOpacity*this.__.opacity:this.__.opacity:0,this.__layout.opacityChanged&&(this.__layout.opacityChanged=!1)}},{excludeRenderBounds:ia}=Qs,hf={__updateChange(){const{__layout:i}=this;i.childrenSortChanged&&(this.__updateSortChildren(),i.childrenSortChanged=!1),this.__.__checkSingle()},__render(i,t){if(this.__nowWorld=this.__getNowWorld(t),this.__worldOpacity)if(this.__.__single){if(this.__.eraser==="path")return this.__renderEraser(i,t);const e=i.getSameCanvas(!1,!0);this.__renderBranch(e,t);const s=this.__nowWorld;i.opacity=this.__.opacity,i.copyWorldByReset(e,s,s,this.__.__blendMode,!0),e.recycle(s)}else this.__renderBranch(i,t)},__renderBranch(i,t){if(this.__hasMask)this.__renderMask(i,t);else{const{children:e}=this;for(let s=0,n=e.length;s<n;s++)ia(e[s],t)||e[s].__render(i,t)}},__clip(i,t){if(this.__worldOpacity){const{children:e}=this;for(let s=0,n=e.length;s<n;s++)ia(e[s],t)||e[s].__clip(i,t)}}},{LEAF:lf,create:cf}=Te,{toInnerPoint:df,toOuterPoint:uf,multiplyParent:ff}=z,{toOuterOf:sa}=O,{copy:na,move:ra}=D,{moveLocal:_f,zoomOfLocal:pf,rotateOfLocal:gf,skewOfLocal:yf,moveWorld:oa,zoomOfWorld:mf,rotateOfWorld:xf,skewOfWorld:wf,transform:aa,transformWorld:vf,setTransform:kf,getFlipTransform:bf,getLocalOrigin:jn,getRelativeWorld:Tf,drop:Sf}=Yt;let ei=class{get tag(){return this.__tag}set tag(t){}get __tag(){return"Leaf"}get innerName(){return this.__.name||this.tag+this.innerId}get __DataProcessor(){return xh}get __LayoutProcessor(){return Du}get leaferIsCreated(){return this.leafer&&this.leafer.created}get leaferIsReady(){return this.leafer&&this.leafer.ready}get isLeafer(){return!1}get isBranch(){return!1}get isBranchLeaf(){return!1}get __localMatrix(){return this.__local||this.__layout}get __localBoxBounds(){return this.__local||this.__layout}get worldTransform(){return this.__layout.getTransform("world")}get localTransform(){return this.__layout.getTransform("local")}get boxBounds(){return this.getBounds("box","inner")}get renderBounds(){return this.getBounds("render","inner")}get worldBoxBounds(){return this.getBounds("box")}get worldStrokeBounds(){return this.getBounds("stroke")}get worldRenderBounds(){return this.getBounds("render")}get worldOpacity(){return this.__layout.update(),this.__worldOpacity}get __worldFlipped(){return this.__world.scaleX<0||this.__world.scaleY<0}get __onlyHitMask(){return this.__hasMask&&!this.__.hitChildren}get __ignoreHitWorld(){return(this.__hasMask||this.__hasEraser)&&this.__.hitChildren}get __inLazyBounds(){const{leafer:t}=this;return t&&t.created&&t.lazyBounds.hit(this.__world)}get pathInputed(){return this.__.__pathInputed}set event(t){this.on(t)}constructor(t){this.innerId=cf(lf),this.reset(t),this.__bubbleMap&&this.__emitLifeEvent(ht.CREATED)}reset(t){this.leafer&&this.leafer.forceRender(this.__world),this.__world={a:1,b:0,c:0,d:1,e:0,f:0,x:0,y:0,width:0,height:0,scaleX:1,scaleY:1},t!==null&&(this.__local={a:1,b:0,c:0,d:1,e:0,f:0,x:0,y:0,width:0,height:0}),this.__worldOpacity=1,this.__=new this.__DataProcessor(this),this.__layout=new this.__LayoutProcessor(this),this.__level&&this.resetCustom(),t&&(t.__&&(t=t.toJSON()),t.children?this.set(t):Object.assign(this,t))}resetCustom(){this.__hasMask=this.__hasEraser=null,this.forceUpdate()}waitParent(t,e){e&&(t=t.bind(e)),this.parent?t():this.on(ht.ADD,t,"once")}waitLeafer(t,e){e&&(t=t.bind(e)),this.leafer?t():this.on(ht.MOUNTED,t,"once")}nextRender(t,e,s){this.leafer?this.leafer.nextRender(t,e,s):this.waitLeafer(()=>this.leafer.nextRender(t,e,s))}removeNextRender(t){this.nextRender(t,null,"off")}__bindLeafer(t){if(this.isLeafer&&t!==null&&(t=this),this.leafer&&!t&&this.leafer.leafs--,this.leafer=t,t?(t.leafs++,this.__level=this.parent?this.parent.__level+1:1,this.animation&&this.__runAnimation("in"),this.__bubbleMap&&this.__emitLifeEvent(ht.MOUNTED)):this.__emitLifeEvent(ht.UNMOUNTED),this.isBranch){const{children:e}=this;for(let s=0,n=e.length;s<n;s++)e[s].__bindLeafer(t)}}set(t,e){}get(t){}setAttr(t,e){this[t]=e}getAttr(t){return this[t]}getComputedAttr(t){return this.__[t]}toJSON(t){return t&&this.__layout.update(),this.__.__getInputData(null,t)}toString(t){return JSON.stringify(this.toJSON(t))}toSVG(){}__SVG(t){}toHTML(){}__setAttr(t,e){return!0}__getAttr(t){}setProxyAttr(t,e){}getProxyAttr(t){}find(t,e){}findTag(t){}findOne(t,e){}findId(t){}focus(t){}updateState(){}updateLayout(){this.__layout.update()}forceUpdate(t){t===void 0?t="width":t==="surface"&&(t="blendMode");const e=this.__.__getInput(t);this.__[t]=e===void 0?null:void 0,this[t]=e}forceRender(t){this.forceUpdate("surface")}__updateWorldMatrix(){}__updateLocalMatrix(){}__updateWorldBounds(){}__updateLocalBounds(){}__updateLocalBoxBounds(){}__updateLocalStrokeBounds(){}__updateLocalRenderBounds(){}__updateBoxBounds(){}__updateContentBounds(){}__updateStrokeBounds(){}__updateRenderBounds(){}__updateAutoLayout(){}__updateFlowLayout(){}__updateNaturalSize(){}__updateStrokeSpread(){return 0}__updateRenderSpread(){return 0}__onUpdateSize(){}__updateEraser(t){this.__hasEraser=t?!0:this.children.some(e=>e.__.eraser)}__renderEraser(t,e){t.save(),this.__clip(t,e);const{renderBounds:s}=this.__layout;t.clearRect(s.x,s.y,s.width,s.height),t.restore()}__updateMask(t){this.__hasMask=t?!0:this.children.some(e=>e.__.mask)}__renderMask(t,e){}__getNowWorld(t){if(t.matrix){this.__cameraWorld||(this.__cameraWorld={});const e=this.__cameraWorld;return ff(this.__world,t.matrix,e,void 0,this.__world),sa(this.__layout.renderBounds,e,e),e}else return this.__world}getTransform(t){return this.__layout.getTransform(t||"local")}getBounds(t,e){return this.__layout.getBounds(t,e)}getLayoutBounds(t,e,s){return this.__layout.getLayoutBounds(t,e,s)}getLayoutPoints(t,e){return this.__layout.getLayoutPoints(t,e)}getWorldBounds(t,e,s){const n=e?Tf(this,e):this.worldTransform,r=s?t:{};return sa(t,n,r),r}worldToLocal(t,e,s,n){this.parent?this.parent.worldToInner(t,e,s,n):e&&na(e,t)}localToWorld(t,e,s,n){this.parent?this.parent.innerToWorld(t,e,s,n):e&&na(e,t)}worldToInner(t,e,s,n){n&&(n.innerToWorld(t,e,s),t=e||t),df(this.worldTransform,t,e,s)}innerToWorld(t,e,s,n){uf(this.worldTransform,t,e,s),n&&n.worldToInner(e||t,null,s)}getBoxPoint(t,e,s,n){return this.getBoxPointByInner(this.getInnerPoint(t,e,s,n),null,null,!0)}getBoxPointByInner(t,e,s,n){const r=n?t:Object.assign({},t),{x:o,y:a}=this.boxBounds;return ra(r,-o,-a),r}getInnerPoint(t,e,s,n){const r=n?t:{};return this.worldToInner(t,r,s,e),r}getInnerPointByBox(t,e,s,n){const r=n?t:Object.assign({},t),{x:o,y:a}=this.boxBounds;return ra(r,o,a),r}getInnerPointByLocal(t,e,s,n){return this.getInnerPoint(t,this.parent,s,n)}getLocalPoint(t,e,s,n){const r=n?t:{};return this.worldToLocal(t,r,s,e),r}getLocalPointByInner(t,e,s,n){return this.getWorldPoint(t,this.parent,s,n)}getPagePoint(t,e,s,n){return(this.leafer?this.leafer.zoomLayer:this).getInnerPoint(t,e,s,n)}getWorldPoint(t,e,s,n){const r=n?t:{};return this.innerToWorld(t,r,s,e),r}getWorldPointByBox(t,e,s,n){return this.getWorldPoint(this.getInnerPointByBox(t,null,null,n),e,s,!0)}getWorldPointByLocal(t,e,s,n){const r=n?t:{};return this.localToWorld(t,r,s,e),r}getWorldPointByPage(t,e,s,n){return(this.leafer?this.leafer.zoomLayer:this).getWorldPoint(t,e,s,n)}setTransform(t,e){kf(this,t,e)}transform(t,e){aa(this,t,e)}move(t,e,s){_f(this,t,e,s)}moveInner(t,e,s){oa(this,t,e,!0,s)}scaleOf(t,e,s,n){pf(this,jn(this,t),e,s,n)}rotateOf(t,e){gf(this,jn(this,t),e)}skewOf(t,e,s,n){yf(this,jn(this,t),e,s,n)}transformWorld(t,e){vf(this,t,e)}moveWorld(t,e,s){oa(this,t,e,!1,s)}scaleOfWorld(t,e,s,n){mf(this,t,e,s,n)}rotateOfWorld(t,e){xf(this,t,e)}skewOfWorld(t,e,s,n){wf(this,t,e,s,n)}flip(t){aa(this,bf(this,t))}scaleResize(t,e=t,s){this.scaleX*=t,this.scaleY*=e}__scaleResize(t,e){}resizeWidth(t){}resizeHeight(t){}__hitWorld(t){return!0}__hit(t){return!0}__hitFill(t){return!0}__hitStroke(t,e){return!0}__hitPixel(t){return!0}__drawHitPath(t){}__updateHitCanvas(){}__render(t,e){}__drawFast(t,e){}__draw(t,e){}__clip(t,e){}__renderShape(t,e,s,n){}__updateWorldOpacity(){}__updateChange(){}__drawPath(t){}__drawRenderPath(t){}__updatePath(){}__updateRenderPath(){}getMotionPathData(){return Pi("path")}getMotionPoint(t){return Pi("path")}getMotionTotal(){return 0}__updateMotionPath(){}__runAnimation(t,e){}__updateSortChildren(){}add(t,e){}remove(t,e){this.parent&&this.parent.remove(this,e)}dropTo(t,e,s){Sf(this,t,e,s)}on(t,e,s){}off(t,e,s){}on_(t,e,s,n){}off_(t){}once(t,e,s){}emit(t,e,s){}emitEvent(t,e){}hasEvent(t,e){return!1}static changeAttr(t,e,s){s?this.addAttr(t,e,s):Mh(this.prototype,t,e)}static addAttr(t,e,s){s||(s=U),s(e)(this.prototype,t)}__emitLifeEvent(t){this.hasEvent(t)&&this.emitEvent(new ht(t,this,this.parent))}destroy(){this.destroyed||(this.parent&&this.remove(),this.children&&this.clear(),this.__emitLifeEvent(ht.DESTROY),this.__.destroy(),this.__layout.destroy(),this.destroyEventer(),this.destroyed=!0)}};ei=R([Jt(Ku),Jt(ef),Jt(of),Jt(Vu),Jt(af)],ei);const{setListWithFn:Vn}=O,{sort:Cf}=ls,{localBoxBounds:Pf,localStrokeBounds:Bf,localRenderBounds:Rf,maskLocalBoxBounds:Ef,maskLocalStrokeBounds:Of,maskLocalRenderBounds:If}=Qs;let kr=class extends ei{__updateStrokeSpread(){const{children:t}=this;for(let e=0,s=t.length;e<s;e++)if(t[e].__layout.strokeSpread)return 1;return 0}__updateRenderSpread(){const{children:t}=this;for(let e=0,s=t.length;e<s;e++)if(t[e].__layout.renderSpread)return 1;return 0}__updateBoxBounds(){Vn(this.__layout.boxBounds,this.children,this.__hasMask?Ef:Pf)}__updateStrokeBounds(){Vn(this.__layout.strokeBounds,this.children,this.__hasMask?Of:Bf)}__updateRenderBounds(){Vn(this.__layout.renderBounds,this.children,this.__hasMask?If:Rf)}__updateSortChildren(){let t;const{children:e}=this;if(e.length>1){for(let s=0,n=e.length;s<n;s++)e[s].__tempNumber=s,e[s].__.zIndex&&(t=!0);e.sort(Cf),this.__layout.affectChildrenSort=t}}add(t,e){if(t===this)return;const s=e===void 0;if(!t.__){if(t instanceof Array)return t.forEach(n=>{this.add(n,e),s||e++});t=Zs.get(t.tag,t)}t.parent&&t.parent.remove(t),t.parent=this,s?this.children.push(t):this.children.splice(e,0,t),t.isBranch&&(this.__.__childBranchNumber=(this.__.__childBranchNumber||0)+1),t.__layout.boxChanged||t.__layout.boxChange(),t.__layout.matrixChanged||t.__layout.matrixChange(),t.__bubbleMap&&t.__emitLifeEvent(ht.ADD),this.leafer&&(t.__bindLeafer(this.leafer),this.leafer.created&&this.__emitChildEvent(ht.ADD,t)),this.__layout.affectChildrenSort&&this.__layout.childrenSortChange()}addMany(...t){this.add(t)}remove(t,e){t?t.__?t.animationOut?t.__runAnimation("out",()=>this.__remove(t,e)):this.__remove(t,e):this.find(t).forEach(s=>this.remove(s,e)):t===void 0&&super.remove(null,e)}removeAll(t){const{children:e}=this;e.length&&(this.children=[],this.__preRemove(),this.__.__childBranchNumber=0,e.forEach(s=>{this.__realRemoveChild(s),t&&s.destroy()}))}clear(){this.removeAll(!0)}__remove(t,e){const s=this.children.indexOf(t);s>-1&&(this.children.splice(s,1),t.isBranch&&(this.__.__childBranchNumber=(this.__.__childBranchNumber||1)-1),this.__preRemove(),this.__realRemoveChild(t),e&&t.destroy())}__preRemove(){this.__hasMask&&this.__updateMask(),this.__hasEraser&&this.__updateEraser(),this.__layout.boxChange(),this.__layout.affectChildrenSort&&this.__layout.childrenSortChange()}__realRemoveChild(t){t.__emitLifeEvent(ht.REMOVE),t.parent=null,this.leafer&&(t.__bindLeafer(null),this.leafer.created&&(this.__emitChildEvent(ht.REMOVE,t),this.leafer.hitCanvasManager&&this.leafer.hitCanvasManager.clear()))}__emitChildEvent(t,e){const s=new ht(t,e,this);this.hasEvent(t)&&!this.isLeafer&&this.emitEvent(s),this.leafer.emitEvent(s)}};kr=R([Jt(hf)],kr);class lt{get length(){return this.list.length}constructor(t){this.reset(),t&&(t instanceof Array?this.addList(t):this.add(t))}has(t){return t&&this.keys[t.innerId]!==void 0}indexAt(t){return this.list[t]}indexOf(t){const e=this.keys[t.innerId];return e===void 0?-1:e}add(t){const{list:e,keys:s}=this;s[t.innerId]===void 0&&(e.push(t),s[t.innerId]=e.length-1)}addAt(t,e=0){const{keys:s}=this;if(s[t.innerId]===void 0){const{list:n}=this;for(let r=e,o=n.length;r<o;r++)s[n[r].innerId]++;e===0?n.unshift(t):(e>n.length&&(e=n.length),n.splice(e,0,t)),s[t.innerId]=e}}addList(t){for(let e=0;e<t.length;e++)this.add(t[e])}remove(t){const{list:e}=this;let s;for(let n=0,r=e.length;n<r;n++)s!==void 0?this.keys[e[n].innerId]=n-1:e[n].innerId===t.innerId&&(s=n,delete this.keys[t.innerId]);s!==void 0&&e.splice(s,1)}sort(t){const{list:e}=this;t?e.sort((s,n)=>n.__level-s.__level):e.sort((s,n)=>s.__level-n.__level)}forEach(t){this.list.forEach(t)}clone(){const t=new lt;return t.list=[...this.list],t.keys=Object.assign({},this.keys),t}update(){this.keys={};const{list:t,keys:e}=this;for(let s=0,n=t.length;s<n;s++)e[t[s].innerId]=s}reset(){this.list=[],this.keys={}}destroy(){this.reset()}}class Mf{get length(){return this._length}constructor(t){this._length=0,this.reset(),t&&(t instanceof Array?this.addList(t):this.add(t))}has(t){return this.keys[t.innerId]!==void 0}without(t){return this.keys[t.innerId]===void 0}sort(t){const{levels:e}=this;t?e.sort((s,n)=>n-s):e.sort((s,n)=>s-n)}addList(t){t.forEach(e=>{this.add(e)})}add(t){const{keys:e,levelMap:s}=this;e[t.innerId]||(e[t.innerId]=1,s[t.__level]?s[t.__level].push(t):(s[t.__level]=[t],this.levels.push(t.__level)),this._length++)}forEach(t){let e;this.levels.forEach(s=>{e=this.levelMap[s];for(let n=0,r=e.length;n<r;n++)t(e[n])})}reset(){this.levelMap={},this.keys={},this.levels=[],this._length=0}destroy(){this.levelMap=null}}function _(i,t,e,s){var n=arguments.length,r=n<3?t:s===null?s=Object.getOwnPropertyDescriptor(t,e):s,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(i,t,e,s);else for(var a=i.length-1;a>=0;a--)(o=i[a])&&(r=(n<3?o(r):n>3?o(t,e,r):o(t,e))||r);return n>3&&r&&Object.defineProperty(t,e,r),r}function cs(i){return ut(i,t=>({set(e){this.__setAttr(t,e),e&&(this.__.__useEffect=!0),this.__layout.renderChanged||this.__layout.renderChange()}}))}function ds(i){return ut(i,t=>({set(e){this.__setAttr(t,e),this.__layout.boxChanged||this.__layout.boxChange(),this.__updateSize()}}))}function Af(){return(i,t)=>{const e="_"+t;Ii(i,t,{set(s){this.isLeafer&&(this[e]=s)},get(){return this.isApp?this.tree.zoomLayer:this.isLeafer?this[e]||this:this.leafer&&this.leafer.zoomLayer}})}}const Dh={},ii={},ha={number(i,t){return typeof i=="object"?i.type==="percent"?i.value*t:i.value:i}},Lh={},pt={},si={},Ls={},br={},bi={},la={setStyleName(i,t,e){return Pi("state")},set(i,t){return Pi("state")}},{parse:Df,objectToCanvasData:Lf}=ti,ca={},da=K.get("UIData");class Pe extends xh{get scale(){const{scaleX:t,scaleY:e}=this;return t!==e?{x:t,y:e}:t}get __strokeWidth(){const{strokeWidth:t,strokeWidthFixed:e}=this;if(e){const s=this.__leaf;let{scaleX:n}=s.__nowWorld||s.__world;return n<0&&(n=-n),n>1?t/n:t}else return t}get __hasStroke(){return this.stroke&&this.strokeWidth}get __hasMultiPaint(){const t=this;return t.__isFills&&t.fill.length>1||t.__isStrokes&&t.stroke.length>1||t.__useEffect?!0:t.fill&&this.__hasStroke}get __clipAfterFill(){return this.cornerRadius||this.__pathInputed}get __autoWidth(){return!this._width}get __autoHeight(){return!this._height}get __autoSide(){return!this._width||!this._height}get __autoSize(){return!this._width&&!this._height}setVisible(t){this._visible=t;const{leafer:e}=this.__leaf;e&&(e.watcher.hasVisible=!0)}setWidth(t){t<0?(this._width=-t,this.__leaf.scaleX*=-1,da.warn("width < 0, instead -scaleX ",this)):this._width=t}setHeight(t){t<0?(this._height=-t,this.__leaf.scaleY*=-1,da.warn("height < 0, instead -scaleY",this)):this._height=t}setFill(t){this.__naturalWidth&&this.__removeNaturalSize(),typeof t=="string"||!t?(this.__isFills&&(this.__removeInput("fill"),si.recycleImage("fill",this),this.__isFills=!1,this.__pixelFill&&(this.__pixelFill=!1)),this._fill=t):typeof t=="object"&&(this.__setInput("fill",t),this.__leaf.__layout.boxChanged||this.__leaf.__layout.boxChange(),this.__isFills=!0,this._fill||(this._fill=ca))}setStroke(t){typeof t=="string"||!t?(this.__isStrokes&&(this.__removeInput("stroke"),si.recycleImage("stroke",this),this.__isStrokes=!1,this.__pixelStroke&&(this.__pixelStroke=!1)),this._stroke=t):typeof t=="object"&&(this.__setInput("stroke",t),this.__leaf.__layout.boxChanged||this.__leaf.__layout.boxChange(),this.__isStrokes=!0,this._stroke||(this._stroke=ca))}setPath(t){const e=typeof t=="string";e||t&&typeof t[0]=="object"?(this.__setInput("path",t),this._path=e?Df(t):Lf(t)):(this.__input&&this.__removeInput("path"),this._path=t)}setShadow(t){this.__setInput("shadow",t),t instanceof Array?(t.some(e=>e.visible===!1)&&(t=t.filter(e=>e.visible!==!1)),this._shadow=t.length?t:null):this._shadow=t&&t.visible!==!1?[t]:null}setInnerShadow(t){this.__setInput("innerShadow",t),t instanceof Array?(t.some(e=>e.visible===!1)&&(t=t.filter(e=>e.visible!==!1)),this._innerShadow=t.length?t:null):this._innerShadow=t&&t.visible!==!1?[t]:null}__computePaint(){const{fill:t,stroke:e}=this.__input;t&&pt.compute("fill",this.__leaf),e&&pt.compute("stroke",this.__leaf),this.__needComputePaint=!1}}class Js extends Pe{}class zr extends Js{get __boxStroke(){return!this.__pathInputed}get __drawAfterFill(){return this.overflow==="hide"&&this.__clipAfterFill&&this.__leaf.children.length}get __clipAfterFill(){return this.__leaf.isOverflow||super.__clipAfterFill}}class Wf extends Js{__getInputData(t,e){const s=super.__getInputData(t,e);return Qt.forEach(n=>delete s[n]),s}}class zf extends zr{}class $f extends Pe{}class $r extends Pe{get __boxStroke(){return!this.__pathInputed}}class Uf extends Pe{get __boxStroke(){return!this.__pathInputed}}class Ff extends Pe{}class Nf extends Pe{}class Gf extends Pe{get __pathInputed(){return 2}}class Hf extends Js{}const jf={thin:100,"extra-light":200,light:300,normal:400,medium:500,"semi-bold":600,bold:700,"extra-bold":800,black:900};class Vf extends Pe{get __useNaturalRatio(){return!1}setFontWeight(t){typeof t=="string"?(this.__setInput("fontWeight",t),this._fontWeight=jf[t]||400):(this.__input&&this.__removeInput("fontWeight"),this._fontWeight=t)}}class Yf extends $r{setUrl(t){this.__setImageFill(t),this._url=t}__setImageFill(t){this.__leaf.image&&(this.__leaf.image=null),this.fill=t?{type:"image",mode:"stretch",url:t}:void 0}__getData(){const t=super.__getData();return delete t.fill,t}__getInputData(t,e){const s=super.__getInputData(t,e);return delete s.fill,s}}class Zf extends $r{get __isCanvas(){return!0}get __drawAfterFill(){return!0}__getInputData(t,e){const s=super.__getInputData(t,e);return s.url=this.__leaf.canvas.toDataURL("image/png"),s}}const Kf={__updateStrokeSpread(){let i=0,t=0;const e=this.__,{strokeAlign:s,strokeWidth:n}=e;if((e.stroke||e.hitStroke==="all")&&n&&s!=="inside"&&(t=i=s==="center"?n/2:n,!e.__boxStroke)){const r=e.__isLinePath?0:10*i,o=e.strokeCap==="none"?0:n;i+=Math.max(r,o)}return e.__useArrow&&(i+=n*5),this.__layout.strokeBoxSpread=t,i},__updateRenderSpread(){let i=0;const{shadow:t,innerShadow:e,blur:s,backgroundBlur:n}=this.__;t&&t.forEach(o=>i=Math.max(i,Math.max(Math.abs(o.y),Math.abs(o.x))+(o.spread>0?o.spread:0)+o.blur*1.5)),s&&(i=Math.max(i,s));let r=i=Math.ceil(i);return e&&e.forEach(o=>r=Math.max(r,Math.max(Math.abs(o.y),Math.abs(o.x))+(o.spread<0?-o.spread:0)+o.blur*1.5)),n&&(r=Math.max(r,n)),this.__layout.renderShapeSpread=r,i+(this.__layout.strokeSpread||0)}},Xf={__updateChange(){const i=this.__;if(i.__useEffect){const{shadow:e,innerShadow:s,blur:n,backgroundBlur:r}=this.__;i.__useEffect=!!(e||s||n||r)}i.__checkSingle(),i.__isFills||i.__isStrokes||i.cornerRadius||i.__useEffect?i.__complex=!0:i.__complex&&(i.__complex=!1)},__drawFast(i,t){ua(this,i,t)},__draw(i,t){const e=this.__;if(e.__complex){e.__needComputePaint&&e.__computePaint();const{fill:s,stroke:n,__drawAfterFill:r}=e;if(this.__drawRenderPath(i),e.__useEffect){const o=pt.shape(this,i,t);this.__nowWorld=this.__getNowWorld(t);const{shadow:a,innerShadow:h}=e;a&&br.shadow(this,i,o),s&&(e.__isFills?pt.fills(s,this,i):pt.fill(s,this,i)),r&&this.__drawAfterFill(i,t),h&&br.innerShadow(this,i,o),n&&(e.__isStrokes?pt.strokes(n,this,i):pt.stroke(n,this,i)),o.worldCanvas&&o.worldCanvas.recycle(),o.canvas.recycle()}else s&&(e.__isFills?pt.fills(s,this,i):pt.fill(s,this,i)),r&&this.__drawAfterFill(i,t),n&&(e.__isStrokes?pt.strokes(n,this,i):pt.stroke(n,this,i))}else e.__pathInputed?ua(this,i,t):this.__drawFast(i,t)},__renderShape(i,t,e,s){if(this.__worldOpacity){i.setWorld(this.__nowWorld=this.__getNowWorld(t));const{fill:n,stroke:r}=this.__;this.__drawRenderPath(i),n&&!e&&(this.__.__pixelFill?pt.fills(n,this,i):pt.fill("#000000",this,i)),this.__.__isCanvas&&this.__drawAfterFill(i,t),r&&!s&&(this.__.__pixelStroke?pt.strokes(r,this,i):pt.stroke("#000000",this,i))}},__drawAfterFill(i,t){this.__.__clipAfterFill?(i.save(),this.windingRule?i.clip(this.windingRule):i.clip(),this.__drawContent(i,t),i.restore()):this.__drawContent(i,t)}};function ua(i,t,e){const{fill:s,stroke:n,__drawAfterFill:r}=i.__;i.__drawRenderPath(t),s&&pt.fill(s,i,t),r&&i.__drawAfterFill(t,e),n&&pt.stroke(n,i,t)}const qf={__drawFast(i,t){let{width:e,height:s,fill:n,stroke:r,__drawAfterFill:o}=this.__;if(n&&(i.fillStyle=n,i.fillRect(0,0,e,s)),o&&this.__drawAfterFill(i,t),r){const{strokeAlign:a,__strokeWidth:h}=this.__;if(!h)return;i.setStroke(r,h,this.__);const l=h/2;switch(a){case"center":i.strokeRect(0,0,e,s);break;case"inside":e-=h,s-=h,e<0||s<0?(i.save(),this.__clip(i,t),i.strokeRect(l,l,e,s),i.restore()):i.strokeRect(l,l,e,s);break;case"outside":i.strokeRect(-l,-l,e+h,s+h);break}}}};var Tr;let w=Tr=class extends ei{get app(){return this.leafer&&this.leafer.app}get isFrame(){return!1}set scale(t){bt.assignScale(this,t)}get scale(){return this.__.scale}get pen(){const{path:t}=this.__;return Ui.set(this.path=t||[]),t||this.__drawPathByBox(Ui),Ui}get editConfig(){}get editOuter(){return""}get editInner(){return""}constructor(t){super(t)}reset(t){}set(t,e){e?e==="temp"?(this.lockNormalStyle=!0,Object.assign(this,t),this.lockNormalStyle=!1):this.animate(t,e):Object.assign(this,t)}get(t){return typeof t=="string"?this.__.__getInput(t):this.__.__getInputData(t)}createProxyData(){}find(t,e){}findTag(t){return this.find({tag:t})}findOne(t,e){}findId(t){return this.findOne({id:t})}getPath(t,e){this.__layout.update();let s=e?this.__.__pathForRender:this.__.path;return s||(Ui.set(s=[]),this.__drawPathByBox(Ui)),t?ti.toCanvasData(s,!0):s}getPathString(t,e,s){return ti.stringify(this.getPath(t,e),s)}load(){this.__.__computePaint()}__onUpdateSize(){if(this.__.__input){const t=this.__;t.lazy&&!this.__inLazyBounds&&!bi.running?t.__needComputePaint=!0:t.__computePaint()}}__updateRenderPath(){if(this.__.path){const t=this.__;t.__pathForRender=t.cornerRadius?iu.smooth(t.path,t.cornerRadius,t.cornerSmoothing):t.path,t.__useArrow&&Lh.addArrows(this,!t.cornerRadius)}}__drawRenderPath(t){t.beginPath(),this.__drawPathByData(t,this.__.__pathForRender)}__drawPath(t){t.beginPath(),this.__drawPathByData(t,this.__.path)}__drawPathByData(t,e){e?Ld.drawPathByData(t,e):this.__drawPathByBox(t)}__drawPathByBox(t){const{x:e,y:s,width:n,height:r}=this.__layout.boxBounds;if(this.__.cornerRadius){const{cornerRadius:o}=this.__;t.roundRect(e,s,n,r,typeof o=="number"?[o]:o)}else t.rect(e,s,n,r)}animate(t,e,s,n){return Pi("animate")}killAnimate(t){}export(t,e){return bi.export(this,t,e)}clone(t){const e=this.toJSON();return t&&Object.assign(e,t),Tr.one(e)}static one(t,e,s,n,r){return Zs.get(t.tag||this.prototype.__tag,t,e,s,n,r)}static registerUI(){kt()(this)}static registerData(t){vt(t)(this.prototype)}static setEditConfig(t){}static setEditOuter(t){}static setEditInner(t){}destroy(){this.fill=this.stroke=null,this.__animate&&this.killAnimate(),super.destroy()}};_([vt(Pe)],w.prototype,"__",void 0);_([Af()],w.prototype,"zoomLayer",void 0);_([ue("")],w.prototype,"id",void 0);_([ue("")],w.prototype,"name",void 0);_([ue("")],w.prototype,"className",void 0);_([hs("pass-through")],w.prototype,"blendMode",void 0);_([_u(1)],w.prototype,"opacity",void 0);_([pu(!0)],w.prototype,"visible",void 0);_([hs(!1)],w.prototype,"locked",void 0);_([gu(0)],w.prototype,"zIndex",void 0);_([yu(!1)],w.prototype,"mask",void 0);_([mu(!1)],w.prototype,"eraser",void 0);_([Mi(0,!0)],w.prototype,"x",void 0);_([Mi(0,!0)],w.prototype,"y",void 0);_([U(100,!0)],w.prototype,"width",void 0);_([U(100,!0)],w.prototype,"height",void 0);_([Oh(1,!0)],w.prototype,"scaleX",void 0);_([Oh(1,!0)],w.prototype,"scaleY",void 0);_([Wr(0,!0)],w.prototype,"rotation",void 0);_([Wr(0,!0)],w.prototype,"skewX",void 0);_([Wr(0,!0)],w.prototype,"skewY",void 0);_([Mi(0,!0)],w.prototype,"offsetX",void 0);_([Mi(0,!0)],w.prototype,"offsetY",void 0);_([Mi(0,!0)],w.prototype,"scrollX",void 0);_([Mi(0,!0)],w.prototype,"scrollY",void 0);_([Ks()],w.prototype,"origin",void 0);_([Ks()],w.prototype,"around",void 0);_([ue(!1)],w.prototype,"lazy",void 0);_([du(1)],w.prototype,"pixelRatio",void 0);_([uu()],w.prototype,"path",void 0);_([Rt()],w.prototype,"windingRule",void 0);_([Rt(!0)],w.prototype,"closed",void 0);_([U(0)],w.prototype,"padding",void 0);_([U(!1)],w.prototype,"lockRatio",void 0);_([U()],w.prototype,"widthRange",void 0);_([U()],w.prototype,"heightRange",void 0);_([ue(!1)],w.prototype,"draggable",void 0);_([ue()],w.prototype,"dragBounds",void 0);_([ue(!1)],w.prototype,"editable",void 0);_([ai(!0)],w.prototype,"hittable",void 0);_([ai("path")],w.prototype,"hitFill",void 0);_([fe("path")],w.prototype,"hitStroke",void 0);_([ai(!1)],w.prototype,"hitBox",void 0);_([ai(!0)],w.prototype,"hitChildren",void 0);_([ai(!0)],w.prototype,"hitSelf",void 0);_([ai()],w.prototype,"hitRadius",void 0);_([xu("")],w.prototype,"cursor",void 0);_([hs()],w.prototype,"fill",void 0);_([fe()],w.prototype,"stroke",void 0);_([fe("inside")],w.prototype,"strokeAlign",void 0);_([fe(1)],w.prototype,"strokeWidth",void 0);_([fe(!1)],w.prototype,"strokeWidthFixed",void 0);_([fe("none")],w.prototype,"strokeCap",void 0);_([fe("miter")],w.prototype,"strokeJoin",void 0);_([fe()],w.prototype,"dashPattern",void 0);_([fe()],w.prototype,"dashOffset",void 0);_([fe(10)],w.prototype,"miterLimit",void 0);_([Rt(0)],w.prototype,"cornerRadius",void 0);_([Rt()],w.prototype,"cornerSmoothing",void 0);_([cs()],w.prototype,"shadow",void 0);_([cs()],w.prototype,"innerShadow",void 0);_([cs()],w.prototype,"blur",void 0);_([cs()],w.prototype,"backgroundBlur",void 0);_([cs()],w.prototype,"grayscale",void 0);_([ue({})],w.prototype,"data",void 0);_([ne(ei.prototype.reset)],w.prototype,"reset",null);w=Tr=_([Jt(Kf),Jt(Xf),qs()],w);let Bt=class extends w{get __tag(){return"Group"}get isBranch(){return!0}constructor(t){super(t)}reset(t){this.__setBranch(),super.reset(t)}__setBranch(){this.children||(this.children=[])}set(t,e){if(t.children){const{children:s}=t;delete t.children,this.children?this.clear():this.__setBranch(),super.set(t,e),s.forEach(n=>this.add(n)),t.children=s}else super.set(t,e)}toJSON(t){const e=super.toJSON(t);return e.children=this.children.map(s=>s.toJSON(t)),e}pick(t,e){}addAt(t,e){this.add(t,e)}addAfter(t,e){this.add(t,this.children.indexOf(e)+1)}addBefore(t,e){this.add(t,this.children.indexOf(e))}add(t,e){}addMany(...t){}remove(t,e){}removeAll(t){}clear(){}};_([vt(Js)],Bt.prototype,"__",void 0);Bt=_([Jt(kr),kt()],Bt);var Ws;const fa=K.get("Leafer");let $e=Ws=class extends Bt{get __tag(){return"Leafer"}get isApp(){return!1}get app(){return this.parent||this}get isLeafer(){return!0}get imageReady(){return this.viewReady&&At.isComplete}get layoutLocked(){return!this.layouter.running}get FPS(){return this.renderer?this.renderer.FPS:60}get cursorPoint(){return this.interaction&&this.interaction.hoverData||{x:this.width/2,y:this.height/2}}get clientBounds(){return this.canvas&&this.canvas.getClientBounds()}constructor(t,e){super(e),this.config={type:"design",start:!0,hittable:!0,smooth:!0,lazySpeard:100,zoom:{min:.01,max:256},move:{holdSpaceKey:!0,holdMiddleKey:!0,autoDistance:2}},this.leafs=0,this.__eventIds=[],this.__controllers=[],this.__readyWait=[],this.__viewReadyWait=[],this.__viewCompletedWait=[],this.__nextRenderWait=[],this.userConfig=t,t&&(t.view||t.width)&&this.init(t),Ws.list.add(this)}init(t,e){if(this.canvas)return;this.__setLeafer(this),t&&_t.assign(this.config,t);let s;const{config:n}=this;this.initType(n.type);const r=this.canvas=ct.canvas(n);this.__controllers.push(this.renderer=ct.renderer(this,r,n),this.watcher=ct.watcher(this,n),this.layouter=ct.layouter(this,n)),this.isApp&&this.__setApp(),this.__checkAutoLayout(n,e),this.view=r.view,e?(this.__bindApp(e),s=e.running):(this.selector=ct.selector(this),this.interaction=ct.interaction(this,r,this.selector,n),this.interaction&&(this.__controllers.unshift(this.interaction),this.hitCanvasManager=ct.hitCanvasManager()),this.canvasManager=new mh,s=n.start),this.hittable=n.hittable,this.fill=n.fill,this.canvasManager.add(r),this.__listenEvents(),s&&(this.__startTimer=setTimeout(this.start.bind(this))),Fi.run(this.__initWait),this.onInit()}onInit(){}initType(t){}set(t,e){this.waitInit(()=>{super.set(t,e)})}start(){clearTimeout(this.__startTimer),!this.running&&this.canvas&&(this.running=!0,this.ready?this.emitLeafer(at.RESTART):this.emitLeafer(at.START),this.__controllers.forEach(t=>t.start()),this.isApp||this.renderer.render())}stop(){clearTimeout(this.__startTimer),this.running&&this.canvas&&(this.__controllers.forEach(t=>t.stop()),this.running=!1,this.emitLeafer(at.STOP))}unlockLayout(){this.layouter.start(),this.updateLayout()}lockLayout(){this.updateLayout(),this.layouter.stop()}resize(t){const e=_t.copyAttrs({},t,Qt);Object.keys(e).forEach(s=>this[s]=e[s])}forceRender(t){this.renderer.addBlock(t?new nt(t):this.canvas.bounds),this.viewReady&&this.renderer.update()}updateCursor(t){const e=this.interaction;e&&(t?e.setCursor(t):e.updateCursor())}updateLazyBounds(){this.lazyBounds=this.canvas.bounds.clone().spread(this.config.lazySpeard)}__doResize(t){const{canvas:e}=this;if(!e||e.isSameSize(t))return;const s=_t.copyAttrs({},this.canvas,Qt);e.resize(t),this.updateLazyBounds(),this.__onResize(new Ge(t,s))}__onResize(t){this.emitEvent(t),_t.copyAttrs(this.__,t,Qt),setTimeout(()=>{this.canvasManager&&this.canvasManager.clearRecycled()},0)}__setApp(){}__bindApp(t){this.selector=t.selector,this.interaction=t.interaction,this.canvasManager=t.canvasManager,this.hitCanvasManager=t.hitCanvasManager}__setLeafer(t){this.leafer=t,this.__level=1}__checkAutoLayout(t,e){e||((!t.width||!t.height)&&(this.autoLayout=new nc(t)),this.canvas.startAutoLayout(this.autoLayout,this.__onResize.bind(this)))}__setAttr(t,e){return this.canvas&&(Qt.includes(t)?(e||fa.warn(t+" is 0"),this.__changeCanvasSize(t,e)):t==="fill"?this.__changeFill(e):t==="hittable"?this.parent||(this.canvas.hittable=e):t==="zIndex"&&(this.canvas.zIndex=e,setTimeout(()=>this.parent&&this.parent.__updateSortChildren()))),super.__setAttr(t,e)}__getAttr(t){return this.canvas&&Qt.includes(t)?this.canvas[t]:super.__getAttr(t)}__changeCanvasSize(t,e){const s=_t.copyAttrs({},this.canvas,Qt);s[t]=this.config[t]=e,e&&this.canvas.stopAutoLayout(),this.__doResize(s)}__changeFill(t){this.config.fill=t,this.canvas.allowBackgroundColor?this.canvas.backgroundColor=t:this.forceRender()}__onCreated(){this.created=!0}__onReady(){this.ready||(this.ready=!0,this.emitLeafer(at.BEFORE_READY),this.emitLeafer(at.READY),this.emitLeafer(at.AFTER_READY),Fi.run(this.__readyWait))}__onViewReady(){this.viewReady||(this.viewReady=!0,this.emitLeafer(at.VIEW_READY),Fi.run(this.__viewReadyWait))}__onNextRender(){if(this.viewReady){Fi.run(this.__nextRenderWait);const{imageReady:t}=this;t&&!this.viewCompleted&&this.__checkViewCompleted(),t||(this.viewCompleted=!1)}}__checkViewCompleted(t=!0){this.nextRender(()=>{this.imageReady&&(t&&this.emitLeafer(at.VIEW_COMPLETED),Fi.run(this.__viewCompletedWait),this.viewCompleted=!0)})}__onWatchData(){this.watcher.childrenChanged&&this.interaction&&this.nextRender(()=>this.interaction.updateCursor())}waitInit(t,e){e&&(t=t.bind(e)),this.__initWait||(this.__initWait=[]),this.canvas?t():this.__initWait.push(t)}waitReady(t,e){e&&(t=t.bind(e)),this.ready?t():this.__readyWait.push(t)}waitViewReady(t,e){e&&(t=t.bind(e)),this.viewReady?t():this.__viewReadyWait.push(t)}waitViewCompleted(t,e){e&&(t=t.bind(e)),this.__viewCompletedWait.push(t),this.viewCompleted?this.__checkViewCompleted(!1):this.running||this.start()}nextRender(t,e,s){e&&(t=t.bind(e));const n=this.__nextRenderWait;if(s){for(let r=0;r<n.length;r++)if(n[r]===t){n.splice(r,1);break}}else n.push(t)}zoom(t,e,s){return Pi("view")}getValidMove(t,e){return{x:t,y:e}}getValidScale(t){return t}getWorldPointByClient(t,e){return this.interaction&&this.interaction.getLocal(t,e)}getPagePointByClient(t,e){return this.getPagePoint(this.getWorldPointByClient(t,e))}updateClientBounds(){this.canvas&&this.canvas.updateClientBounds()}receiveEvent(t){}__checkUpdateLayout(){this.__layout.update()}emitLeafer(t){this.emitEvent(new at(t,this))}__listenEvents(){const t=te.start("FirstCreate "+this.innerName);this.once(at.START,()=>te.end(t)),this.once(q.START,()=>this.updateLazyBounds()),this.once(q.END,()=>this.__onReady()),this.once(Q.START,()=>this.__onCreated()),this.once(Q.END,()=>this.__onViewReady()),this.__eventIds.push(this.on_(Le.DATA,this.__onWatchData,this),this.on_(Q.NEXT,this.__onNextRender,this),this.on_(q.CHECK_UPDATE,this.__checkUpdateLayout,this))}__removeListenEvents(){this.off_(this.__eventIds),this.__eventIds.length=0}destroy(t){const e=()=>{if(!this.destroyed){Ws.list.remove(this);try{this.stop(),this.emitEvent(new at(at.END,this)),this.__removeListenEvents(),this.__controllers.forEach(s=>!(this.parent&&s===this.interaction)&&s.destroy()),this.__controllers.length=0,this.parent||(this.selector&&this.selector.destroy(),this.hitCanvasManager&&this.hitCanvasManager.destroy(),this.canvasManager.destroy()),this.canvas.destroy(),this.config.view=this.view=null,this.userConfig&&(this.userConfig.view=null),super.destroy(),setTimeout(()=>{At.clearRecycled()},100)}catch(s){fa.error(s)}}};t?e():setTimeout(e)}};$e.list=new lt;_([vt(Wf)],$e.prototype,"__",void 0);_([U()],$e.prototype,"pixelRatio",void 0);$e=Ws=_([kt()],$e);let ni=class extends w{get __tag(){return"Rect"}constructor(t){super(t)}};_([vt($r)],ni.prototype,"__",void 0);ni=_([Jt(qf),qs(),kt()],ni);const{copy:Qf,add:Jf,includes:t_}=O,hi=ni.prototype,e_=Bt.prototype,Yn={};let dt=class extends Bt{get __tag(){return"Box"}get isBranchLeaf(){return!0}constructor(t){super(t),this.__layout.renderChanged||this.__layout.renderChange()}__updateStrokeSpread(){return 0}__updateRectRenderSpread(){return 0}__updateRenderSpread(){return this.__updateRectRenderSpread()||-1}__updateRectBoxBounds(){}__updateBoxBounds(t){const e=this.__;if(this.children.length)if(e.__autoSide){super.__updateBoxBounds();const{boxBounds:s}=this.__layout;e.__autoSize||(e.__autoWidth?(s.width+=s.x,s.x=0,s.height=e.height,s.y=0):(s.height+=s.y,s.y=0,s.width=e.width,s.x=0)),this.__updateNaturalSize()}else this.__updateRectBoxBounds();else this.__updateRectBoxBounds()}__updateStrokeBounds(){}__updateRenderBounds(){let t;const{renderBounds:e}=this.__layout;this.children.length?(super.__updateRenderBounds(),Qf(Yn,e),this.__updateRectRenderBounds(),t=!t_(e,Yn),t&&this.__.overflow!=="hide"&&Jf(e,Yn)):this.__updateRectRenderBounds(),!this.isOverflow!=!t&&(this.isOverflow=t)}__updateRectRenderBounds(){}__updateRectChange(){}__updateChange(){super.__updateChange(),this.__updateRectChange()}__renderRect(t,e){}__renderGroup(t,e){}__render(t,e){this.__.__drawAfterFill?this.__renderRect(t,e):(this.__renderRect(t,e),this.children.length&&this.__renderGroup(t,e))}__drawContent(t,e){this.__renderGroup(t,e),this.__.__hasStroke&&(t.setWorld(this.__nowWorld),this.__drawRenderPath(t))}};_([vt(zr)],dt.prototype,"__",void 0);_([ue(!1)],dt.prototype,"resizeChildren",void 0);_([Ih("show")],dt.prototype,"overflow",void 0);_([ne(hi.__updateStrokeSpread)],dt.prototype,"__updateStrokeSpread",null);_([ne(hi.__updateRenderSpread)],dt.prototype,"__updateRectRenderSpread",null);_([ne(hi.__updateBoxBounds)],dt.prototype,"__updateRectBoxBounds",null);_([ne(hi.__updateStrokeBounds)],dt.prototype,"__updateStrokeBounds",null);_([ne(hi.__updateRenderBounds)],dt.prototype,"__updateRectRenderBounds",null);_([ne(hi.__updateChange)],dt.prototype,"__updateRectChange",null);_([ne(hi.__render)],dt.prototype,"__renderRect",null);_([ne(e_.__render)],dt.prototype,"__renderGroup",null);dt=_([qs(),kt()],dt);let es=class extends dt{get __tag(){return"Frame"}get isFrame(){return!0}constructor(t){super(t)}};_([vt(zf)],es.prototype,"__",void 0);_([hs("#FFFFFF")],es.prototype,"fill",void 0);_([Ih("hide")],es.prototype,"overflow",void 0);es=_([kt()],es);const{moveTo:_a,closePath:pa,ellipse:mi}=oi;let Se=class extends w{get __tag(){return"Ellipse"}constructor(t){super(t)}__updatePath(){const{width:t,height:e,innerRadius:s,startAngle:n,endAngle:r}=this.__,o=t/2,a=e/2,h=this.__.path=[];s?(n||r?(s<1&&mi(h,o,a,o*s,a*s,0,n,r,!1),mi(h,o,a,o,a,0,r,n,!0),s<1&&pa(h)):(s<1&&(mi(h,o,a,o*s,a*s),_a(h,t,a)),mi(h,o,a,o,a,0,360,0,!0)),S.ellipseToCurve&&(this.__.path=this.getPath(!0))):n||r?(_a(h,o,a),mi(h,o,a,o,a,0,n,r,!1),pa(h)):mi(h,o,a,o,a)}};_([vt(Uf)],Se.prototype,"__",void 0);_([Rt(0)],Se.prototype,"innerRadius",void 0);_([Rt(0)],Se.prototype,"startAngle",void 0);_([Rt(0)],Se.prototype,"endAngle",void 0);Se=_([kt()],Se);const{moveTo:i_,lineTo:s_,drawPoints:ga}=oi,{rotate:n_,getAngle:r_,getDistance:o_,defaultPoint:ya}=D,{toBounds:a_}=Lr;let de=class extends w{get __tag(){return"Line"}get toPoint(){const{width:t,rotation:e}=this.__,s=ph();return t&&(s.x=t),e&&n_(s,e),s}set toPoint(t){this.width=o_(ya,t),this.rotation=r_(ya,t),this.height&&(this.height=0)}constructor(t){super(t)}__updatePath(){const t=this.__,e=t.path=[];t.points?ga(e,t.points,!1,t.closed):(i_(e,0,0),s_(e,this.width,0))}__updateRenderPath(){const t=this.__;!this.pathInputed&&t.points&&t.curve?(ga(t.__pathForRender=[],t.points,t.curve,t.closed),t.__useArrow&&Lh.addArrows(this,!1)):super.__updateRenderPath()}__updateBoxBounds(){this.points?a_(this.__.__pathForRender,this.__layout.boxBounds):super.__updateBoxBounds()}};_([vt($f)],de.prototype,"__",void 0);_([Xs("center")],de.prototype,"strokeAlign",void 0);_([U(0)],de.prototype,"height",void 0);_([Rt()],de.prototype,"points",void 0);_([Rt(0)],de.prototype,"curve",void 0);_([Rt(!1)],de.prototype,"closed",void 0);de=_([kt()],de);const{sin:h_,cos:l_,PI:ma}=Math,{moveTo:c_,lineTo:d_,closePath:u_,drawPoints:f_}=oi,Wh=de.prototype;let se=class extends w{get __tag(){return"Polygon"}constructor(t){super(t)}__updatePath(){const t=this.__.path=[];if(this.__.points)f_(t,this.__.points,!1,!0);else{const{width:e,height:s,sides:n}=this.__,r=e/2,o=s/2;c_(t,r,0);for(let a=1;a<n;a++)d_(t,r+r*h_(a*2*ma/n),o-o*l_(a*2*ma/n))}u_(t)}__updateRenderPath(){}__updateBoxBounds(){}};_([vt(Ff)],se.prototype,"__",void 0);_([Rt(3)],se.prototype,"sides",void 0);_([Rt()],se.prototype,"points",void 0);_([Rt(0)],se.prototype,"curve",void 0);_([ne(Wh.__updateRenderPath)],se.prototype,"__updateRenderPath",null);_([ne(Wh.__updateBoxBounds)],se.prototype,"__updateBoxBounds",null);se=_([qs(),kt()],se);const{sin:__,cos:p_,PI:xa}=Math,{moveTo:g_,lineTo:y_,closePath:m_}=oi;let is=class extends w{get __tag(){return"Star"}constructor(t){super(t)}__updatePath(){const{width:t,height:e,corners:s,innerRadius:n}=this.__,r=t/2,o=e/2,a=this.__.path=[];g_(a,r,0);for(let h=1;h<s*2;h++)y_(a,r+(h%2===0?r:r*n)*__(h*xa/s),o-(h%2===0?o:o*n)*p_(h*xa/s));m_(a)}};_([vt(Nf)],is.prototype,"__",void 0);_([Rt(5)],is.prototype,"corners",void 0);_([Rt(.382)],is.prototype,"innerRadius",void 0);is=_([kt()],is);let ri=class extends ni{get __tag(){return"Image"}get ready(){return this.image?this.image.ready:!1}constructor(t){super(t),this.on(Zt.LOADED,e=>{e.attrName==="fill"&&e.attrValue.url===this.url&&(this.image=e.image)})}destroy(){this.image=null,super.destroy()}};_([vt(Yf)],ri.prototype,"__",void 0);_([U("")],ri.prototype,"url",void 0);ri=_([kt()],ri);let Ue=class extends ni{get __tag(){return"Canvas"}get ready(){return!this.url}constructor(t){super(t),this.canvas=ct.canvas(this.__),this.context=this.canvas.context,t&&t.url&&this.drawImage(t.url)}drawImage(t){new Rh({url:t}).load(e=>{this.context.drawImage(e.view,0,0),this.url=void 0,this.paint(),this.emitEvent(new Zt(Zt.LOADED,{image:e}))})}draw(t,e,s,n){const r=new ze(t.worldTransform).invert(),o=new ze;e&&o.translate(e.x,e.y),s&&(typeof s=="number"?o.scale(s):o.scale(s.x,s.y)),n&&o.rotate(n),r.multiplyParent(o),t.__render(this.canvas,{matrix:r.withScale()}),this.paint()}paint(){this.forceRender()}__drawContent(t,e){const{width:s,height:n}=this.__,{view:r}=this.canvas;t.drawImage(r,0,0,r.width,r.height,0,0,s,n)}__updateSize(){const{canvas:t}=this;if(t){const{smooth:e}=this.__;t.smooth!==e&&(t.smooth=e),t.resize(this.__)}}destroy(){this.canvas&&(this.canvas.destroy(),this.canvas=this.context=null),super.destroy()}};_([vt(Zf)],Ue.prototype,"__",void 0);_([ds(100)],Ue.prototype,"width",void 0);_([ds(100)],Ue.prototype,"height",void 0);_([ds(1)],Ue.prototype,"pixelRatio",void 0);_([ds(!0)],Ue.prototype,"smooth",void 0);_([ds()],Ue.prototype,"contextSettings",void 0);Ue=_([kt()],Ue);const{copyAndSpread:x_,includes:w_,isSame:v_,spread:k_,setList:b_}=O;let X=class extends w{get __tag(){return"Text"}get textDrawData(){return this.__layout.update(),this.__.__textDrawData}constructor(t){super(t)}__drawHitPath(t){const{__lineHeight:e,fontSize:s,__baseLine:n,__textDrawData:r}=this.__;t.beginPath(),this.__.__letterSpacing<0?this.__drawPathByData(t):r.rows.forEach(o=>t.rect(o.x,o.y-n,o.width,e<s?s:e))}__drawPathByData(t,e){const{x:s,y:n,width:r,height:o}=this.__layout.boxBounds;t.rect(s,n,r,o)}__drawRenderPath(t){t.font=this.__.__font}__updateTextDrawData(){const t=this.__,{lineHeight:e,letterSpacing:s,fontFamily:n,fontSize:r,fontWeight:o,italic:a,textCase:h,textOverflow:l,padding:c}=t;t.__lineHeight=ha.number(e,r),t.__letterSpacing=ha.number(s,r),t.__padding=c?bt.fourNumber(c):void 0,t.__baseLine=t.__lineHeight-(t.__lineHeight-r*.7)/2,t.__font=`${a?"italic ":""}${h==="small-caps"?"small-caps ":""}${o!=="normal"?o+" ":""}${r}px ${n}`,t.__clipText=l!=="show"&&!t.__autoSize,t.__textDrawData=Dh.getDrawData(t.text,this.__)}__updateBoxBounds(){const t=this.__,e=this.__layout,{fontSize:s,italic:n,padding:r,__autoWidth:o,__autoHeight:a}=t;this.__updateTextDrawData();const{bounds:h}=t.__textDrawData,l=e.boxBounds;if(t.__lineHeight<s&&k_(h,s/2),o||a){if(l.x=o?h.x:0,l.y=a?h.y:0,l.width=o?h.width:t.width,l.height=a?h.height:t.height,r){const[p,f,d,u]=t.__padding;o&&(l.x-=u,l.width+=f+u),a&&(l.y-=p,l.height+=d+p)}this.__updateNaturalSize()}else super.__updateBoxBounds();n&&(l.width+=s*.16);const c=w_(l,h)?l:h;v_(c,e.contentBounds)?t.__textBoxBounds=c:(e.contentBounds=c,e.renderChanged=!0,b_(t.__textBoxBounds={},[l,h]))}__updateRenderSpread(){let t=super.__updateRenderSpread();return t||(t=this.__layout.boxBounds===this.__layout.contentBounds?0:1),t}__updateRenderBounds(){x_(this.__layout.renderBounds,this.__.__textBoxBounds,this.__layout.renderSpread)}};_([vt(Vf)],X.prototype,"__",void 0);_([U(0)],X.prototype,"width",void 0);_([U(0)],X.prototype,"height",void 0);_([ue(!1)],X.prototype,"resizeFontSize",void 0);_([hs("#000000")],X.prototype,"fill",void 0);_([Xs("outside")],X.prototype,"strokeAlign",void 0);_([ai("all")],X.prototype,"hitFill",void 0);_([U("")],X.prototype,"text",void 0);_([U("L")],X.prototype,"fontFamily",void 0);_([U(12)],X.prototype,"fontSize",void 0);_([U("normal")],X.prototype,"fontWeight",void 0);_([U(!1)],X.prototype,"italic",void 0);_([U("none")],X.prototype,"textCase",void 0);_([U("none")],X.prototype,"textDecoration",void 0);_([U(0)],X.prototype,"letterSpacing",void 0);_([U({type:"percent",value:1.5})],X.prototype,"lineHeight",void 0);_([U(0)],X.prototype,"paraIndent",void 0);_([U(0)],X.prototype,"paraSpacing",void 0);_([U("left")],X.prototype,"textAlign",void 0);_([U("top")],X.prototype,"verticalAlign",void 0);_([U(!0)],X.prototype,"autoSizeAlign",void 0);_([U("normal")],X.prototype,"textWrap",void 0);_([U("show")],X.prototype,"textOverflow",void 0);X=_([kt()],X);let Fe=class extends w{get __tag(){return"Path"}constructor(t){super(t)}};_([vt(Gf)],Fe.prototype,"__",void 0);_([Xs("center")],Fe.prototype,"strokeAlign",void 0);Fe=_([kt()],Fe);let Hs=class extends Bt{get __tag(){return"Pen"}constructor(t){super(t)}setStyle(t){const e=this.pathElement=new Fe(t);return this.pathStyle=t,this.__path=e.path||(e.path=[]),this.add(e),this}beginPath(){return this}moveTo(t,e){return this}lineTo(t,e){return this}bezierCurveTo(t,e,s,n,r,o){return this}quadraticCurveTo(t,e,s,n){return this}closePath(){return this}rect(t,e,s,n){return this}roundRect(t,e,s,n,r){return this}ellipse(t,e,s,n,r,o,a,h){return this}arc(t,e,s,n,r,o){return this}arcTo(t,e,s,n,r){return this}drawEllipse(t,e,s,n,r,o,a,h){return this}drawArc(t,e,s,n,r,o){return this}drawPoints(t,e,s){return this}clearPath(){return this}paint(){this.pathElement.__layout.boxChanged||this.pathElement.forceUpdate("path")}};_([vt(Hf)],Hs.prototype,"__",void 0);_([T_()],Hs.prototype,"path",void 0);Hs=_([Jt(Dr,["set","path","paint"]),kt()],Hs);function T_(){return(i,t)=>{Ii(i,t,{get(){return this.__path}})}}function Be(i,t,e,s){var n=arguments.length,r=n<3?t:s===null?s=Object.getOwnPropertyDescriptor(t,e):s,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(i,t,e,s);else for(var a=i.length-1;a>=0;a--)(o=i[a])&&(r=(n<3?o(r):n>3?o(t,e,r):o(t,e))||r);return n>3&&r&&Object.defineProperty(t,e,r),r}let Sr=class extends $e{get __tag(){return"App"}get isApp(){return!0}constructor(t,e){super(t,e)}init(t,e){if(super.init(t,e),t){const{ground:s,tree:n,sky:r,editor:o}=t;s&&(this.ground=this.addLeafer(s)),(n||o)&&(this.tree=this.addLeafer(n)),(r||o)&&(this.sky=this.addLeafer(r||{type:"draw",usePartRender:!1})),o&&this.sky.add(this.editor=ct.editor(o))}}__setApp(){const{canvas:t}=this,{realCanvas:e,view:s}=this.config;e||s===this.canvas.view||!t.parentView?this.realCanvas=!0:t.unrealCanvas(),this.leafer=this,this.watcher.disable(),this.layouter.disable(),this.__eventIds.push(this.on_(ke.CHANGE,this.__onPropertyChange,this))}start(){super.start(),this.children.forEach(t=>t.start())}stop(){this.children.forEach(t=>t.stop()),super.stop()}unlockLayout(){super.unlockLayout(),this.children.forEach(t=>t.unlockLayout())}lockLayout(){super.lockLayout(),this.children.forEach(t=>t.lockLayout())}forceRender(t){this.children.forEach(e=>e.forceRender(t))}addLeafer(t){const e=new $e(t);return this.add(e),e}add(t,e){if(!t.view){if(this.realCanvas&&!this.canvas.bounds){setTimeout(()=>this.add(t,e),10);return}t.init(this.__getChildConfig(t.userConfig),this)}super.add(t,e),e!==void 0&&(t.canvas.childIndex=e),this.__listenChildEvents(t)}__onPropertyChange(){K.showHitView&&this.children.forEach(t=>t.forceUpdate("surface"))}__onCreated(){this.created=this.children.every(t=>t.created)}__onReady(){this.children.every(t=>t.ready)&&super.__onReady()}__onViewReady(){this.children.every(t=>t.viewReady)&&super.__onViewReady()}__onChildRenderEnd(t){this.renderer.addBlock(t.renderBounds),this.viewReady&&this.renderer.update()}__render(t,e){if(t.context){const s=e.matrix;s&&t.setTransform(s.a,s.b,s.c,s.d,s.e,s.f),this.children.forEach(n=>t.copyWorld(n.canvas))}}__onResize(t){this.children.forEach(e=>e.resize(t)),super.__onResize(t)}__checkUpdateLayout(){this.children.forEach(t=>t.__layout.update())}__getChildConfig(t){let e=Object.assign({},this.config);return e.hittable=e.realCanvas=void 0,t&&_t.assign(e,t),this.autoLayout&&_t.copyAttrs(e,this,Qt),e.view=this.realCanvas?void 0:this.view,e.fill=void 0,e}__listenChildEvents(t){t.once(q.END,()=>this.__onReady()),t.once(Q.START,()=>this.__onCreated()),t.once(Q.END,()=>this.__onViewReady()),this.realCanvas&&this.__eventIds.push(t.on_(Q.END,this.__onChildRenderEnd,this))}};Sr=Be([kt()],Sr);const Es={},Qi={isHoldSpaceKey(){return Qi.isHold("Space")},isHold(i){return Es[i]},setDownCode(i){Es[i]||(Es[i]=!0)},setUpCode(i){Es[i]=!1}},qt={LEFT:1,RIGHT:2,MIDDLE:4,defaultLeft(i){i.buttons||(i.buttons=1)},left(i){return i.buttons===1},right(i){return i.buttons===2},middle(i){return i.buttons===4}};class tn extends Ce{get spaceKey(){return Qi.isHoldSpaceKey()}get left(){return qt.left(this)}get right(){return qt.right(this)}get middle(){return qt.middle(this)}constructor(t){super(t.type),this.bubbles=!0,Object.assign(this,t)}getBoxPoint(t){return(t||this.current).getBoxPoint(this)}getInnerPoint(t){return(t||this.current).getInnerPoint(this)}getLocalPoint(t){return(t||this.current).getLocalPoint(this)}getPagePoint(){return this.current.getPagePoint(this)}getInner(t){return this.getInnerPoint(t)}getLocal(t){return this.getLocalPoint(t)}getPage(){return this.getPagePoint()}static changeName(t,e){Bi.changeName(t,e)}}let b=class extends tn{};b.POINTER="pointer";b.BEFORE_DOWN="pointer.before_down";b.BEFORE_MOVE="pointer.before_move";b.BEFORE_UP="pointer.before_up";b.DOWN="pointer.down";b.MOVE="pointer.move";b.UP="pointer.up";b.OVER="pointer.over";b.OUT="pointer.out";b.ENTER="pointer.enter";b.LEAVE="pointer.leave";b.TAP="tap";b.DOUBLE_TAP="double_tap";b.CLICK="click";b.DOUBLE_CLICK="double_click";b.LONG_PRESS="long_press";b.LONG_TAP="long_tap";b.MENU="pointer.menu";b.MENU_TAP="pointer.menu_tap";b=Be([Ne()],b);const Ni={};let V=class extends b{static setList(t){this.list=t instanceof lt?t:new lt(t)}static setData(t){this.data=t}static getValidMove(t,e,s){const{draggable:n,dragBounds:r}=t,o=t.getLocalPoint(s,null,!0);return D.move(o,e.x-t.x,e.y-t.y),r&&this.getMoveInDragBounds(t.__local,r==="parent"?t.parent.boxBounds:r,o,!0),n==="x"&&(o.y=0),n==="y"&&(o.x=0),o}static getMoveInDragBounds(t,e,s,n){const r=t.x+s.x,o=t.y+s.y,a=r+t.width,h=o+t.height,l=e.x+e.width,c=e.y+e.height;return n||(s=Object.assign({},s)),O.includes(t,e)?(r>e.x?s.x+=e.x-r:a<l&&(s.x+=l-a),o>e.y?s.y+=e.y-o:h<c&&(s.y+=c-h)):(r<e.x?s.x+=e.x-r:a>l&&(s.x+=l-a),o<e.y?s.y+=e.y-o:h>c&&(s.y+=c-h)),s}getPageMove(t){return this.assignMove(t),this.current.getPagePoint(Ni,null,!0)}getInnerMove(t,e){return t||(t=this.current),this.assignMove(e),t.getInnerPoint(Ni,null,!0)}getLocalMove(t,e){return t||(t=this.current),this.assignMove(e),t.getLocalPoint(Ni,null,!0)}getPageTotal(){return this.getPageMove(!0)}getInnerTotal(t){return this.getInnerMove(t,!0)}getLocalTotal(t){return this.getLocalMove(t,!0)}getPageBounds(){const t=this.getPageTotal(),e=this.getPagePoint(),s={};return O.set(s,e.x-t.x,e.y-t.y,t.x,t.y),O.unsign(s),s}assignMove(t){Ni.x=t?this.totalX:this.moveX,Ni.y=t?this.totalY:this.moveY}};V.BEFORE_DRAG="drag.before_drag";V.START="drag.start";V.DRAG="drag";V.END="drag.end";V.OVER="drag.over";V.OUT="drag.out";V.ENTER="drag.enter";V.LEAVE="drag.leave";V=Be([Ne()],V);let ss=class extends b{static setList(t){V.setList(t)}static setData(t){V.setData(t)}};ss.DROP="drop";ss=Be([Ne()],ss);let yt=class extends V{};yt.BEFORE_MOVE="move.before_move";yt.START="move.start";yt.MOVE="move";yt.END="move.end";yt=Be([Ne()],yt);let ce=class extends tn{};ce.BEFORE_ROTATE="rotate.before_rotate";ce.START="rotate.start";ce.ROTATE="rotate";ce.END="rotate.end";ce=Be([Ne()],ce);let ee=class extends V{};ee.SWIPE="swipe";ee.LEFT="swipe.left";ee.RIGHT="swipe.right";ee.UP="swipe.up";ee.DOWN="swipe.down";ee=Be([Ne()],ee);let jt=class extends tn{};jt.BEFORE_ZOOM="zoom.before_zoom";jt.START="zoom.start";jt.ZOOM="zoom";jt.END="zoom.end";jt=Be([Ne()],jt);let We=class extends tn{};We.DOWN="key.down";We.HOLD="key.hold";We.UP="key.up";We=Be([Ne()],We);function zh(i){i.isApp||i.__eventIds.push(i.on_(yt.BEFORE_MOVE,t=>{i.zoomLayer.move(i.getValidMove(t.moveX,t.moveY))}),i.on_(jt.BEFORE_ZOOM,t=>{const{zoomLayer:e}=i,s=i.getValidScale(t.scale);s!==1&&(D.scaleOf(e,t,s),e.scale=e.__.scaleX*s)}))}function S_(i){zh(i);const{move:t,zoom:e}=i.config;t.scroll="limit",e.min=1}function C_(i){const{config:t}=i;(t.wheel||(t.wheel={})).preventDefault=!1,(t.touch||(t.touch={})).preventDefault="auto"}const P_=K.get("LeaferTypeCreator"),$h={list:{},register(i,t){Zn[i]&&P_.repeat(i),Zn[i]=t},run(i,t){const e=Zn[i];e&&e(t)}},{list:Zn,register:Ur}=$h;Ur("design",zh);Ur("document",S_);Ur("block",C_);const Fr=$e.prototype;Fr.initType=function(i){$h.run(i,this)};Fr.getValidMove=function(i,t){const{scroll:e,disabled:s}=this.app.config.move;if(e&&(Math.abs(i)>Math.abs(t)?t=0:i=0,e==="limit")){const{x:n,y:r,width:o,height:a}=new nt(this.__world).addPoint(this.zoomLayer),h=n+o-this.width,l=r+a-this.height;n>=0&&h<=0?i=0:i>0?n+i>0&&(i=-n):i<0&&h+i<0&&(i=-h),r>=0&&l<=0?t=0:t>0?r+t>0&&(t=-r):t<0&&l+t<0&&(t=-l)}return{x:s?0:i,y:s?0:t}};Fr.getValidScale=function(i){const{scaleX:t}=this.zoomLayer.__,{min:e,max:s,disabled:n}=this.app.config.zoom,r=Math.abs(t*i);return r<e?i=e/t:r>s&&(i=s/t),n?1:i};class B_{get transforming(){return!!(this.moveData||this.zoomData||this.rotateData)}constructor(t){this.interaction=t}move(t){const{interaction:e}=this;if(t.moveType||(t.moveType="move"),!this.moveData){const{path:s}=e.selector.getByPoint(t,e.hitRadius);t.path=s,this.moveData=Object.assign(Object.assign({},t),{moveX:0,moveY:0}),e.cancelHover(),e.emit(yt.START,this.moveData)}t.path=this.moveData.path,e.emit(yt.BEFORE_MOVE,t),e.emit(yt.MOVE,t),this.transformEndWait()}zoom(t){const{interaction:e}=this;if(!this.zoomData){const{path:s}=e.selector.getByPoint(t,e.hitRadius);t.path=s,this.zoomData=Object.assign(Object.assign({},t),{scale:1}),e.cancelHover(),e.emit(jt.START,this.zoomData)}t.path=this.zoomData.path,e.emit(jt.BEFORE_ZOOM,t),e.emit(jt.ZOOM,t),this.transformEndWait()}rotate(t){const{interaction:e}=this;if(!this.rotateData){const{path:s}=e.selector.getByPoint(t,e.hitRadius);t.path=s,this.rotateData=Object.assign(Object.assign({},t),{rotation:0}),e.cancelHover(),e.emit(ce.START,this.rotateData)}t.path=this.rotateData.path,e.emit(ce.BEFORE_ROTATE,t),e.emit(ce.ROTATE,t),this.transformEndWait()}transformEndWait(){clearTimeout(this.transformTimer),this.transformTimer=setTimeout(()=>{this.transformEnd()},this.interaction.config.pointer.transformTime)}transformEnd(){this.moveEnd(),this.zoomEnd(),this.rotateEnd()}moveEnd(){this.moveData&&(this.interaction.emit(yt.END,this.moveData),this.moveData=null)}zoomEnd(){this.zoomData&&(this.interaction.emit(jt.END,this.zoomData),this.zoomData=null)}rotateEnd(){this.rotateData&&(this.interaction.emit(ce.END,this.rotateData),this.rotateData=null)}destroy(){this.zoomData=this.moveData=this.rotateData=null}}const ie={getMoveEventData(i,t,e){return Object.assign(Object.assign({},e),{x:i.x,y:i.y,moveX:t.x,moveY:t.y})},getRotateEventData(i,t,e){return Object.assign(Object.assign({},e),{x:i.x,y:i.y,rotation:t})},getZoomEventData(i,t,e){return Object.assign(Object.assign({},e),{x:i.x,y:i.y,scale:t})},getDragEventData(i,t,e){return Object.assign(Object.assign({},e),{x:e.x,y:e.y,moveX:e.x-t.x,moveY:e.y-t.y,totalX:e.x-i.x,totalY:e.y-i.y})},getDropEventData(i,t,e){return Object.assign(Object.assign({},i),{list:t,data:e})},getSwipeDirection(i){return i<-45&&i>-135?ee.UP:i>45&&i<135?ee.DOWN:i<=45&&i>=-45?ee.RIGHT:ee.LEFT},getSwipeEventData(i,t,e){return Object.assign(Object.assign({},e),{moveX:t.moveX,moveY:t.moveY,totalX:e.x-i.x,totalY:e.y-i.y,type:R_.getSwipeDirection(D.getAngle(i,e))})},getBase(i){const t=i.button===1?4:i.button;return{altKey:i.altKey,ctrlKey:i.ctrlKey,shiftKey:i.shiftKey,metaKey:i.metaKey,buttons:i.buttons===void 0?1:i.buttons===0?t:i.buttons,origin:i}},pathHasEventType(i,t){const{list:e}=i;for(let s=0,n=e.length;s<n;s++)if(e[s].hasEvent(t))return!0;return!1},filterPathByEventType(i,t){const e=new lt,{list:s}=i;for(let n=0,r=s.length;n<r;n++)s[n].hasEvent(t)&&e.add(s[n]);return e},pathCanDrag(i){return i&&i.list.some(t=>t.draggable||t.editable||!t.isLeafer&&t.hasEvent(V.DRAG))},pathHasOutside(i){return i&&i.list.some(t=>t.isOutside)}},R_=ie,wa=new lt,{getDragEventData:Kn,getDropEventData:E_,getSwipeEventData:O_}=ie;class I_{constructor(t){this.interaction=t}setDragData(t){this.animateWait&&this.dragEndReal(),this.downData=this.interaction.downData,this.dragData=Kn(t,t,t),this.canAnimate=this.canDragOut=!0}getList(t,e){const{proxy:s}=this.interaction.selector,n=s&&s.list.length,r=V.list||this.draggableList||wa;return this.dragging&&(n?t?wa:new lt(e?[...s.list,...s.dragHoverExclude]:s.list):r)}checkDrag(t,e){const{interaction:s}=this;if(this.moving&&t.buttons<1){this.canAnimate=!1,s.pointerCancel();return}!this.moving&&e&&(this.moving=s.canMove(this.downData)||s.isHoldRightKey||s.isMobileDragEmpty)&&(this.dragData.moveType="drag",s.emit(yt.START,this.dragData)),this.moving||this.dragStart(t,e),this.drag(t)}dragStart(t,e){this.dragging||(this.dragging=e&&qt.left(t),this.dragging&&(this.interaction.emit(V.START,this.dragData),this.getDraggableList(this.dragData.path),this.setDragStartPoints(this.realDraggableList=this.getList(!0))))}setDragStartPoints(t){this.dragStartPoints={},t.forEach(e=>this.dragStartPoints[e.innerId]={x:e.x,y:e.y})}getDraggableList(t){let e;for(let s=0,n=t.length;s<n;s++)if(e=t.list[s],(e.draggable||e.editable)&&e.hitSelf&&!e.locked){this.draggableList=new lt(e);break}}drag(t){const{interaction:e,dragData:s,downData:n}=this,{path:r,throughPath:o}=n;this.dragData=Kn(n,s,t),o&&(this.dragData.throughPath=o),this.dragData.path=r,this.moving?(this.dragData.moveType="drag",e.emit(yt.BEFORE_MOVE,this.dragData),e.emit(yt.MOVE,this.dragData)):this.dragging&&(this.dragReal(),e.emit(V.BEFORE_DRAG,this.dragData),e.emit(V.DRAG,this.dragData))}dragReal(){const{running:t}=this.interaction,e=this.realDraggableList;if(e.length&&t){const{totalX:s,totalY:n}=this.dragData;e.forEach(r=>r.draggable&&r.move(V.getValidMove(r,this.dragStartPoints[r.innerId],{x:s,y:n})))}}dragOverOrOut(t){const{interaction:e}=this,{dragOverPath:s}=this,{path:n}=t;this.dragOverPath=n,s?n.indexAt(0)!==s.indexAt(0)&&(e.emit(V.OUT,t,s),e.emit(V.OVER,t,n)):e.emit(V.OVER,t,n)}dragEnterOrLeave(t){const{interaction:e}=this,{dragEnterPath:s}=this,{path:n}=t;e.emit(V.LEAVE,t,s,n),e.emit(V.ENTER,t,n,s),this.dragEnterPath=n}dragEnd(t,e){if(!this.dragging&&!this.moving)return;const{moveX:s,moveY:n}=this.dragData;this.interaction.config.move.dragAnimate&&this.canAnimate&&this.moving&&(Math.abs(s)>1||Math.abs(n)>1)?(t=Object.assign({},t),e=(e||(t.pointerType==="touch"?2:1))*.9,D.move(t,s*e,n*e),this.drag(t),this.animate(()=>{this.dragEnd(t,1)})):this.dragEndReal(t)}dragEndReal(t){const{interaction:e,downData:s,dragData:n}=this;t||(t=n);const{path:r,throughPath:o}=s,a=Kn(s,t,t);if(o&&(a.throughPath=o),a.path=r,this.moving&&(this.moving=!1,a.moveType="drag",e.emit(yt.END,a)),this.dragging){const h=this.getList();this.dragging=!1,e.emit(V.END,a),this.swipe(t,s,n,a),this.drop(t,h,this.dragEnterPath)}this.autoMoveCancel(),this.dragReset(),this.animate(null,"off")}animate(t,e){const s=t||this.animateWait;s&&this.interaction.target.nextRender(s,null,e),this.animateWait=t}swipe(t,e,s,n){const{interaction:r}=this;if(D.getDistance(e,t)>r.config.pointer.swipeDistance){const o=O_(e,s,n);this.interaction.emit(o.type,o)}}drop(t,e,s){const n=E_(t,e,V.data);n.path=s,this.interaction.emit(ss.DROP,n),this.interaction.emit(V.LEAVE,t,s)}dragReset(){V.list=V.data=this.draggableList=this.dragData=this.downData=this.dragOverPath=this.dragEnterPath=null}checkDragOut(t){const{interaction:e}=this;this.autoMoveCancel(),this.dragging&&!e.shrinkCanvasBounds.hitPoint(t)&&this.autoMoveOnDragOut(t)}autoMoveOnDragOut(t){const{interaction:e,downData:s,canDragOut:n}=this,{autoDistance:r,dragOut:o}=e.config.move;if(!o||!n||!r)return;const a=e.shrinkCanvasBounds,{x:h,y:l}=a,c=O.maxX(a),p=O.maxY(a),f=t.x<h?r:c<t.x?-r:0,d=t.y<l?r:p<t.y?-r:0;let u=0,y=0;this.autoMoveTimer=setInterval(()=>{u+=f,y+=d,D.move(s,f,d),D.move(this.dragData,f,d),e.move(Object.assign(Object.assign({},t),{moveX:f,moveY:d,totalX:u,totalY:y,moveType:"drag"})),e.pointerMoveReal(t)},10)}autoMoveCancel(){this.autoMoveTimer&&(clearInterval(this.autoMoveTimer),this.autoMoveTimer=0)}destroy(){this.dragReset()}}const M_=K.get("emit");function A_(i,t,e,s){if(!e&&!t.path)return;let n;t.type=i,e?t=Object.assign(Object.assign({},t),{path:e}):e=t.path,t.target=e.indexAt(0);try{for(let r=e.length-1;r>-1;r--){if(n=e.list[r],Cr(n,i,t,!0,s))return;n.isApp&&va(n,i,t,!0,s)}for(let r=0,o=e.length;r<o;r++)if(n=e.list[r],n.isApp&&va(n,i,t,!1,s),Cr(n,i,t,!1,s))return}catch(r){M_.error(r)}}const D_=["move","zoom","rotate","key"];function va(i,t,e,s,n){if(D_.some(r=>t.startsWith(r))&&i.__.hitChildren&&!Uh(i,n)){let r;for(let o=0,a=i.children.length;o<a;o++)r=i.children[o],!e.path.has(r)&&r.__.hittable&&Cr(r,t,e,s,n)}}function Cr(i,t,e,s,n){if(i.destroyed)return!1;if(i.__.hitSelf&&!Uh(i,n)&&(la.updateEventStyle&&!s&&la.updateEventStyle(i,t),i.hasEvent(t,s))){e.phase=s?1:i===e.target?2:3;const r=Bi.get(t,e);if(i.emitEvent(r,s),r.isStop)return!0}return!1}function Uh(i,t){return t&&t.has(i)}const L_={getData(i){const t=i[0],e=i[1],s=D.getCenter(t.from,e.from),n=D.getCenter(t.to,e.to),r={x:n.x-s.x,y:n.y-s.y},o=D.getDistance(t.from,e.from),h=D.getDistance(t.to,e.to)/o,l=D.getRotation(t.from,e.from,t.to,e.to);return{move:r,scale:h,angle:l,center:n}}},W_={wheel:{zoomSpeed:.5,moveSpeed:.5,rotateSpeed:.5,delta:{x:80/4,y:8},preventDefault:!0},pointer:{hitRadius:5,tapTime:120,longPressTime:800,transformTime:500,hover:!0,dragHover:!0,dragDistance:2,swipeDistance:20,preventDefaultMenu:!0},touch:{preventDefault:!0},multiTouch:{},cursor:!0,keyEvent:!0},{pathHasEventType:Xn,getMoveEventData:z_,getZoomEventData:$_,getRotateEventData:U_,pathCanDrag:F_,pathHasOutside:ka}=ie;class N_{get dragging(){return this.dragger.dragging}get transforming(){return this.transformer.transforming}get moveMode(){return this.m.drag===!0||this.isHoldSpaceKey||this.isHoldMiddleKey||this.isHoldRightKey&&this.dragger.moving||this.isDragEmpty}get canHover(){return this.p.hover&&!this.config.mobile}get isDragEmpty(){return this.m.dragEmpty&&this.isRootPath(this.hoverData)&&(!this.downData||this.isRootPath(this.downData))}get isMobileDragEmpty(){return this.m.dragEmpty&&!this.canHover&&this.downData&&this.isTreePath(this.downData)}get isHoldMiddleKey(){return this.m.holdMiddleKey&&this.downData&&qt.middle(this.downData)}get isHoldRightKey(){return this.m.holdRightKey&&this.downData&&qt.right(this.downData)}get isHoldSpaceKey(){return this.m.holdSpaceKey&&Qi.isHoldSpaceKey()}get m(){return this.config.move}get p(){return this.config.pointer}get hitRadius(){return this.p.hitRadius}constructor(t,e,s,n){this.config=_t.clone(W_),this.tapCount=0,this.downKeyMap={},this.target=t,this.canvas=e,this.selector=s,this.defaultPath=new lt(t),this.transformer=new B_(this),this.dragger=new I_(this),n&&(this.config=_t.default(n,this.config)),this.__listenEvents()}start(){this.running=!0}stop(){this.running=!1}receive(t){}pointerDown(t,e){t||(t=this.hoverData),t&&(qt.defaultLeft(t),this.updateDownData(t),this.checkPath(t,e),this.downTime=Date.now(),this.emit(b.BEFORE_DOWN,t),this.emit(b.DOWN,t),qt.left(t)&&(this.tapWait(),this.longPressWait(t)),this.waitRightTap=qt.right(t),this.dragger.setDragData(t),this.isHoldRightKey||this.updateCursor(t))}pointerMove(t){if(t||(t=this.hoverData),!t)return;const{downData:e}=this;e&&qt.defaultLeft(t),(this.canvas.bounds.hitPoint(t)||e)&&(this.pointerMoveReal(t),e&&this.dragger.checkDragOut(t))}pointerMoveReal(t){const{dragHover:e,dragDistance:s}=this.p;if(this.emit(b.BEFORE_MOVE,t,this.defaultPath),this.downData){const n=D.getDistance(this.downData,t)>s;n&&(this.waitTap&&this.pointerWaitCancel(),this.waitRightTap=!1),this.dragger.checkDrag(t,n)}this.dragger.moving||(this.updateHoverData(t),this.checkPath(t),this.emit(b.MOVE,t),this.dragging&&!e||this.pointerHover(t),this.dragger.dragging&&(this.dragger.dragOverOrOut(t),this.dragger.dragEnterOrLeave(t))),this.updateCursor(this.downData||t)}pointerUp(t){const{downData:e}=this;if(t||(t=e),!e)return;qt.defaultLeft(t),t.multiTouch=e.multiTouch,this.findPath(t);const s=Object.assign(Object.assign({},t),{path:t.path.clone()});t.path.addList(e.path.list),this.checkPath(t),this.downData=null,this.emit(b.BEFORE_UP,t),this.emit(b.UP,t),this.touchLeave(t),t.isCancel||(this.tap(t),this.menuTap(t)),this.dragger.dragEnd(t),this.updateCursor(s)}pointerCancel(){const t=Object.assign({},this.dragger.dragData);t.isCancel=!0,this.pointerUp(t)}multiTouch(t,e){if(this.config.multiTouch.disabled)return;const{move:s,angle:n,scale:r,center:o}=L_.getData(e);this.rotate(U_(o,n,t)),this.zoom($_(o,r,t)),this.move(z_(o,s,t))}menu(t){this.findPath(t),this.emit(b.MENU,t),this.waitMenuTap=!0,!this.downData&&this.waitRightTap&&this.menuTap(t)}menuTap(t){this.waitRightTap&&this.waitMenuTap&&(this.emit(b.MENU_TAP,t),this.waitRightTap=this.waitMenuTap=!1)}move(t){this.transformer.move(t)}zoom(t){this.transformer.zoom(t)}rotate(t){this.transformer.rotate(t)}transformEnd(){this.transformer.transformEnd()}keyDown(t){if(!this.config.keyEvent)return;const{code:e}=t;this.downKeyMap[e]||(this.downKeyMap[e]=!0,Qi.setDownCode(e),this.emit(We.HOLD,t,this.defaultPath),this.moveMode&&(this.cancelHover(),this.updateCursor())),this.emit(We.DOWN,t,this.defaultPath)}keyUp(t){if(!this.config.keyEvent)return;const{code:e}=t;this.downKeyMap[e]=!1,Qi.setUpCode(e),this.emit(We.UP,t,this.defaultPath),this.cursor==="grab"&&this.updateCursor()}pointerHover(t){this.canHover&&(this.pointerOverOrOut(t),this.pointerEnterOrLeave(t))}pointerOverOrOut(t){const{path:e}=t,{overPath:s}=this;this.overPath=e,s?e.indexAt(0)!==s.indexAt(0)&&(this.emit(b.OUT,t,s),this.emit(b.OVER,t,e)):this.emit(b.OVER,t,e)}pointerEnterOrLeave(t){let{path:e}=t;this.downData&&!this.moveMode&&(e=e.clone(),this.downData.path.forEach(n=>e.add(n)));const{enterPath:s}=this;this.enterPath=e,this.emit(b.LEAVE,t,s,e),this.emit(b.ENTER,t,e,s)}touchLeave(t){t.pointerType==="touch"&&this.enterPath&&(this.emit(b.LEAVE,t),this.dragger.dragging&&this.emit(ss.LEAVE,t))}tap(t){const{pointer:e}=this.config,s=this.longTap(t);if(!e.tapMore&&s||!this.waitTap)return;e.tapMore&&this.emitTap(t);const n=Date.now()-this.downTime,r=[b.DOUBLE_TAP,b.DOUBLE_CLICK].some(o=>Xn(t.path,o));n<e.tapTime+50&&r?(this.tapCount++,this.tapCount===2?(this.tapWaitCancel(),this.emitDoubleTap(t)):(clearTimeout(this.tapTimer),this.tapTimer=setTimeout(()=>{e.tapMore||(this.tapWaitCancel(),this.emitTap(t))},e.tapTime))):e.tapMore||(this.tapWaitCancel(),this.emitTap(t))}findPath(t,e){const{hitRadius:s,through:n}=this.p,{bottomList:r}=this,o=this.selector.getByPoint(t,s,Object.assign({bottomList:r,name:t.type},e||{through:n}));return o.throughPath&&(t.throughPath=o.throughPath),t.path=o.path,o.path}isRootPath(t){return t&&t.path.list[0].isLeafer}isTreePath(t){const e=this.target.app;return!e||!e.isApp?!1:e.editor&&!t.path.has(e.editor)&&t.path.has(e.tree)&&!t.target.syncEventer}checkPath(t,e){(e||this.moveMode&&!ka(t.path))&&(t.path=this.defaultPath)}canMove(t){return t&&(this.moveMode||this.m.drag==="auto"&&!F_(t.path))&&!ka(t.path)}isDrag(t){return this.dragger.getList().has(t)}isPress(t){return this.downData&&this.downData.path.has(t)}isHover(t){return this.enterPath&&this.enterPath.has(t)}isFocus(t){return this.focusData===t}cancelHover(){const{hoverData:t}=this;t&&(t.path=this.defaultPath,this.pointerHover(t))}updateDownData(t,e,s){const{downData:n}=this;!t&&n&&(t=n),t&&(this.findPath(t,e),s&&n&&t.path.addList(n.path.list),this.downData=t)}updateHoverData(t){t||(t=this.hoverData),t&&(this.findPath(t,{exclude:this.dragger.getList(!1,!0),name:b.MOVE}),this.hoverData=t)}updateCursor(t){if(!this.config.cursor||!this.canHover)return;if(t||(this.updateHoverData(),t=this.downData||this.hoverData),this.dragger.moving)return this.setCursor("grabbing");if(this.canMove(t))return this.setCursor(this.downData?"grabbing":"grab");if(!t)return;let e,s;const{path:n}=t;for(let r=0,o=n.length;r<o&&(e=n.list[r],s=e.syncEventer&&e.syncEventer.cursor||e.cursor,!s);r++);this.setCursor(s)}setCursor(t){this.cursor=t}getLocal(t,e){const s=this.canvas.getClientBounds(e);return{x:t.clientX-s.x,y:t.clientY-s.y}}emitTap(t){this.emit(b.TAP,t),this.emit(b.CLICK,t)}emitDoubleTap(t){this.emit(b.DOUBLE_TAP,t),this.emit(b.DOUBLE_CLICK,t)}pointerWaitCancel(){this.tapWaitCancel(),this.longPressWaitCancel()}tapWait(){clearTimeout(this.tapTimer),this.waitTap=!0}tapWaitCancel(){clearTimeout(this.tapTimer),this.waitTap=!1,this.tapCount=0}longPressWait(t){clearTimeout(this.longPressTimer),this.longPressTimer=setTimeout(()=>{this.longPressed=!0,this.emit(b.LONG_PRESS,t)},this.p.longPressTime)}longTap(t){let e;return this.longPressed&&(this.emit(b.LONG_TAP,t),(Xn(t.path,b.LONG_TAP)||Xn(t.path,b.LONG_PRESS))&&(e=!0)),this.longPressWaitCancel(),e}longPressWaitCancel(){clearTimeout(this.longPressTimer),this.longPressed=!1}__onResize(){this.shrinkCanvasBounds=new nt(this.canvas.bounds),this.shrinkCanvasBounds.spread(-2)}__listenEvents(){const{target:t}=this;this.__eventIds=[t.on_(Ge.RESIZE,this.__onResize,this)],t.once(at.READY,()=>this.__onResize())}__removeListenEvents(){this.target.off_(this.__eventIds),this.__eventIds.length=0}emit(t,e,s,n){this.running&&A_(t,e,s,n)}destroy(){this.__eventIds.length&&(this.stop(),this.__removeListenEvents(),this.dragger.destroy(),this.transformer.destroy(),this.downData=this.overPath=this.enterPath=null)}}class Fh{static set(t,e){this.custom[t]=e}static get(t){return this.custom[t]}}Fh.custom={};class G_ extends mh{constructor(){super(...arguments),this.maxTotal=1e3,this.pathList=new lt,this.pixelList=new lt}getPixelType(t,e){return this.__autoClear(),this.pixelList.add(t),ct.hitCanvas(e)}getPathType(t){return this.__autoClear(),this.pathList.add(t),ct.hitCanvas()}clearImageType(){this.__clearLeafList(this.pixelList)}clearPathType(){this.__clearLeafList(this.pathList)}__clearLeafList(t){t.length&&(t.forEach(e=>{e.__hitCanvas&&(e.__hitCanvas.destroy(),e.__hitCanvas=null)}),t.reset())}__autoClear(){this.pathList.length+this.pixelList.length>this.maxTotal&&this.clear()}clear(){this.clearPathType(),this.clearImageType()}}const{toInnerRadiusPointOf:H_,copy:j_,setRadius:V_}=D,Gi={},us=ei.prototype;us.__hitWorld=function(i){if(!this.__.hitSelf)return!1;this.__.hitRadius&&(j_(Gi,i),i=Gi,V_(i,this.__.hitRadius)),H_(i,this.__world,Gi);const{width:t,height:e}=this.__world,s=t<10&&e<10;if(this.__.hitBox||s){if(O.hitRadiusPoint(this.__layout.boxBounds,Gi))return!0;if(s)return!1}return(this.__layout.hitCanvasChanged||!this.__hitCanvas)&&(this.__updateHitCanvas(),this.__layout.boundsChanged||(this.__layout.hitCanvasChanged=!1)),this.__hit(Gi)};us.__hitFill=function(i){var t;return(t=this.__hitCanvas)===null||t===void 0?void 0:t.hitFill(i,this.__.windingRule)};us.__hitStroke=function(i,t){var e;return(e=this.__hitCanvas)===null||e===void 0?void 0:e.hitStroke(i,t)};us.__hitPixel=function(i){var t;return(t=this.__hitCanvas)===null||t===void 0?void 0:t.hitPixel(i,this.__layout.renderBounds,this.__hitCanvas.hitScale)};us.__drawHitPath=function(i){i&&this.__drawRenderPath(i)};const Y_=new ze,Nh=w.prototype;Nh.__updateHitCanvas=function(){const i=this.__,{hitCanvasManager:t}=this.leafer,e=(i.__pixelFill||i.__isCanvas)&&i.hitFill==="pixel",s=i.__pixelStroke&&i.hitStroke==="pixel",n=e||s;this.__hitCanvas||(this.__hitCanvas=n?t.getPixelType(this,{contextSettings:{willReadFrequently:!0}}):t.getPathType(this));const r=this.__hitCanvas;if(n){const{renderBounds:o}=this.__layout,a=S.image.hitCanvasSize,h=r.hitScale=F.set(0,0,a,a).getFitMatrix(o).a,{x:l,y:c,width:p,height:f}=F.set(o).scale(h);r.resize({width:p,height:f,pixelRatio:1}),r.clear(),At.patternLocked=!0,this.__renderShape(r,{matrix:Y_.setWith(this.__world).scaleWith(1/h).invertWith().translate(-l,-c)},!e,!s),At.patternLocked=!1,r.resetTransform(),i.__isHitPixel=!0}else i.__isHitPixel&&(i.__isHitPixel=!1);this.__drawHitPath(r),r.setStrokeOptions(i)};Nh.__hit=function(i){S.name==="miniapp"&&this.__drawHitPath(this.__hitCanvas);const t=this.__;if(t.__isHitPixel&&this.__hitPixel(i))return!0;const{hitFill:e}=t,s=(t.fill||t.__isCanvas)&&(e==="path"||e==="pixel"&&!(t.__pixelFill||t.__isCanvas))||e==="all";if(s&&this.__hitFill(i))return!0;const{hitStroke:n,__strokeWidth:r}=t,o=t.stroke&&(n==="path"||n==="pixel"&&!t.__pixelStroke)||n==="all";if(!s&&!o)return!1;const a=i.radiusX*2;let h=a;if(o)switch(t.strokeAlign){case"inside":if(h+=r*2,!s&&this.__hitFill(i)&&this.__hitStroke(i,h))return!0;h=a;break;case"center":h+=r;break;case"outside":if(h+=r*2,!s){if(!this.__hitFill(i)&&this.__hitStroke(i,h))return!0;h=a}break}return h?this.__hitStroke(i,h):!1};const Gh=w.prototype,Hh=ni.prototype,jh=dt.prototype;Hh.__updateHitCanvas=jh.__updateHitCanvas=function(){this.stroke||this.cornerRadius||(this.fill||this.__.__isCanvas)&&this.hitFill==="pixel"||this.hitStroke==="all"?Gh.__updateHitCanvas.call(this):this.__hitCanvas&&(this.__hitCanvas=null)};Hh.__hitFill=jh.__hitFill=function(i){return this.__hitCanvas?Gh.__hitFill.call(this,i):O.hitRadiusPoint(this.__layout.boxBounds,i)};const Vh=w.prototype,Z_=Bt.prototype;function Nr(i){return i.leafer?i.leafer.selector:S.selector||(S.selector=ct.selector())}Vh.find=function(i,t){return Nr(this).getBy(i,this,!1,t)};Vh.findOne=function(i,t){return Nr(this).getBy(i,this,!0,t)};Z_.pick=function(i,t){return this.__layout.update(),t||(t={}),Nr(this).getByPoint(i,t.hitRadius||0,Object.assign(Object.assign({},t),{target:this}))};const Gr=Ar.prototype;Gr.hitFill=function(i,t){return t?this.context.isPointInPath(i.x,i.y,t):this.context.isPointInPath(i.x,i.y)};Gr.hitStroke=function(i,t){return this.strokeWidth=t,this.context.isPointInStroke(i.x,i.y)};Gr.hitPixel=function(i,t,e=1){let{x:s,y:n,radiusX:r,radiusY:o}=i;t&&(s-=t.x,n-=t.y),F.set(s-r,n-o,r*2,o*2).scale(e).ceil();const{data:a}=this.context.getImageData(F.x,F.y,F.width||1,F.height||1);for(let h=0,l=a.length;h<l;h+=4)if(a[h+3]>0)return!0;return a[3]>0};const ba=K.get("LeaferCanvas");class Yh extends Ar{set zIndex(t){const{style:e}=this.view;e.zIndex=t,this.setAbsolute(this.view)}set childIndex(t){const{view:e,parentView:s}=this;if(e&&s){const n=s.children[t];n?(this.setAbsolute(n),s.insertBefore(e,n)):s.appendChild(n)}}init(){const{config:t}=this,e=t.view||t.canvas;e?this.__createViewFrom(e):this.__createView();const{style:s}=this.view;if(s.display||(s.display="block"),this.parentView=this.view.parentElement,this.parentView){const n=this.parentView.style;n.webkitUserSelect=n.userSelect="none"}S.syncDomFont&&!this.parentView&&(s.display="none",document.body.appendChild(this.view)),this.__createContext(),this.autoLayout||this.resize(t)}set backgroundColor(t){this.view.style.backgroundColor=t}get backgroundColor(){return this.view.style.backgroundColor}set hittable(t){this.view.style.pointerEvents=t?"auto":"none"}get hittable(){return this.view.style.pointerEvents!=="none"}__createView(){this.view=document.createElement("canvas")}__createViewFrom(t){let e=typeof t=="string"?document.getElementById(t):t;if(e)if(e instanceof HTMLCanvasElement)this.view=e;else{let s=e;if(e===window||e===document){const r=document.createElement("div"),{style:o}=r;o.position="absolute",o.top=o.bottom=o.left=o.right="0px",document.body.appendChild(r),s=r}this.__createView();const n=this.view;s.hasChildNodes()&&(this.setAbsolute(n),s.style.position||(s.style.position="relative")),s.appendChild(n)}else ba.error(`no id: ${t}`),this.__createView()}setAbsolute(t){const{style:e}=t;e.position="absolute",e.top=e.left="0px"}updateViewSize(){const{width:t,height:e,pixelRatio:s}=this,{style:n}=this.view;n.width=t+"px",n.height=e+"px",this.view.width=Math.ceil(t*s),this.view.height=Math.ceil(e*s)}updateClientBounds(){this.clientBounds=this.view.getBoundingClientRect()}startAutoLayout(t,e){if(this.resizeListener=e,t){this.autoBounds=t;try{this.resizeObserver=new ResizeObserver(n=>{this.updateClientBounds();for(const r of n)this.checkAutoBounds(r.contentRect)});const s=this.parentView;s?(this.resizeObserver.observe(s),this.checkAutoBounds(s.getBoundingClientRect())):(this.checkAutoBounds(this.view),ba.warn("no parent"))}catch{this.imitateResizeObserver()}}else window.addEventListener("resize",()=>{const s=S.devicePixelRatio;if(this.pixelRatio!==s){const{width:n,height:r}=this;this.emitResize({width:n,height:r,pixelRatio:s})}})}imitateResizeObserver(){this.autoLayout&&(this.parentView&&this.checkAutoBounds(this.parentView.getBoundingClientRect()),S.requestRender(this.imitateResizeObserver.bind(this)))}checkAutoBounds(t){const e=this.view,{x:s,y:n,width:r,height:o}=this.autoBounds.getBoundsFrom(t),a={width:r,height:o,pixelRatio:S.devicePixelRatio};if(!this.isSameSize(a)){const{style:h}=e;h.marginLeft=s+"px",h.marginTop=n+"px",this.emitResize(a)}}stopAutoLayout(){this.autoLayout=!1,this.resizeListener=null,this.resizeObserver&&(this.resizeObserver.disconnect(),this.resizeObserver=null)}emitResize(t){const e={};_t.copyAttrs(e,this,Qt),this.resize(t),this.resizeListener&&this.width!==void 0&&this.resizeListener(new Ge(t,e))}unrealCanvas(){if(!this.unreal&&this.parentView){const t=this.view;t&&t.remove(),this.view=this.parentView,this.unreal=!0}}destroy(){if(this.view){if(this.stopAutoLayout(),!this.unreal){const t=this.view;t.parentElement&&t.remove()}super.destroy()}}}Bh(CanvasRenderingContext2D.prototype);Bh(Path2D.prototype);const{mineType:qn,fileType:K_}=be;Object.assign(ct,{canvas:(i,t)=>new Yh(i,t),image:i=>new Rh(i)});function X_(i,t){S.origin={createCanvas(e,s){const n=document.createElement("canvas");return n.width=e,n.height=s,n},canvasToDataURL:(e,s,n)=>e.toDataURL(qn(s),n),canvasToBolb:(e,s,n)=>new Promise(r=>e.toBlob(r,qn(s),n)),canvasSaveAs:(e,s,n)=>{const r=e.toDataURL(qn(K_(s)),n);return S.origin.download(r,s)},download(e,s){return new Promise(n=>{let r=document.createElement("a");r.href=e,r.download=s,document.body.appendChild(r),r.click(),document.body.removeChild(r),n()})},loadImage(e){return new Promise((s,n)=>{const r=new Image,{crossOrigin:o}=S.image;o&&(r.setAttribute("crossOrigin",o),r.crossOrigin=o),r.onload=()=>{s(r)},r.onerror=a=>{n(a)},r.src=S.image.getRealURL(e)})}},S.event={stopDefault(e){e.preventDefault()},stopNow(e){e.stopImmediatePropagation()},stop(e){e.stopPropagation()}},S.canvas=ct.canvas(),S.conicGradientSupport=!!S.canvas.context.createConicGradient}S.name="web";S.isMobile="ontouchstart"in window;S.requestRender=function(i){window.requestAnimationFrame(i)};Ii(S,"devicePixelRatio",{get(){return Math.max(1,devicePixelRatio)}});const{userAgent:Ti}=navigator;Ti.indexOf("Firefox")>-1?(S.conicGradientRotate90=!0,S.intWheelDeltaY=!0,S.syncDomFont=!0):Ti.indexOf("Safari")>-1&&Ti.indexOf("Chrome")===-1&&(S.fullImageShadow=!0);Ti.indexOf("Windows")>-1?(S.os="Windows",S.intWheelDeltaY=!0):Ti.indexOf("Mac")>-1?S.os="Mac":Ti.indexOf("Linux")>-1&&(S.os="Linux");class q_{get childrenChanged(){return this.hasAdd||this.hasRemove||this.hasVisible}get updatedList(){if(this.hasRemove){const t=new lt;return this.__updatedList.list.forEach(e=>{e.leafer&&t.add(e)}),t}else return this.__updatedList}constructor(t,e){this.totalTimes=0,this.config={},this.__updatedList=new lt,this.target=t,e&&(this.config=_t.default(e,this.config)),this.__listenEvents()}start(){this.disabled||(this.running=!0)}stop(){this.running=!1}disable(){this.stop(),this.__removeListenEvents(),this.disabled=!0}update(){this.changed=!0,this.running&&this.target.emit(Q.REQUEST)}__onAttrChange(t){this.__updatedList.add(t.target),this.update()}__onChildEvent(t){t.type===ht.ADD?(this.hasAdd=!0,this.__pushChild(t.child)):(this.hasRemove=!0,this.__updatedList.add(t.parent)),this.update()}__pushChild(t){this.__updatedList.add(t),t.isBranch&&this.__loopChildren(t)}__loopChildren(t){const{children:e}=t;for(let s=0,n=e.length;s<n;s++)this.__pushChild(e[s])}__onRquestData(){this.target.emitEvent(new Le(Le.DATA,{updatedList:this.updatedList})),this.__updatedList=new lt,this.totalTimes++,this.changed=!1,this.hasVisible=!1,this.hasRemove=!1,this.hasAdd=!1}__listenEvents(){const{target:t}=this;this.__eventIds=[t.on_(ke.CHANGE,this.__onAttrChange,this),t.on_([ht.ADD,ht.REMOVE],this.__onChildEvent,this),t.on_(Le.REQUEST,this.__onRquestData,this)]}__removeListenEvents(){this.target.off_(this.__eventIds)}destroy(){this.target&&(this.stop(),this.__removeListenEvents(),this.target=null,this.__updatedList=null)}}const{updateAllMatrix:Q_,updateBounds:Ta,updateAllWorldOpacity:J_}=Yt,{pushAllChildBranch:tp,pushAllParent:Sa}=ls;function ep(i,t){let e;i.list.forEach(s=>{e=s.__layout,t.without(s)&&!e.proxyZoom&&(e.matrixChanged?(Q_(s,!0),t.add(s),s.isBranch&&tp(s,t),Sa(s,t)):e.boundsChanged&&(t.add(s),s.isBranch&&(s.__tempNumber=0),Sa(s,t)))})}function ip(i){let t,e,s;i.sort(!0),i.levels.forEach(n=>{t=i.levelMap[n];for(let r=0,o=t.length;r<o;r++){if(e=t[r],e.isBranch&&e.__tempNumber){s=e.children;for(let a=0,h=s.length;a<h;a++)s[a].isBranch||Ta(s[a])}Ta(e)}})}function sp(i){let t;i.list.forEach(e=>{t=e.__layout,t.opacityChanged&&J_(e),t.stateStyleChanged&&setTimeout(()=>t.stateStyleChanged&&e.updateState()),e.__updateChange()})}const{worldBounds:Ca}=Qs,np={x:0,y:0,width:1e5,height:1e5};class Pa{constructor(t){this.updatedBounds=new nt,this.beforeBounds=new nt,this.afterBounds=new nt,t instanceof Array&&(t=new lt(t)),this.updatedList=t}setBefore(){this.beforeBounds.setListWithFn(this.updatedList.list,Ca)}setAfter(){const{list:t}=this.updatedList;t.some(e=>e.noBounds)?this.afterBounds.set(np):this.afterBounds.setListWithFn(t,Ca),this.updatedBounds.setList([this.beforeBounds,this.afterBounds])}merge(t){this.updatedList.addList(t.updatedList.list),this.beforeBounds.add(t.beforeBounds),this.afterBounds.add(t.afterBounds),this.updatedBounds.add(t.updatedBounds)}destroy(){this.updatedList=null}}const{updateAllMatrix:rp,updateAllChange:op}=Yt,Qn=K.get("Layouter");class en{constructor(t,e){this.totalTimes=0,this.config={},this.__levelList=new Mf,this.target=t,e&&(this.config=_t.default(e,this.config)),this.__listenEvents()}start(){this.disabled||(this.running=!0)}stop(){this.running=!1}disable(){this.stop(),this.__removeListenEvents(),this.disabled=!0}layout(){if(!this.running)return;const{target:t}=this;this.times=0;try{t.emit(q.START),this.layoutOnce(),t.emitEvent(new q(q.END,this.layoutedBlocks,this.times))}catch(e){Qn.error(e)}this.layoutedBlocks=null}layoutAgain(){this.layouting?this.waitAgain=!0:this.layoutOnce()}layoutOnce(){if(this.layouting)return Qn.warn("layouting");if(this.times>3)return Qn.warn("layout max times");this.times++,this.totalTimes++,this.layouting=!0,this.target.emit(Le.REQUEST),this.totalTimes>1?this.partLayout():this.fullLayout(),this.layouting=!1,this.waitAgain&&(this.waitAgain=!1,this.layoutOnce())}partLayout(){var t;if(!(!((t=this.__updatedList)===null||t===void 0)&&t.length))return;const e=te.start("PartLayout"),{target:s,__updatedList:n}=this,{BEFORE:r,LAYOUT:o,AFTER:a}=q,h=this.getBlocks(n);h.forEach(l=>l.setBefore()),s.emitEvent(new q(r,h,this.times)),this.extraBlock=null,n.sort(),ep(n,this.__levelList),ip(this.__levelList),sp(n),this.extraBlock&&h.push(this.extraBlock),h.forEach(l=>l.setAfter()),s.emitEvent(new q(o,h,this.times)),s.emitEvent(new q(a,h,this.times)),this.addBlocks(h),this.__levelList.reset(),this.__updatedList=null,te.end(e)}fullLayout(){const t=te.start("FullLayout"),{target:e}=this,{BEFORE:s,LAYOUT:n,AFTER:r}=q,o=this.getBlocks(new lt(e));e.emitEvent(new q(s,o,this.times)),en.fullLayout(e),o.forEach(a=>{a.setAfter()}),e.emitEvent(new q(n,o,this.times)),e.emitEvent(new q(r,o,this.times)),this.addBlocks(o),te.end(t)}static fullLayout(t){rp(t,!0),t.isBranch?ls.updateBounds(t):Yt.updateBounds(t),op(t)}addExtra(t){if(!this.__updatedList.has(t)){const{updatedList:e,beforeBounds:s}=this.extraBlock||(this.extraBlock=new Pa([]));e.length?s.add(t.__world):s.set(t.__world),e.add(t)}}createBlock(t){return new Pa(t)}getBlocks(t){return[this.createBlock(t)]}addBlocks(t){this.layoutedBlocks?this.layoutedBlocks.push(...t):this.layoutedBlocks=t}__onReceiveWatchData(t){this.__updatedList=t.data.updatedList}__listenEvents(){const{target:t}=this;this.__eventIds=[t.on_(q.REQUEST,this.layout,this),t.on_(q.AGAIN,this.layoutAgain,this),t.on_(Le.DATA,this.__onReceiveWatchData,this)]}__removeListenEvents(){this.target.off_(this.__eventIds)}destroy(){this.target&&(this.stop(),this.__removeListenEvents(),this.target=this.config=null)}}const Ze=K.get("Renderer");class ap{get needFill(){return!!(!this.canvas.allowBackgroundColor&&this.config.fill)}constructor(t,e,s){this.FPS=60,this.totalTimes=0,this.times=0,this.config={usePartRender:!0,maxFPS:60},this.target=t,this.canvas=e,s&&(this.config=_t.default(s,this.config)),this.__listenEvents(),this.__requestRender()}start(){this.running=!0}stop(){this.running=!1}update(){this.changed=!0}requestLayout(){this.target.emit(q.REQUEST)}render(t){if(!(this.running&&this.canvas.view)){this.changed=!0;return}const{target:e}=this;this.times=0,this.totalBounds=new nt,Ze.log(e.innerName,"--->");try{e.isApp||e.app.emit(Q.CHILD_START,e),this.emitRender(Q.START),this.renderOnce(t),this.emitRender(Q.END,this.totalBounds),At.clearRecycled()}catch(s){this.rendering=!1,Ze.error(s)}Ze.log("-------------|")}renderAgain(){this.rendering?this.waitAgain=!0:this.renderOnce()}renderOnce(t){if(this.rendering)return Ze.warn("rendering");if(this.times>3)return Ze.warn("render max times");if(this.times++,this.totalTimes++,this.rendering=!0,this.changed=!1,this.renderBounds=new nt,this.renderOptions={},t)this.emitRender(Q.BEFORE),t();else{if(this.requestLayout(),this.ignore){this.ignore=this.rendering=!1;return}this.emitRender(Q.BEFORE),this.config.usePartRender&&this.totalTimes>1?this.partRender():this.fullRender()}this.emitRender(Q.RENDER,this.renderBounds,this.renderOptions),this.emitRender(Q.AFTER,this.renderBounds,this.renderOptions),this.updateBlocks=null,this.rendering=!1,this.waitAgain&&(this.waitAgain=!1,this.renderOnce())}partRender(){const{canvas:t,updateBlocks:e}=this;if(!e)return Ze.warn("PartRender: need update attr");this.mergeBlocks(),e.forEach(s=>{t.bounds.hit(s)&&!s.isEmpty()&&this.clipRender(s)})}clipRender(t){const e=te.start("PartRender"),{canvas:s}=this,n=t.getIntersect(s.bounds),r=t.includes(this.target.__world),o=new nt(n);s.save(),r&&!K.showRepaint?s.clear():(n.spread(10+1/this.canvas.pixelRatio).ceil(),s.clearWorld(n,!0),s.clipWorld(n,!0)),this.__render(n,r,o),s.restore(),te.end(e)}fullRender(){const t=te.start("FullRender"),{canvas:e}=this;e.save(),e.clear(),this.__render(e.bounds,!0),e.restore(),te.end(t)}__render(t,e,s){const n=t.includes(this.target.__world)?{includes:e}:{bounds:t,includes:e};this.needFill&&this.canvas.fillWorld(t,this.config.fill),K.showRepaint&&this.canvas.strokeWorld(t,"red"),this.target.__render(this.canvas,n),this.renderBounds=s=s||t,this.renderOptions=n,this.totalBounds.isEmpty()?this.totalBounds=s:this.totalBounds.add(s),K.showHitView&&this.renderHitView(n),K.showBoundsView&&this.renderBoundsView(n),this.canvas.updateRender(s)}renderHitView(t){}renderBoundsView(t){}addBlock(t){this.updateBlocks||(this.updateBlocks=[]),this.updateBlocks.push(t)}mergeBlocks(){const{updateBlocks:t}=this;if(t){const e=new nt;e.setList(t),t.length=0,t.push(e)}}__requestRender(){const t=Date.now();S.requestRender(()=>{this.FPS=Math.min(60,Math.ceil(1e3/(Date.now()-t))),this.running&&(this.changed&&this.canvas.view&&this.render(),this.target.emit(Q.NEXT)),this.target&&this.__requestRender()})}__onResize(t){if(!this.canvas.unreal){if(t.bigger||!t.samePixelRatio){const{width:e,height:s}=t.old;if(!new nt(0,0,e,s).includes(this.target.__world)||this.needFill||!t.samePixelRatio){this.addBlock(this.canvas.bounds),this.target.forceUpdate("surface");return}}this.addBlock(new nt(0,0,1,1)),this.changed=!0}}__onLayoutEnd(t){t.data&&t.data.map(e=>{let s;e.updatedList&&e.updatedList.list.some(n=>(s=!n.__world.width||!n.__world.height,s&&(n.isLeafer||Ze.tip(n.innerName,": empty"),s=!n.isBranch||n.isBranchLeaf),s)),this.addBlock(s?this.canvas.bounds:e.updatedBounds)})}emitRender(t,e,s){this.target.emitEvent(new Q(t,this.times,e,s))}__listenEvents(){const{target:t}=this;this.__eventIds=[t.on_(Q.REQUEST,this.update,this),t.on_(q.END,this.__onLayoutEnd,this),t.on_(Q.AGAIN,this.renderAgain,this),t.on_(Ge.RESIZE,this.__onResize,this)]}__removeListenEvents(){this.target.off_(this.__eventIds)}destroy(){this.target&&(this.stop(),this.__removeListenEvents(),this.target=this.canvas=this.config=null)}}const{hitRadiusPoint:hp}=O;class lp{constructor(t,e){this.target=t,this.selector=e}getByPoint(t,e,s){e||(e=0),s||(s={});const n=s.through||!1,r=s.ignoreHittable||!1,o=s.target||this.target;this.exclude=s.exclude||null,this.point={x:t.x,y:t.y,radiusX:e,radiusY:e},this.findList=new lt(s.findList),s.findList||this.hitBranch(o);const{list:a}=this.findList,h=this.getBestMatchLeaf(a,s.bottomList,r),l=r?this.getPath(h):this.getHitablePath(h);return this.clear(),n?{path:l,target:h,throughPath:a.length?this.getThroughPath(a):l}:{path:l,target:h}}getBestMatchLeaf(t,e,s){if(t.length){let n;this.findList=new lt;const{x:r,y:o}=this.point,a={x:r,y:o,radiusX:0,radiusY:0};for(let h=0,l=t.length;h<l;h++)if(n=t[h],(s||Yt.worldHittable(n))&&(this.hitChild(n,a),this.findList.length))return this.findList.list[0]}if(e){for(let n=0,r=e.length;n<r;n++)if(this.hitChild(e[n].target,this.point,e[n].proxy),this.findList.length)return this.findList.list[0]}return t[0]}getPath(t){const e=new lt;for(;t;)e.add(t),t=t.parent;return this.target&&e.add(this.target),e}getHitablePath(t){const e=this.getPath(t&&t.hittable?t:null);let s,n=new lt;for(let r=e.list.length-1;r>-1&&(s=e.list[r],!(!s.__.hittable||(n.addAt(s,0),!s.__.hitChildren)));r--);return n}getThroughPath(t){const e=new lt,s=[];for(let a=t.length-1;a>-1;a--)s.push(this.getPath(t[a]));let n,r,o;for(let a=0,h=s.length;a<h;a++){n=s[a],r=s[a+1];for(let l=0,c=n.length;l<c&&(o=n.list[l],!(r&&r.has(o)));l++)e.add(o)}return e}hitBranch(t){this.eachFind(t.children,t.__onlyHitMask)}eachFind(t,e){let s,n;const{point:r}=this,o=t.length;for(let a=o-1;a>-1;a--)s=t[a],!(!s.__.visible||e&&!s.__.mask)&&(n=s.__.hitRadius?!0:hp(s.__world,r),s.isBranch?(n||s.__ignoreHitWorld)&&(this.eachFind(s.children,s.__onlyHitMask),s.isBranchLeaf&&this.hitChild(s,r)):n&&this.hitChild(s,r))}hitChild(t,e,s){if(!(this.exclude&&this.exclude.has(t))&&t.__hitWorld(e)){const{parent:n}=t;if(n&&n.__hasMask&&!t.__.mask&&!n.children.some(r=>r.__.mask&&r.__hitWorld(e)))return;this.findList.add(s||t)}}clear(){this.point=null,this.findList=null,this.exclude=null}destroy(){this.clear()}}const{Yes:cp,NoAndSkip:dp,YesAndSkip:up}=xr,Ba={},Ra={},Ea={};class fp{constructor(t,e){this.config={},this.innerIdMap={},this.idMap={},this.methods={id:(s,n)=>s.id===n?(this.target&&(this.idMap[n]=s),1):0,innerId:(s,n)=>s.innerId===n?(this.target&&(this.innerIdMap[n]=s),1):0,className:(s,n)=>s.className===n?1:0,tag:(s,n)=>s.__tag===n?1:0,tags:(s,n)=>n[s.__tag]?1:0},this.target=t,e&&(this.config=_t.default(e,this.config)),this.picker=new lp(t,this),t&&this.__listenEvents()}getBy(t,e,s,n){switch(typeof t){case"number":const r=this.getByInnerId(t,e);return s?r:r?[r]:[];case"string":switch(t[0]){case"#":Ba.id=t.substring(1),t=Ba;break;case".":Ra.className=t.substring(1),t=Ra;break;default:Ea.tag=t,t=Ea}case"object":if(t.id!==void 0){const o=this.getById(t.id,e);return s?o:o?[o]:[]}else if(t.tag){const{tag:o}=t,a=o instanceof Array;return this.getByMethod(a?this.methods.tags:this.methods.tag,e,s,a?_t.toMap(o):o)}else return this.getByMethod(this.methods.className,e,s,t.className);case"function":return this.getByMethod(t,e,s,n)}}getByPoint(t,e,s){return S.name==="node"&&this.target&&this.target.emit(q.CHECK_UPDATE),this.picker.getByPoint(t,e,s)}getByInnerId(t,e){const s=this.innerIdMap[t];return s||(this.eachFind(this.toChildren(e),this.methods.innerId,null,t),this.findLeaf)}getById(t,e){const s=this.idMap[t];return s&&Yt.hasParent(s,e||this.target)?s:(this.eachFind(this.toChildren(e),this.methods.id,null,t),this.findLeaf)}getByClassName(t,e){return this.getByMethod(this.methods.className,e,!1,t)}getByTag(t,e){return this.getByMethod(this.methods.tag,e,!1,t)}getByMethod(t,e,s,n){const r=s?null:[];return this.eachFind(this.toChildren(e),t,r,n),r||this.findLeaf}eachFind(t,e,s,n){let r,o;for(let a=0,h=t.length;a<h;a++){if(r=t[a],o=e(r,n),o===cp||o===up)if(s)s.push(r);else{this.findLeaf=r;return}r.isBranch&&o<dp&&this.eachFind(r.children,e,s,n)}}toChildren(t){return this.findLeaf=null,[t||this.target]}__onRemoveChild(t){const{id:e,innerId:s}=t.child;this.idMap[e]&&delete this.idMap[e],this.innerIdMap[s]&&delete this.innerIdMap[s]}__checkIdChange(t){if(t.attrName==="id"){const e=t.oldValue;this.idMap[e]&&delete this.idMap[e]}}__listenEvents(){this.__eventIds=[this.target.on_(ht.REMOVE,this.__onRemoveChild,this),this.target.on_(ke.CHANGE,this.__checkIdChange,this)]}__removeListenEvents(){this.target.off_(this.__eventIds),this.__eventIds.length=0}destroy(){this.__eventIds.length&&(this.__removeListenEvents(),this.picker.destroy(),this.findLeaf=null,this.innerIdMap={},this.idMap={})}}Object.assign(ct,{watcher:(i,t)=>new q_(i,t),layouter:(i,t)=>new en(i,t),renderer:(i,t,e)=>new ap(i,t,e),selector:(i,t)=>new fp(i,t)});S.layout=en.fullLayout;const It={convert(i,t){const e=ie.getBase(i),s=Object.assign(Object.assign({},e),{x:t.x,y:t.y,width:i.width,height:i.height,pointerType:i.pointerType,pressure:i.pressure});return s.pointerType==="pen"&&(s.tangentialPressure=i.tangentialPressure,s.tiltX=i.tiltX,s.tiltY=i.tiltY,s.twist=i.twist),s},convertMouse(i,t){const e=ie.getBase(i);return Object.assign(Object.assign({},e),{x:t.x,y:t.y,width:1,height:1,pointerType:"mouse",pressure:.5})},convertTouch(i,t){const e=It.getTouch(i),s=ie.getBase(i);return Object.assign(Object.assign({},s),{x:t.x,y:t.y,width:1,height:1,pointerType:"touch",multiTouch:i.touches.length>1,pressure:e.force})},getTouch(i){return i.targetTouches[0]||i.changedTouches[0]}},Oa={getMove(i,t){let{moveSpeed:e}=t,{deltaX:s,deltaY:n}=i;return i.shiftKey&&!s&&(s=n,n=0),s>50&&(s=Math.max(50,s/3)),n>50&&(n=Math.max(50,n/3)),{x:-s*e*2,y:-n*e*2}},getScale(i,t){let e,s=1,{zoomMode:n,zoomSpeed:r}=t;const o=i.deltaY||i.deltaX;if(n?(e=n==="mouse"?!0:!i.deltaX&&(S.intWheelDeltaY?Math.abs(o)>17:Math.ceil(o)!==o),(i.shiftKey||i.metaKey||i.ctrlKey)&&(e=!0)):e=!i.shiftKey&&(i.metaKey||i.ctrlKey),e){r=bt.within(r,0,1);const a=i.deltaY?t.delta.y:t.delta.x;s=1-o/(a*4)*r,s<.5&&(s=.5),s>=1.5&&(s=1.5)}return s}},Ia={convert(i){const t=ie.getBase(i);return Object.assign(Object.assign({},t),{code:i.code,key:i.key})}},{getMoveEventData:_p,getZoomEventData:Ma,getRotateEventData:pp,pathCanDrag:gp}=ie;class yp extends N_{__listenEvents(){super.__listenEvents();const t=this.view=this.canvas.view;this.viewEvents={pointerdown:this.onPointerDown,mousedown:this.onMouseDown,touchstart:this.onTouchStart,contextmenu:this.onContextMenu,wheel:this.onWheel,gesturestart:this.onGesturestart,gesturechange:this.onGesturechange,gestureend:this.onGestureend},this.windowEvents={pointermove:this.onPointerMove,pointerup:this.onPointerUp,pointercancel:this.onPointerCancel,mousemove:this.onMouseMove,mouseup:this.onMouseUp,touchmove:this.onTouchMove,touchend:this.onTouchEnd,touchcancel:this.onTouchCancel,keydown:this.onKeyDown,keyup:this.onKeyUp,scroll:this.onScroll};const{viewEvents:e,windowEvents:s}=this;for(let n in e)e[n]=e[n].bind(this),t.addEventListener(n,e[n]);for(let n in s)s[n]=s[n].bind(this),window.addEventListener(n,s[n])}__removeListenEvents(){super.__removeListenEvents();const{viewEvents:t,windowEvents:e}=this;for(let s in t)this.view.removeEventListener(s,t[s]),this.viewEvents={};for(let s in e)window.removeEventListener(s,e[s]),this.windowEvents={}}getTouches(t){const e=[];for(let s=0,n=t.length;s<n;s++)e.push(t[s]);return e}preventDefaultPointer(t){const{pointer:e}=this.config;e.preventDefault&&t.preventDefault()}preventDefaultWheel(t){const{wheel:e}=this.config;e.preventDefault&&t.preventDefault()}preventWindowPointer(t){return!this.downData&&t.target!==this.view}onKeyDown(t){this.keyDown(Ia.convert(t))}onKeyUp(t){this.keyUp(Ia.convert(t))}onContextMenu(t){this.config.pointer.preventDefaultMenu&&t.preventDefault(),this.menu(It.convert(t,this.getLocal(t)))}onScroll(){this.canvas.updateClientBounds()}onPointerDown(t){this.preventDefaultPointer(t),!(this.config.pointer.touch||this.useMultiTouch)&&(this.usePointer||(this.usePointer=!0),this.pointerDown(It.convert(t,this.getLocal(t))))}onPointerMove(t){this.config.pointer.touch||this.useMultiTouch||this.preventWindowPointer(t)||(this.usePointer||(this.usePointer=!0),this.pointerMove(It.convert(t,this.getLocal(t,!0))))}onPointerUp(t){this.downData&&this.preventDefaultPointer(t),!(this.config.pointer.touch||this.useMultiTouch||this.preventWindowPointer(t))&&this.pointerUp(It.convert(t,this.getLocal(t)))}onPointerCancel(){this.useMultiTouch||this.pointerCancel()}onMouseDown(t){this.preventDefaultPointer(t),!(this.useTouch||this.usePointer)&&this.pointerDown(It.convertMouse(t,this.getLocal(t)))}onMouseMove(t){this.useTouch||this.usePointer||this.preventWindowPointer(t)||this.pointerMove(It.convertMouse(t,this.getLocal(t,!0)))}onMouseUp(t){this.downData&&this.preventDefaultPointer(t),!(this.useTouch||this.usePointer||this.preventWindowPointer(t))&&this.pointerUp(It.convertMouse(t,this.getLocal(t)))}onMouseCancel(){this.useTouch||this.usePointer||this.pointerCancel()}onTouchStart(t){const e=It.getTouch(t),s=this.getLocal(e,!0),{preventDefault:n}=this.config.touch;(n===!0||n==="auto"&&gp(this.findPath(s)))&&t.preventDefault(),this.multiTouchStart(t),!this.usePointer&&(this.touchTimer&&(window.clearTimeout(this.touchTimer),this.touchTimer=0),this.useTouch=!0,this.pointerDown(It.convertTouch(t,s)))}onTouchMove(t){if(this.multiTouchMove(t),this.usePointer||this.preventWindowPointer(t))return;const e=It.getTouch(t);this.pointerMove(It.convertTouch(t,this.getLocal(e)))}onTouchEnd(t){if(this.multiTouchEnd(),this.usePointer||this.preventWindowPointer(t))return;this.touchTimer&&clearTimeout(this.touchTimer),this.touchTimer=setTimeout(()=>{this.useTouch=!1},500);const e=It.getTouch(t);this.pointerUp(It.convertTouch(t,this.getLocal(e)))}onTouchCancel(){this.usePointer||this.pointerCancel()}multiTouchStart(t){this.useMultiTouch=t.touches.length>1,this.touches=this.useMultiTouch?this.getTouches(t.touches):void 0,this.useMultiTouch&&this.pointerCancel()}multiTouchMove(t){if(this.useMultiTouch&&t.touches.length>1){const e=this.getTouches(t.touches),s=this.getKeepTouchList(this.touches,e);s.length>1&&(this.multiTouch(ie.getBase(t),s),this.touches=e)}}multiTouchEnd(){this.touches=null,this.useMultiTouch=!1,this.transformEnd()}getKeepTouchList(t,e){let s;const n=[];return t.forEach(r=>{s=e.find(o=>o.identifier===r.identifier),s&&n.push({from:this.getLocal(r),to:this.getLocal(s)})}),n}getLocalTouchs(t){return t.map(e=>this.getLocal(e))}onWheel(t){this.preventDefaultWheel(t);const{wheel:e}=this.config;if(e.disabled)return;const s=e.getScale?e.getScale(t,e):Oa.getScale(t,e),n=this.getLocal(t),r=ie.getBase(t);s!==1?this.zoom(Ma(n,s,r)):this.move(_p(n,e.getMove?e.getMove(t,e):Oa.getMove(t,e),r))}onGesturestart(t){this.useMultiTouch||(this.preventDefaultWheel(t),this.lastGestureScale=1,this.lastGestureRotation=0)}onGesturechange(t){if(this.useMultiTouch)return;this.preventDefaultWheel(t);const e=this.getLocal(t),s=ie.getBase(t),n=t.scale/this.lastGestureScale,r=t.rotation-this.lastGestureRotation;let{rotateSpeed:o}=this.config.wheel;o=bt.within(o,0,1),this.zoom(Ma(e,n*n,s)),this.rotate(pp(e,r/Math.PI*180*(o/4+.1),s)),this.lastGestureScale=t.scale,this.lastGestureRotation=t.rotation}onGestureend(t){this.useMultiTouch||(this.preventDefaultWheel(t),this.transformEnd())}setCursor(t){super.setCursor(t);const e=[];this.eachCursor(t,e),typeof e[e.length-1]=="object"&&e.push("default"),this.canvas.view.style.cursor=e.map(s=>typeof s=="object"?`url(${s.url}) ${s.x||0} ${s.y||0}`:s).join(",")}eachCursor(t,e,s=0){if(s++,t instanceof Array)t.forEach(n=>this.eachCursor(n,e,s));else{const n=typeof t=="string"&&Fh.get(t);n&&s<2?this.eachCursor(n,e,s):e.push(t)}}destroy(){this.view&&(super.destroy(),this.view=null,this.touches=null)}}function Si(i,t){let e;const{rows:s,decorationY:n,decorationHeight:r}=i.__.__textDrawData;for(let o=0,a=s.length;o<a;o++)e=s[o],e.text?t.fillText(e.text,e.x,e.y):e.data&&e.data.forEach(h=>{t.fillText(h.char,h.x,e.y)}),n&&t.fillRect(e.x,e.y+n,e.width,r)}function mp(i,t,e){e.fillStyle=i,t.__.__font?Si(t,e):t.__.windingRule?e.fill(t.__.windingRule):e.fill()}function xp(i,t,e){let s;const{windingRule:n,__font:r}=t.__;for(let o=0,a=i.length;o<a;o++)s=i[o],!(s.image&&si.checkImage(t,e,s,!r))&&s.style&&(e.fillStyle=s.style,s.transform?(e.save(),e.transform(s.transform),s.blendMode&&(e.blendMode=s.blendMode),r?Si(t,e):n?e.fill(n):e.fill(),e.restore()):s.blendMode?(e.saveBlendMode(s.blendMode),r?Si(t,e):n?e.fill(n):e.fill(),e.restoreBlendMode()):r?Si(t,e):n?e.fill(n):e.fill())}function Hr(i,t,e){const{strokeAlign:s}=t.__,n=typeof i!="string";switch(s){case"center":e.setStroke(n?void 0:i,t.__.strokeWidth,t.__),n?Ji(i,!0,t,e):ns(t,e);break;case"inside":Aa("inside",i,n,t,e);break;case"outside":Aa("outside",i,n,t,e);break}}function Aa(i,t,e,s,n){const{__strokeWidth:r,__font:o}=s.__,a=n.getSameCanvas(!0,!0);a.setStroke(e?void 0:t,r*2,s.__),a.font=o,e?Ji(t,!0,s,a):ns(s,a),a.blendMode=i==="outside"?"destination-out":"destination-in",Si(s,a),a.blendMode="normal",s.__worldFlipped?n.copyWorldByReset(a,s.__nowWorld):n.copyWorldToInner(a,s.__nowWorld,s.__layout.renderBounds),a.recycle(s.__nowWorld)}function ns(i,t){let e;const{rows:s,decorationY:n,decorationHeight:r}=i.__.__textDrawData;for(let o=0,a=s.length;o<a;o++)e=s[o],e.text?t.strokeText(e.text,e.x,e.y):e.data&&e.data.forEach(h=>{t.strokeText(h.char,h.x,e.y)}),n&&t.strokeRect(e.x,e.y+n,e.width,r)}function Ji(i,t,e,s){let n;for(let r=0,o=i.length;r<o;r++)n=i[r],!(n.image&&si.checkImage(e,s,n,!1))&&n.style&&(s.strokeStyle=n.style,n.blendMode?(s.saveBlendMode(n.blendMode),t?ns(e,s):s.stroke(),s.restoreBlendMode()):t?ns(e,s):s.stroke())}function wp(i,t,e){const s=t.__,{__strokeWidth:n,strokeAlign:r,__font:o}=s;if(n)if(o)Hr(i,t,e);else switch(r){case"center":e.setStroke(i,n,s),e.stroke(),s.__useArrow&&Zh(t,e);break;case"inside":e.save(),e.setStroke(i,n*2,s),s.windingRule?e.clip(s.windingRule):e.clip(),e.stroke(),e.restore();break;case"outside":const a=e.getSameCanvas(!0,!0);a.setStroke(i,n*2,s),t.__drawRenderPath(a),a.stroke(),s.windingRule?a.clip(s.windingRule):a.clip(),a.clearWorld(t.__layout.renderBounds),t.__worldFlipped?e.copyWorldByReset(a,t.__nowWorld):e.copyWorldToInner(a,t.__nowWorld,t.__layout.renderBounds),a.recycle(t.__nowWorld);break}}function vp(i,t,e){const s=t.__,{__strokeWidth:n,strokeAlign:r,__font:o}=s;if(n)if(o)Hr(i,t,e);else switch(r){case"center":e.setStroke(void 0,n,s),Ji(i,!1,t,e),s.__useArrow&&Zh(t,e);break;case"inside":e.save(),e.setStroke(void 0,n*2,s),s.windingRule?e.clip(s.windingRule):e.clip(),Ji(i,!1,t,e),e.restore();break;case"outside":const{renderBounds:a}=t.__layout,h=e.getSameCanvas(!0,!0);t.__drawRenderPath(h),h.setStroke(void 0,n*2,s),Ji(i,!1,t,h),s.windingRule?h.clip(s.windingRule):h.clip(),h.clearWorld(a),t.__worldFlipped?e.copyWorldByReset(h,t.__nowWorld):e.copyWorldToInner(h,t.__nowWorld,a),h.recycle(t.__nowWorld);break}}function Zh(i,t){i.__.dashPattern&&(t.beginPath(),i.__drawPathByData(t,i.__.__pathForArrow),t.dashPattern=null,t.stroke())}const{getSpread:kp,getOuterOf:bp,getByMove:Tp,getIntersectData:Sp}=O;function Cp(i,t,e){const s=t.getSameCanvas(),n=i.__nowWorld;let r,o,a,h,{scaleX:l,scaleY:c}=n;if(l<0&&(l=-l),c<0&&(c=-c),t.bounds.includes(n))h=s,r=a=n;else{const{renderShapeSpread:p}=i.__layout,f=Sp(p?kp(t.bounds,l===c?p*l:[p*c,p*l]):t.bounds,n);o=t.bounds.getFitMatrix(f);let{a:d,d:u}=o;if(o.a<1&&(h=t.getSameCanvas(),i.__renderShape(h,e),l*=d,c*=u),a=bp(n,o),r=Tp(a,-o.e,-o.f),e.matrix){const{matrix:y}=e;o.multiply(y),d*=y.scaleX,u*=y.scaleY}e=Object.assign(Object.assign({},e),{matrix:o.withScale(d,u)})}return i.__renderShape(s,e),{canvas:s,matrix:o,bounds:r,worldCanvas:h,shapeBounds:a,scaleX:l,scaleY:c}}let Pr;function Pp(i,t){const e=t.__,s=[];let n=e.__input[i],r;n instanceof Array||(n=[n]),Pr=si.recycleImage(i,e);for(let o=0,a=n.length,h;o<a;o++)h=Bp(i,n[o],t),h&&s.push(h);e["_"+i]=s.length?s:void 0,s.length&&s[0].image&&(r=s[0].image.hasOpacityPixel),i==="fill"?e.__pixelFill=r:e.__pixelStroke=r}function Bp(i,t,e){if(typeof t!="object"||t.visible===!1||t.opacity===0)return;const{boxBounds:s}=e.__layout;switch(t.type){case"solid":let{type:n,blendMode:r,color:o,opacity:a}=t;return{type:n,blendMode:r,style:ii.string(o,a)};case"image":return si.image(e,i,t,s,!Pr||!Pr[t.url]);case"linear":return Ls.linearGradient(t,s);case"radial":return Ls.radialGradient(t,s);case"angular":return Ls.conicGradient(t,s);default:return t.r!==void 0?{type:"solid",style:ii.string(t)}:void 0}}const Rp={compute:Pp,fill:mp,fills:xp,fillText:Si,stroke:wp,strokes:vp,strokeText:Hr,drawTextStroke:ns,shape:Cp};let Hi={};const{get:jr,rotateOfOuter:Kh,translate:vi,scaleOfOuter:Ep,scale:Xh,rotate:qh}=z;function Qh(i,t,e,s,n,r,o){const a=jr();vi(a,t.x+e,t.y+s),Xh(a,n,r),o&&Kh(a,{x:t.x+t.width/2,y:t.y+t.height/2},o),i.transform=a}function Jh(i,t,e,s,n,r,o){const a=jr();vi(a,t.x+e,t.y+s),n&&Xh(a,n,r),o&&qh(a,o),i.transform=a}function tl(i,t,e,s,n,r,o,a,h,l){const c=jr();if(h)if(l==="center")Kh(c,{x:e/2,y:s/2},h);else switch(qh(c,h),h){case 90:vi(c,s,0);break;case 180:vi(c,e,s);break;case 270:vi(c,0,e);break}Hi.x=t.x+n,Hi.y=t.y+r,vi(c,Hi.x,Hi.y),o&&Ep(c,Hi,o,a),i.transform=c}const{get:Op,translate:Ip}=z,Mp=new nt,Jn={},tr={};function el(i,t,e,s){const{blendMode:n,sync:r}=e;n&&(i.blendMode=n),r&&(i.sync=r),i.data=il(e,s,t)}function il(i,t,e){let{width:s,height:n}=e;i.padding&&(t=Mp.set(t).shrink(i.padding)),i.mode==="strench"&&(i.mode="stretch");const{opacity:r,mode:o,align:a,offset:h,scale:l,size:c,rotation:p,repeat:f}=i,d=t.width===s&&t.height===n,u={mode:o},y=a!=="center"&&(p||0)%180===90,v=y?n:s,C=y?s:n;let m=0,I=0,T,L;if(!o||o==="cover"||o==="fit"){if(!d||p){const W=t.width/v,M=t.height/C;T=L=o==="fit"?Math.min(W,M):Math.max(W,M),m+=(t.width-s*T)/2,I+=(t.height-n*L)/2}}else(l||c)&&(bt.getScaleData(l,c,e,tr),T=tr.scaleX,L=tr.scaleY);if(a){const W={x:m,y:I,width:v,height:C};T&&(W.width*=T,W.height*=L),yh.toPoint(a,W,t,Jn,!0),m+=Jn.x,I+=Jn.y}switch(h&&(m+=h.x,I+=h.y),o){case"stretch":d||(s=t.width,n=t.height);break;case"normal":case"clip":(m||I||T||p)&&Jh(u,t,m,I,T,L,p);break;case"repeat":(!d||T||p)&&tl(u,t,s,n,m,I,T,L,p,a),f||(u.repeat="repeat");break;case"fit":case"cover":default:T&&Qh(u,t,m,I,T,L,p)}return u.transform||(t.x||t.y)&&(u.transform=Op(),Ip(u.transform,t.x,t.y)),T&&o!=="stretch"&&(u.scaleX=T,u.scaleY=L),u.width=s,u.height=n,r&&(u.opacity=r),f&&(u.repeat=typeof f=="string"?f==="x"?"repeat-x":"repeat-y":"repeat"),u}let ji,Ap=new nt;const{isSame:Dp}=O;function Lp(i,t,e,s,n){let r,o;const a=At.get(e);return ji&&e===ji.paint&&Dp(s,ji.boxBounds)?r=ji.leafPaint:(r={type:e.type,image:a},ji=a.use>1?{leafPaint:r,paint:e,boxBounds:Ap.set(s)}:null),(n||a.loading)&&(o={image:a,attrName:t,attrValue:e}),a.ready?(Da(i,t,e,a,r,s),n&&(La(i,o),Wa(i,o))):a.error?n&&za(i,o,a.error):(n&&(er(i,!0),La(i,o)),r.loadId=a.load(()=>{er(i,!1),i.destroyed||(Da(i,t,e,a,r,s)&&(a.hasOpacityPixel&&(i.__layout.hitCanvasChanged=!0),i.forceUpdate("surface")),Wa(i,o)),r.loadId=null},h=>{er(i,!1),za(i,o,h),r.loadId=null})),r}function Da(i,t,e,s,n,r){if(t==="fill"&&!i.__.__naturalWidth){const o=i.__;if(o.__naturalWidth=s.width/o.pixelRatio,o.__naturalHeight=s.height/o.pixelRatio,o.__autoSide)return i.forceUpdate("width"),i.__proxyData&&(i.setProxyAttr("width",o.width),i.setProxyAttr("height",o.height)),!1}return n.data||el(n,s,e,r),!0}function La(i,t){Vr(i,Zt.LOAD,t)}function Wa(i,t){Vr(i,Zt.LOADED,t)}function za(i,t,e){t.error=e,i.forceUpdate("surface"),Vr(i,Zt.ERROR,t)}function Vr(i,t,e){i.hasEvent(t)&&i.emitEvent(new Zt(t,e))}function er(i,t){const{leafer:e}=i;e&&e.viewReady&&(e.renderer.ignore=t)}const{get:$a,scale:Ua,copy:Fa}=z,{ceil:Na,abs:Ga}=Math;function Br(i,t,e){let{scaleX:s,scaleY:n}=At.patternLocked?i.__world:i.__nowWorld;const r=s+"-"+n+"-"+e;if(t.patternId!==r&&!i.destroyed){s=Ga(s),n=Ga(n);const{image:o,data:a}=t;let h,l,{width:c,height:p,scaleX:f,scaleY:d,opacity:u,transform:y,repeat:v}=a;f&&(l=$a(),Fa(l,y),Ua(l,1/f,1/d),s*=f,n*=d),s*=e,n*=e,c*=s,p*=n;const C=c*p;if(!v&&C>S.image.maxCacheSize)return!1;let m=S.image.maxPatternSize;if(!o.isSVG){const L=o.width*o.height;m>L&&(m=L)}C>m&&(h=Math.sqrt(C/m)),h&&(s/=h,n/=h,c/=h,p/=h),f&&(s/=f,n/=d),(y||s!==1||n!==1)&&(l||(l=$a(),y&&Fa(l,y)),Ua(l,1/s,1/n));const I=o.getCanvas(Na(c)||1,Na(p)||1,u),T=o.getPattern(I,v||S.origin.noRepeat||"no-repeat",l,t);return t.style=T,t.patternId=r,!0}else return!1}function Yr(i,t,e,s){function n(r){return r instanceof e?r:new e(function(o){o(r)})}return new(e||(e=Promise))(function(r,o){function a(c){try{l(s.next(c))}catch(p){o(p)}}function h(c){try{l(s.throw(c))}catch(p){o(p)}}function l(c){c.done?r(c.value):n(c.value).then(a,h)}l((s=s.apply(i,[])).next())})}const{abs:Ha}=Math;function Wp(i,t,e,s){const{scaleX:n,scaleY:r}=At.patternLocked?i.__world:i.__nowWorld,{pixelRatio:o}=t;if(!e.data||e.patternId===n+"-"+r+"-"+o&&!bi.running)return!1;{const{data:a}=e;if(s)if(a.repeat)s=!1;else{let{width:h,height:l}=a;h*=Ha(n)*o,l*=Ha(r)*o,a.scaleX&&(h*=a.scaleX,l*=a.scaleY),s=h*l>S.image.maxCacheSize||bi.running}return s?(t.save(),i.windingRule?t.clip(i.windingRule):t.clip(),e.blendMode&&(t.blendMode=e.blendMode),a.opacity&&(t.opacity*=a.opacity),a.transform&&t.transform(a.transform),t.drawImage(e.image.view,0,0,a.width,a.height),t.restore(),!0):(!e.style||e.sync||bi.running?Br(i,e,o):e.patternTask||(e.patternTask=At.patternTasker.add(()=>Yr(this,void 0,void 0,function*(){e.patternTask=null,t.bounds.hit(i.__nowWorld)&&Br(i,e,o),i.forceUpdate("surface")}),300)),!1)}}function zp(i,t){const e=t["_"+i];if(e instanceof Array){let s,n,r,o;for(let a=0,h=e.length;a<h;a++)s=e[a].image,o=s&&s.url,o&&(n||(n={}),n[o]=!0,At.recycle(s),s.loading&&(r||(r=t.__input&&t.__input[i]||[],r instanceof Array||(r=[r])),s.unload(e[a].loadId,!r.some(l=>l.url===o))));return n}return null}const $p={image:Lp,checkImage:Wp,createPattern:Br,recycleImage:zp,createData:el,getPatternData:il,fillOrFitMode:Qh,clipMode:Jh,repeatMode:tl},{toPoint:ja}=Oi,ir={},sr={};function Up(i,t){let{from:e,to:s,type:n,blendMode:r,opacity:o}=i;ja(e||"top",t,ir),ja(s||"bottom",t,sr);const a=S.canvas.createLinearGradient(ir.x,ir.y,sr.x,sr.y);Zr(a,i.stops,o);const h={type:n,style:a};return r&&(h.blendMode=r),h}function Zr(i,t,e){if(t){let s;for(let n=0,r=t.length;n<r;n++)s=t[n],typeof s=="string"?i.addColorStop(n/(r-1),ii.string(s,e)):i.addColorStop(s.offset,ii.string(s.color,e))}}const{getAngle:Fp,getDistance:Np}=D,{get:Gp,rotateOfOuter:Va,scaleOfOuter:Ya}=z,{toPoint:Za}=Oi,Ke={},nr={};function Hp(i,t){let{from:e,to:s,type:n,opacity:r,blendMode:o,stretch:a}=i;Za(e||"center",t,Ke),Za(s||"bottom",t,nr);const h=S.canvas.createRadialGradient(Ke.x,Ke.y,0,Ke.x,Ke.y,Np(Ke,nr));Zr(h,i.stops,r);const l={type:n,style:h},c=Kr(t,Ke,nr,a,!0);return c&&(l.transform=c),o&&(l.blendMode=o),l}function Kr(i,t,e,s,n){let r;const{width:o,height:a}=i;if(o!==a||s){const h=Fp(t,e);r=Gp(),n?(Ya(r,t,o/a*(s||1),1),Va(r,t,h+90)):(Ya(r,t,1,o/a*(s||1)),Va(r,t,h))}return r}const{getDistance:jp}=D,{toPoint:Ka}=Oi,me={},rr={};function Vp(i,t){let{from:e,to:s,type:n,opacity:r,blendMode:o,stretch:a}=i;Ka(e||"center",t,me),Ka(s||"bottom",t,rr);const h=S.conicGradientSupport?S.canvas.createConicGradient(0,me.x,me.y):S.canvas.createRadialGradient(me.x,me.y,0,me.x,me.y,jp(me,rr));Zr(h,i.stops,r);const l={type:n,style:h},c=Kr(t,me,rr,a||1,S.conicGradientRotate90);return c&&(l.transform=c),o&&(l.blendMode=o),l}const Yp={linearGradient:Up,radialGradient:Hp,conicGradient:Vp,getTransform:Kr},{copy:Xa,toOffsetOutBounds:Zp}=O,Ot={},Os={};function Kp(i,t,e){let s,n;const{__nowWorld:r,__layout:o}=i,{shadow:a}=i.__,{worldCanvas:h,bounds:l,shapeBounds:c,scaleX:p,scaleY:f}=e,d=t.getSameCanvas(),u=a.length-1;Zp(l,Os),a.forEach((y,v)=>{d.setWorldShadow(Os.offsetX+y.x*p,Os.offsetY+y.y*f,y.blur*p,y.color),n=y.spread?1+y.spread*2/(o.boxBounds.width+(o.strokeBoxSpread||0)*2):0,sl(d,Os,n,e),s=l,y.box&&(d.restore(),d.save(),h&&(d.copyWorld(d,l,r,"copy"),s=r),h?d.copyWorld(h,r,r,"destination-out"):d.copyWorld(e.canvas,c,l,"destination-out")),i.__worldFlipped?t.copyWorldByReset(d,s,r,y.blendMode):t.copyWorldToInner(d,s,o.renderBounds,y.blendMode),u&&v<u&&d.clearWorld(s,!0)}),d.recycle(s)}function sl(i,t,e,s){const{bounds:n,shapeBounds:r}=s;if(S.fullImageShadow){if(Xa(Ot,i.bounds),Ot.x+=t.x-r.x,Ot.y+=t.y-r.y,e){const{matrix:o}=s;Ot.x-=(n.x+(o?o.e:0)+n.width/2)*(e-1),Ot.y-=(n.y+(o?o.f:0)+n.height/2)*(e-1),Ot.width*=e,Ot.height*=e}i.copyWorld(s.canvas,i.bounds,Ot)}else e&&(Xa(Ot,t),Ot.x-=t.width/2*(e-1),Ot.y-=t.height/2*(e-1),Ot.width*=e,Ot.height*=e),i.copyWorld(s.canvas,r,e?Ot:t)}const{toOffsetOutBounds:Xp}=O,Is={};function qp(i,t,e){let s,n;const{__nowWorld:r,__layout:o}=i,{innerShadow:a}=i.__,{worldCanvas:h,bounds:l,shapeBounds:c,scaleX:p,scaleY:f}=e,d=t.getSameCanvas(),u=a.length-1;Xp(l,Is),a.forEach((y,v)=>{d.save(),d.setWorldShadow(Is.offsetX+y.x*p,Is.offsetY+y.y*f,y.blur*p),n=y.spread?1-y.spread*2/(o.boxBounds.width+(o.strokeBoxSpread||0)*2):0,sl(d,Is,n,e),d.restore(),h?(d.copyWorld(d,l,r,"copy"),d.copyWorld(h,r,r,"source-out"),s=r):(d.copyWorld(e.canvas,c,l,"source-out"),s=l),d.fillWorld(s,y.color,"source-in"),i.__worldFlipped?t.copyWorldByReset(d,s,r,y.blendMode):t.copyWorldToInner(d,s,o.renderBounds,y.blendMode),u&&v<u&&d.clearWorld(s,!0)}),d.recycle(s)}function Qp(i,t,e){const{blur:s}=i.__;e.setWorldBlur(s*i.__nowWorld.a),e.copyWorldToInner(t,i.__nowWorld,i.__layout.renderBounds),e.filter="none"}function Jp(i,t,e){}const t0={shadow:Kp,innerShadow:qp,blur:Qp,backgroundBlur:Jp},{excludeRenderBounds:e0}=Qs;Bt.prototype.__renderMask=function(i,t){let e,s,n,r,o,a;const{children:h}=this;for(let l=0,c=h.length;l<c;l++)e=h[l],a=e.__.mask,!(a&&(o&&(qa(this,o,i,n,s,r),s=n=null),a==="path"||a==="clipping-path"?(e.opacity<1?(o="opacity-path",r=e.opacity,n||(n=or(i))):(o="path",i.save()),e.__clip(n||i,t)):(o=a==="grayscale"?"grayscale":"alpha",s||(s=or(i)),n||(n=or(i)),e.__render(s,t)),!(a==="clipping"||a==="clipping-path")))&&(e0(e,t)||e.__render(n||i,t));qa(this,o,i,n,s,r)};function qa(i,t,e,s,n,r){switch(t){case"grayscale":n.useGrayscaleAlpha(i.__nowWorld);case"alpha":i0(i,e,s,n);break;case"opacity-path":nl(i,e,s,r);break;case"path":e.restore()}}function or(i){return i.getSameCanvas(!1,!0)}function i0(i,t,e,s){const n=i.__nowWorld;e.resetTransform(),e.opacity=1,e.useMask(s,n),s.recycle(n),nl(i,t,e,1)}function nl(i,t,e,s){const n=i.__nowWorld;t.resetTransform(),t.opacity=s,t.copyWorld(e,n),e.recycle(n)}const s0="¥￥＄€£￡¢￠",n0="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789abcdefghijklmnopqrstuvwxyz",r0="《（「〈『〖【〔｛┌＜‘“＝"+s0,o0="》）」〉』〗】〕｝┐＞’”！？，、。：；‰",a0="≮≯≈≠＝…",h0="—／～｜┆·",l0=`{[(<'"`+r0,rl=`>)]}%!?,.:;'"`+o0,c0=rl+"_#~&*+\\=|"+a0,d0="- "+h0,u0=[[19968,40959],[13312,19903],[131072,173791],[173824,177983],[177984,178207],[178208,183983],[183984,191471],[196608,201551],[201552,205743],[11904,12031],[12032,12255],[12272,12287],[12288,12351],[12736,12783],[12800,13055],[13056,13311],[63744,64255],[65072,65103],[127488,127743],[194560,195103]],f0=new RegExp(u0.map(([i,t])=>`[\\u${i.toString(16)}-\\u${t.toString(16)}]`).join("|"));function fs(i){const t={};return i.split("").forEach(e=>t[e]=!0),t}const _0=fs(n0),p0=fs(l0),g0=fs(rl),y0=fs(c0),m0=fs(d0);var js;(function(i){i[i.Letter=0]="Letter",i[i.Single=1]="Single",i[i.Before=2]="Before",i[i.After=3]="After",i[i.Symbol=4]="Symbol",i[i.Break=5]="Break"})(js||(js={}));const{Letter:Qa,Single:x0,Before:w0,After:v0,Symbol:k0,Break:b0}=js;function T0(i){return _0[i]?Qa:m0[i]?b0:p0[i]?w0:g0[i]?v0:y0[i]?k0:f0.test(i)?x0:Qa}const S0={trimRight(i){const{words:t}=i;let e=0,s=t.length,n;for(let r=s-1;r>-1&&(n=t[r].data[0],n.char===" ");r--)e++,i.width-=n.width;e&&t.splice(s-e,e)}};function C0(i,t,e){switch(t){case"title":return e?i.toUpperCase():i;case"upper":return i.toUpperCase();case"lower":return i.toLowerCase();default:return i}}const{trimRight:P0}=S0,{Letter:ar,Single:Vi,Before:Ja,After:hr,Symbol:B0,Break:th}=js;let ts,he,Pt,Mt,lr,Kt,xe,rs,Ri,Gt,Ae,cr,Yi,ki,os,wi=[],zs,Rr;function R0(i,t,e){os=i,wi=i.rows,zs=i.bounds,Rr=!zs.width&&!e.autoSizeAlign;const{__letterSpacing:s,paraIndent:n,textCase:r}=e,{canvas:o}=S,{width:a,height:h}=zs;if(a||h||s||r!=="none"){const c=e.textWrap!=="none",p=e.textWrap==="break";ki=!0,Ae=null,rs=xe=Ri=Pt=Mt=0,ts={data:[]},he={words:[]};for(let f=0,d=t.length;f<d;f++)Kt=t[f],Kt===`
`?(Pt&&Xe(),he.paraEnd=!0,Zi(),ki=!0):(Gt=T0(Kt),Gt===ar&&r!=="none"&&(Kt=C0(Kt,r,!Pt)),xe=o.measureText(Kt).width,s&&(s<0&&(Ri=xe),xe+=s),cr=Gt===Vi&&(Ae===Vi||Ae===ar)||Ae===Vi&&Gt!==hr,Yi=(Gt===Ja||Gt===Vi)&&(Ae===B0||Ae===hr),lr=ki&&n?a-n:a,c&&a&&Mt+Pt+xe>lr&&(p?(Pt&&Xe(),Mt&&Zi()):(Yi||(Yi=Gt===ar&&Ae==hr),(cr||Yi||Gt===th||Gt===Ja||Gt===Vi||Pt+xe>lr)&&Pt&&Xe(),Mt&&Zi())),Kt===" "&&ki!==!0&&Mt+Pt===0||(Gt===th?(Kt===" "&&Pt&&Xe(),dr(Kt,xe),Xe()):((cr||Yi)&&Pt&&Xe(),dr(Kt,xe))),Ae=Gt);Pt&&Xe(),Mt&&Zi(),wi.length>0&&(wi[wi.length-1].paraEnd=!0)}else t.split(`
`).forEach(c=>{os.paraNumber++,Mt=o.measureText(c).width,wi.push({x:n||0,text:c,width:Mt,paraStart:!0}),Rr&&ol()})}function dr(i,t){Ri&&!rs&&(rs=Ri),ts.data.push({char:i,width:t}),Pt+=t}function Xe(){Mt+=Pt,ts.width=Pt,he.words.push(ts),ts={data:[]},Pt=0}function Zi(){ki&&(os.paraNumber++,he.paraStart=!0,ki=!1),Ri&&(he.startCharSize=rs,he.endCharSize=Ri,rs=0),he.width=Mt,zs.width?P0(he):Rr&&ol(),wi.push(he),he={words:[]},Mt=0}function ol(){Mt>(os.maxWidth||0)&&(os.maxWidth=Mt)}const E0=0,eh=1,ih=2;function O0(i,t,e,s){const{rows:n}=i,{textAlign:r,paraIndent:o,letterSpacing:a}=t;let h,l,c,p,f;n.forEach(d=>{d.words&&(c=o&&d.paraStart?o:0,l=e&&r==="justify"&&d.words.length>1?(e-d.width-c)/(d.words.length-1):0,p=a||d.isOverflow?E0:l>.01?eh:ih,d.isOverflow&&!a&&(d.textMode=!0),p===ih?(d.x+=c,I0(d)):(d.x+=c,h=d.x,d.data=[],d.words.forEach(u=>{p===eh?(f={char:"",x:h},h=M0(u.data,h,f),(d.isOverflow||f.char!==" ")&&d.data.push(f)):h=A0(u.data,h,d.data,d.isOverflow),!d.paraEnd&&l&&(h+=l,d.width+=l)})),d.words=null)})}function I0(i){i.text="",i.words.forEach(t=>{t.data.forEach(e=>{i.text+=e.char})})}function M0(i,t,e){return i.forEach(s=>{e.char+=s.char,t+=s.width}),t}function A0(i,t,e,s){return i.forEach(n=>{(s||n.char!==" ")&&(n.x=t,e.push(n)),t+=n.width}),t}function D0(i,t){const{rows:e,bounds:s}=i,{__lineHeight:n,__baseLine:r,__letterSpacing:o,__clipText:a,textAlign:h,verticalAlign:l,paraSpacing:c,autoSizeAlign:p}=t;let{x:f,y:d,width:u,height:y}=s,v=n*e.length+(c?c*(i.paraNumber-1):0),C=r;if(a&&v>y)v=Math.max(y,n),i.overflow=e.length;else if(y||p)switch(l){case"middle":d+=(y-v)/2;break;case"bottom":d+=y-v}C+=d;let m,I,T,L=u||p?u:i.maxWidth;for(let W=0,M=e.length;W<M;W++){if(m=e[W],m.x=f,m.width<u||m.width>u&&!a)switch(h){case"center":m.x+=(L-m.width)/2;break;case"right":m.x+=L-m.width}m.paraStart&&c&&W>0&&(C+=c),m.y=C,C+=n,i.overflow>W&&C>v&&(m.isOverflow=!0,i.overflow=W+1),I=m.x,T=m.width,o<0&&(m.width<0?(T=-m.width+t.fontSize+o,I-=T,T+=t.fontSize):T-=o),I<s.x&&(s.x=I),T>s.width&&(s.width=T),a&&u&&u<T&&(m.isOverflow=!0,i.overflow||(i.overflow=e.length))}s.y=d,s.height=v}function L0(i,t,e,s){if(!s)return;const{rows:n,overflow:r}=i;let{textOverflow:o}=t;if(n.splice(r),o&&o!=="show"){o==="hide"?o="":o==="ellipsis"&&(o="...");let a,h;const l=o?S.canvas.measureText(o).width:0,c=e+s-l;(t.textWrap==="none"?n:[n[r-1]]).forEach(f=>{if(f.isOverflow&&f.data){let d=f.data.length-1;for(let u=d;u>-1&&(a=f.data[u],h=a.x+a.width,!(u===d&&h<c));u--){if(h<c&&a.char!==" "){f.data.splice(u+1),f.width-=a.width;break}f.width-=a.width}f.width+=l,f.data.push({char:o,x:h}),f.textMode&&W0(f)}})}}function W0(i){i.text="",i.data.forEach(t=>{i.text+=t.char}),i.data=null}function z0(i,t){const{fontSize:e}=t;switch(i.decorationHeight=e/11,t.textDecoration){case"under":i.decorationY=e*.15;break;case"delete":i.decorationY=-e*.35}}const{top:$s,right:al,bottom:hl,left:Us}=mr;function $0(i,t){typeof i!="string"&&(i=String(i));let e=0,s=0,n=t.__getInput("width")||0,r=t.__getInput("height")||0;const{textDecoration:o,__font:a,__padding:h}=t;h&&(n?(e=h[Us],n-=h[al]+h[Us]):t.autoSizeAlign||(e=h[Us]),r?(s=h[$s],r-=h[$s]+h[hl]):t.autoSizeAlign||(s=h[$s]));const l={bounds:{x:e,y:s,width:n,height:r},rows:[],paraNumber:0,font:S.canvas.font=a};return R0(l,i,t),h&&U0(h,l,t,n,r),D0(l,t),O0(l,t,n),l.overflow&&L0(l,t,e,n),o!=="none"&&z0(l,t),l}function U0(i,t,e,s,n){if(!s&&e.autoSizeAlign)switch(e.textAlign){case"left":Ms(t,"x",i[Us]);break;case"right":Ms(t,"x",-i[al])}if(!n&&e.autoSizeAlign)switch(e.verticalAlign){case"top":Ms(t,"y",i[$s]);break;case"bottom":Ms(t,"y",-i[hl])}}function Ms(i,t,e){const{bounds:s,rows:n}=i;s[t]+=e;for(let r=0;r<n.length;r++)n[r][t]+=e}const F0={getDrawData:$0};function N0(i,t){const e=typeof t=="number"&&t!==1;if(typeof i=="string")if(e&&ii.object)i=ii.object(i);else return i;let s=i.a===void 0?1:i.a;e&&(s*=t);const n=i.r+","+i.g+","+i.b;return s===1?"rgb("+n+")":"rgba("+n+","+s+")"}const G0={string:N0},{setPoint:H0,addPoint:j0,toBounds:V0}=as;function Y0(i){const{width:t,height:e}=i.view,{data:s}=i.context.getImageData(0,0,t,e);let n,r,o,a=0;for(let l=0;l<s.length;l+=4)s[l+3]!==0&&(n=a%t,r=(a-n)/t,o?j0(o,n,r):H0(o={},n,r)),a++;const h=new nt;return V0(o,h),h.scale(1/i.pixelRatio).ceil()}const Z0={export(i,t,e){this.running=!0;const s=be.fileType(t),n=t.includes(".");return e=be.getExportOptions(e),K0(r=>new Promise(o=>{const a=p=>{r(p),o(),this.running=!1},{toURL:h}=S,{download:l}=S.origin;if(s==="json")return n&&l(h(JSON.stringify(i.toJSON(e.json)),"text"),t),a({data:n?!0:i.toJSON(e.json)});if(s==="svg")return n&&l(h(i.toSVG(),"svg"),t),a({data:n?!0:i.toSVG()});const{leafer:c}=i;c?(ll(i),c.waitViewCompleted(()=>Yr(this,void 0,void 0,function*(){let p,f,d=1,u=1;const{worldTransform:y,isLeafer:v,isFrame:C}=i,{slice:m,trim:I,onCanvas:T}=e,L=e.smooth===void 0?c.config.smooth:e.smooth,W=e.contextSettings||c.config.contextSettings,M=e.screenshot||i.isApp,g=v&&M&&e.fill===void 0?i.fill:e.fill,A=be.isOpaqueImage(t)||g,P=new ze;if(M)p=M===!0?v?c.canvas.bounds:i.worldRenderBounds:M;else{let Lt=e.relative||(v?"inner":"local");switch(d=y.scaleX,u=y.scaleY,Lt){case"inner":P.set(y);break;case"local":P.set(y).divide(i.localTransform),d/=i.scaleX,u/=i.scaleY;break;case"world":d=1,u=1;break;case"page":Lt=i.leafer;default:P.set(y).divide(i.getTransform(Lt));const li=Lt.worldTransform;d/=d/li.scaleX,u/=u/li.scaleY}p=i.getBounds("render",Lt)}const B={scaleX:1,scaleY:1};bt.getScaleData(e.scale,e.size,p,B);let $=e.pixelRatio||1;i.isApp&&(B.scaleX*=$,B.scaleY*=$,$=i.app.pixelRatio);const{x:mt,y:Tt,width:$t,height:re}=new nt(p).scale(B.scaleX,B.scaleY),rt={matrix:P.scale(1/B.scaleX,1/B.scaleY).invert().translate(-mt,-Tt).withScale(1/d*B.scaleX,1/u*B.scaleY)};let j=ct.canvas({width:Math.round($t),height:Math.round(re),pixelRatio:$,smooth:L,contextSettings:W}),Dt;if(m&&(Dt=i,Dt.__worldOpacity=0,i=c,rt.bounds=j.bounds),j.save(),C&&g!==void 0){const Lt=i.get("fill");i.fill="",i.__render(j,rt),i.fill=Lt}else i.__render(j,rt);if(j.restore(),Dt&&Dt.__updateWorldOpacity(),I){f=Y0(j);const Lt=j,{width:li,height:_s}=f,St={x:0,y:0,width:li,height:_s,pixelRatio:$};j=ct.canvas(St),j.copyWorld(Lt,f,St)}A&&j.fillWorld(j.bounds,g||"#FFFFFF","destination-over"),T&&T(j);const Ee=t==="canvas"?j:yield j.export(t,e);a({data:Ee,width:j.pixelWidth,height:j.pixelHeight,renderBounds:p,trimBounds:f})}))):a({data:!1})}))}};let ur;function K0(i){return ur||(ur=new vr),new Promise(t=>{ur.add(()=>Yr(this,void 0,void 0,function*(){return yield i(t)}),{parallel:!1})})}function ll(i){i.__.__needComputePaint&&i.__.__computePaint(),i.isBranch&&i.children.forEach(t=>ll(t))}const sn=Ar.prototype,cl=K.get("@leafer-ui/export");sn.export=function(i,t){const{quality:e,blob:s}=be.getExportOptions(t);return i.includes(".")?this.saveAs(i,e):s?this.toBlob(i,e):this.toDataURL(i,e)};sn.toBlob=function(i,t){return new Promise(e=>{S.origin.canvasToBolb(this.view,i,t).then(s=>{e(s)}).catch(s=>{cl.error(s),e(null)})})};sn.toDataURL=function(i,t){return S.origin.canvasToDataURL(this.view,i,t)};sn.saveAs=function(i,t){return new Promise(e=>{S.origin.canvasSaveAs(this.view,i,t).then(()=>{e(!0)}).catch(s=>{cl.error(s),e(!1)})})};Object.assign(Dh,F0);Object.assign(ii,G0);Object.assign(pt,Rp);Object.assign(si,$p);Object.assign(Ls,Yp);Object.assign(br,t0);Object.assign(bi,Z0);Object.assign(ct,{interaction:(i,t,e,s)=>new yp(i,t,e,s),hitCanvas:(i,t)=>new Yh(i,t),hitCanvasManager:()=>new G_});X_();const{M:X0,L:q0,C:Q0,Q:J0,Z:t1,N:e1,D:i1,X:s1,G:sh,F:nh,O:n1,P:r1,U:o1}=Vt,Xr={scale(i,t,e){if(!i)return;let s,n=0,r=i.length;for(;n<r;)switch(s=i[n],s){case X0:case q0:Xt(i,t,e,n,1),n+=3;break;case Q0:Xt(i,t,e,n,3),n+=7;break;case J0:Xt(i,t,e,n,2),n+=5;break;case t1:n+=1;break;case e1:Xt(i,t,e,n,2),n+=5;break;case i1:Xt(i,t,e,n,2),n+=9;break;case s1:Xt(i,t,e,n,2),n+=6;break;case sh:Xt(i,t,e,n,2),n+=9;break;case nh:Xt(i,t,e,n,2),n+=5;break;case n1:i[n]=sh,i.splice(n+4,0,i[n+3],0),Xt(i,t,e,n,2),n+=9,r+=2;break;case r1:i[n]=nh,i.splice(n+4,0,i[n+3]),Xt(i,t,e,n,2),n+=5,r+=1;break;case o1:Xt(i,t,e,n,2),n+=6;break}},scalePoints(i,t,e,s,n){for(let r=n?s+1:0,o=n?r+n*2:i.length;r<o;r+=2)i[r]*=t,i[r+1]*=e}},{scalePoints:Xt}=Xr,fr=z.get(),{topLeft:a1,top:h1,topRight:l1,right:c1,bottom:d1,left:u1}=Ns;function nn(i,t,e){i.pathInputed?rn(i,t,e):(t!==1&&(i.width*=t),e!==1&&(i.height*=e))}function f1(i,t,e){const{app:s}=i,n=s&&s.editor;let r=t;if(n.editing){const a=i.__layout;let{width:h,height:l}=a.boxBounds;switch(h*=e-t,l*=t-e,n.resizeDirection){case h1:case d1:r=e,a.affectScaleOrRotation?i.moveInner(-h/2,0):i.x-=h/2;break;case u1:case c1:a.affectScaleOrRotation?i.moveInner(0,-l/2):i.y-=l/2;break;case a1:case l1:a.affectScaleOrRotation?i.moveInner(0,-l):i.y-=l;break}}i.fontSize*=r;const o=i.__;o.__autoWidth||(i.width*=r),o.__autoHeight||(i.height*=r)}function rn(i,t,e){Xr.scale(i.__.path,t,e),i.path=i.__.path}function dl(i,t,e){const{points:s}=i;typeof s[0]=="object"?s.forEach(n=>{n.x*=t,n.y*=e}):Xr.scalePoints(s,t,e),i.points=s}function Er(i,t,e){const{children:s}=i;for(let n=0;n<s.length;n++)fr.a=t,fr.d=e,s[n].transform(fr,!0)}const on=ei.prototype;on.scaleResize=function(i,t=i,e){const s=this;e||s.editConfig&&s.editConfig.editSize==="scale"?(s.scaleX*=i,s.scaleY*=t):(i<0&&(s.scaleX*=-1,i=-i),t<0&&(s.scaleY*=-1,t=-t),this.__scaleResize(i,t))};on.__scaleResize=function(i,t){nn(this,i,t)};on.resizeWidth=function(i){const t=i/this.getBounds("box","local").width;this.scaleOf(this.__layout.boxBounds,t,this.__.lockRatio?t:1,!0)};on.resizeHeight=function(i){const t=i/this.getBounds("box","local").height;this.scaleOf(this.__layout.boxBounds,this.__.lockRatio?t:1,t,!0)};X.prototype.__scaleResize=function(i,t){this.__.resizeFontSize||this.editConfig&&this.editConfig.editSize==="font-size"?f1(this,i,t):nn(this,i,t)};Fe.prototype.__scaleResize=function(i,t){rn(this,i,t)};de.prototype.__scaleResize=function(i,t){this.pathInputed?rn(this,i,t):this.points?dl(this,i,t):this.width*=i};se.prototype.__scaleResize=function(i,t){this.pathInputed?rn(this,i,t):this.points?dl(this,i,t):nn(this,i,t)};Bt.prototype.__scaleResize=function(i,t){Er(this,i,t)};dt.prototype.__scaleResize=function(i,t){this.__.__autoSize&&this.children.length?Er(this,i,t):(nn(this,i,t),this.__.resizeChildren&&Er(this,i,t))};function qr(i,t,e,s){var n=arguments.length,r=n<3?t:s,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(i,t,e,s);else for(var a=i.length-1;a>=0;a--)(o=i[a])&&(r=(n<3?o(r):n>3?o(t,e,r):o(t,e))||r);return n>3&&r&&Object.defineProperty(t,e,r),r}class _1 extends zr{}let Ei=class extends dt{get __tag(){return"Flow"}constructor(t){super(t),this.__hasAutoLayout=!0}};qr([vt(_1)],Ei.prototype,"__",void 0);qr([Ks("x")],Ei.prototype,"flow",void 0);Ei=qr([kt()],Ei);const _r={},ul={"top-left":"from",top:"center","top-right":"to",right:"to","bottom-right":"to",bottom:"center","bottom-left":"from",left:"from",center:"center","baseline-left":"from","baseline-center":"center","baseline-right":"to"},fl={"top-left":"from",top:"from","top-right":"from",right:"center","bottom-right":"to",bottom:"to","bottom-left":"to",left:"center",center:"center","baseline-left":"to","baseline-center":"to","baseline-right":"to"};function an(i,t,e){const s=i.__,{contentBounds:n}=i.__layout;yh.toPoint(e,t,n,_r),t.x=s.__autoWidth?n.x:_r.x,t.y=s.__autoHeight?n.y:_r.y}function p1(i,t,e,s){an(i,t,e);const{list:n}=t;if(n.length>1&&(s||(s=ul[e]),s!=="from")){let r;for(let o=0,a=n.length;o<a;o++)r=n[o],r.x=t.width-r.width,s==="center"&&(r.x/=2)}}const{move:g1}=D;function y1(i,t,e,s){const{list:n}=t,r=i.__.flowWrap==="reverse";let o,{x:a,y:h}=t;for(let l=0,c=n.length;l<c;l++)o=n[r?c-1-l:l],_l(i,o,a,h,e,s),h+=o.height+t.gap}function _l(i,t,e,s,n,r){const{children:o}=i;let a,h,{x:l,start:c}=t,p=s;l+=e;for(let f=0,d=t.count;f<d;f++)a=o[r?c-f:c+f],a.__.inFlow&&a.__.visible!==0?(h=a.__flowBounds,n!=="from"&&(p=s+(t.height-h.height)/(n==="center"?2:1)),g1(a,l-h.x,p-h.y),l+=h.width+t.gap):d++}function Vs(i,t,e){const s=e==="width"?"height":"width";i[e]=Math.max(i[e],t[e]),i[s]+=i.count?t[s]+i.gap:t[s],i.list.push(t),i.count++}const st={};function pl(i,t){const{gap:e,flowAlign:s,flowWrap:n,__autoWidth:r,__autoHeight:o}=i.__,a=n&&(t?!r:!o);return typeof e=="object"?(st.xGap=e.x||0,st.yGap=e.y||0):st.xGap=st.yGap=e,st.isAutoXGap=typeof st.xGap=="string"&&!r,st.isAutoYGap=typeof st.yGap=="string"&&!o,st.complex=a||s!=="top-left"||i.__hasGrow||st.isAutoXGap||st.isAutoYGap,st.wrap=a,st.complex&&(st.isFitXGap=st.xGap==="fit"&&!r,st.isFitYGap=st.yGap==="fit"&&!o,typeof s=="object"?(st.contentAlign=s.content||"top-left",st.rowXAlign=s.x||"from",st.rowYAlign=s.y||"from"):(st.contentAlign=s,st.rowXAlign=ul[s],st.rowYAlign=fl[s])),st}function Ys(i,t){return{x:0,y:0,width:0,height:0,gap:t,start:i,count:0,grow:0}}function gl(){return{x:0,y:0,width:0,height:0,gap:0,count:0,list:[]}}function Ci(i,t,e,s){const{count:n}=i;n>1&&(e>i[t]||s)&&(i.gap=(e-i[t])/(n-1),i[t]=e)}function yl(i,t){return t==="box"?i.__local:i.__layout.localStrokeBounds}const{within:m1}=bt;function rh(i,t,e,s){let n,r,o,a=0,h=t.hasRangeSize&&[],{grow:l,start:c}=t;const p=t.width<e?(e-t.width)/l:0,{children:f}=i;p&&(t.width=e);for(let d=0,u=t.count;d<u;d++)n=f[s?c-d:c+d],n.__.inFlow&&n.__.visible!==0?(r=n.__widthGrow)&&(o=Qr(n,n.__flowBounds,p*r),o?(a+=o,l-=r):h&&(n.__.widthRange?h.unshift(n):h.push(n))):u++;a&&x1(h,a,l)}function x1(i,t,e){let s,n,r,o;i.forEach(a=>{s=a.__widthGrow,n=t/e*s,o=Qr(a,r=a.__flowBounds,r.width+n),t-=n-o,e-=s})}function Qr(i,t,e){const{widthRange:s,lockRatio:n}=i.__,r=s?m1(e,s):e,o=r/t.width;return i.scaleResize(o,n?o:1),t.width=r,e-r}const{within:w1}=bt;function oh(i,t,e,s){let n,r,o,a=0,h=t.hasRangeSize&&[],{grow:l,start:c}=t;const p=t.height<e?(e-t.height)/l:0,{children:f}=i;p&&(t.height=e);for(let d=0,u=t.count;d<u;d++)n=f[s?c-d:c+d],n.__.inFlow&&n.__.visible!==0?(r=n.__heightGrow)&&(o=Jr(n,n.__flowBounds,p*r),o?(a+=o,l-=r):h&&(n.__.heightRange?h.unshift(n):h.push(n))):u++;a&&v1(h,a,l)}function v1(i,t,e){let s,n,r,o;i.forEach(a=>{s=a.__heightGrow,n=t/e*s,o=Jr(a,r=a.__flowBounds,r.height+n),t-=n-o,e-=s})}function Jr(i,t,e){const{heightRange:s,lockRatio:n}=i.__,r=s?w1(e,s):e,o=r/t.height;return i.scaleResize(n?o:1,o),t.height=r,e-r}const{move:k1}=D;function ah(i,t){const e="width",{children:s,itemBox:n}=i,r=pl(i,!0),{complex:o,wrap:a,xGap:h,yGap:l,isAutoXGap:c,isFitXGap:p}=r;if(!s.length)return;const f=a&&gl(),d=c?0:h;let u,y,v,C,m,{x:I,y:T,width:L,height:W}=i.__layout.contentBounds;for(let M=0,g=s.length;M<g;M++)u=s[C=t?g-1-M:M],u.__.inFlow&&u.__.visible!==0&&(y=yl(u,n),o?(u.__flowBounds=y,m||(m=Ys(C,d)),a&&m.count&&m.width+y.width>L&&(m.grow?rh(i,m,L,t):c&&Ci(m,e,L,p),Vs(f,m,e),m=Ys(C,d)),v=y.width,u.__widthGrow&&(m.grow+=u.__widthGrow,v=0,u.__.widthRange&&(m.hasRangeSize=!0)),u.__heightGrow&&Jr(u,y,W),m.width+=m.count?v+d:v,m.height=Math.max(m.height,y.height),m.count++):(k1(u,I-y.x,T-y.y),I+=y.width+d));if(o){const{isAutoYGap:M,isFitYGap:g,contentAlign:A,rowXAlign:P,rowYAlign:B}=r;m.count&&(m.grow?rh(i,m,L,t):c&&Ci(m,e,L,p),a&&Vs(f,m,e)),a?(M?Ci(f,"height",W,g):f.gap=l,p1(i,f,A,P),y1(i,f,B,t)):(an(i,m,A),_l(i,m,0,m.y,B,t))}}function b1(i,t,e,s){an(i,t,e);const{list:n}=t;if(n.length>1&&(s||(s=fl[e]),s!=="from")){let r;for(let o=0,a=n.length;o<a;o++)r=n[o],r.y=t.height-r.height,s==="center"&&(r.y/=2)}}const{move:T1}=D;function S1(i,t,e,s){const{list:n}=t,r=i.__.flowWrap==="reverse";let o,{x:a,y:h}=t;for(let l=0,c=n.length;l<c;l++)o=n[r?c-1-l:l],ml(i,o,a,h,e,s),a+=o.width+t.gap}function ml(i,t,e,s,n,r){const{children:o}=i;let a,h,{y:l,start:c}=t,p=e;l+=s;for(let f=0,d=t.count;f<d;f++)a=o[r?c-f:c+f],a.__.inFlow&&a.__.visible!==0?(h=a.__flowBounds,n!=="from"&&(p=e+(t.width-h.width)/(n==="center"?2:1)),T1(a,p-h.x,l-h.y),l+=h.height+t.gap):d++}const{move:C1}=D;function hh(i,t){const e="height",{children:s,itemBox:n}=i,r=pl(i,!1),{complex:o,wrap:a,xGap:h,yGap:l,isAutoYGap:c,isFitYGap:p}=r;if(!s.length)return;const f=a&&gl(),d=c?0:l;let u,y,v,C,m,{x:I,y:T,width:L,height:W}=i.__layout.contentBounds;for(let M=0,g=s.length;M<g;M++)u=s[C=t?g-1-M:M],u.__.inFlow&&u.__.visible!==0&&(y=yl(u,n),o?(u.__flowBounds=y,m||(m=Ys(C,d)),a&&m.count&&m.height+y.height>W&&(m.grow&&oh(i,m,W,t),c&&Ci(m,e,W,p),Vs(f,m,e),m=Ys(C,d)),v=y.height,u.__heightGrow&&(m.grow+=u.__heightGrow,v=0,u.__.heightRange&&(m.hasRangeSize=!0)),u.__widthGrow&&Qr(u,y,L),m.height+=m.count?v+d:v,m.width=Math.max(m.width,y.width),m.count++):(C1(u,I-y.x,T-y.y),T+=y.height+d));if(o){const{isAutoXGap:M,isFitXGap:g,contentAlign:A,rowXAlign:P,rowYAlign:B}=r;m.count&&(m.grow&&oh(i,m,W,t),c&&Ci(m,e,W,p),a&&Vs(f,m,e)),a?(M?Ci(f,"width",L,g):f.gap=h,b1(i,f,A,B),S1(i,f,P,t)):(an(i,m,A),ml(i,m,m.x,0,P,t))}}function xl(i){return ut(i,t=>({set(e){const s=typeof e=="number"?e:0;t==="autoWidth"?this.__widthGrow=s:this.__heightGrow=s,s&&!(this.parent&&this.parent.__hasGrow)&&this.waitParent(()=>{this.parent.__hasGrow=!0}),this.__setAttr(t,e)&&Ai(this)}}))}const Re=w.prototype,to=dt.prototype,{__updateBoxBounds:P1}=Bt.prototype;Ks(!1)(Re,"flow");U(0)(Re,"gap");U("top-left")(Re,"flowAlign");U(!1)(Re,"flowWrap");U("box")(Re,"itemBox");U(!0)(Re,"inFlow");xl()(Re,"autoWidth");xl()(Re,"autoHeight");U()(Re,"autoBox");const{copyAndSpread:wl}=O;to.__updateFlowLayout=function(){const{leaferIsCreated:i,flow:t}=this;switch(i&&(this.leafer.created=!1),t){case"x":case!0:ah(this);break;case"y":hh(this);break;case"x-reverse":ah(this,!0);break;case"y-reverse":hh(this,!0);break}i&&(this.leafer.created=!0)};to.__updateContentBounds=function(){const{padding:i}=this.__,t=this.__layout,e=t.contentBounds===t.boxBounds;i?(e&&t.shrinkContent(),wl(t.contentBounds,t.boxBounds,i,!0)):e||t.shrinkContentCancel()};to.__updateBoxBounds=function(i){const t=this.__;if(this.children.length){const{flow:e}=t;if(t.__autoSide){e&&!i?this.__updateRectBoxBounds():P1.call(this);const{boxBounds:s}=this.__layout;t.__autoSize||(t.__autoWidth?(e||(s.width+=s.x,s.x=0),s.height=t.height,s.y=0):(e||(s.height+=s.y,s.y=0),s.width=t.width,s.x=0)),e&&i&&t.padding&&wl(s,s,t.padding,!1,t.__autoSize?null:t.__autoWidth?"width":"height"),this.__updateNaturalSize()}else this.__updateRectBoxBounds();e&&this.__updateContentBounds()}else this.__updateRectBoxBounds()};const B1=`<svg t="1734426738989" class="icon" viewBox="0 0 1024 1024" version="1.1"\r
    xmlns="http://www.w3.org/2000/svg" p-id="1602" width="30" height="30">\r
    <path\r
        d="M404.59765625 537.04882813H136.35546875c-10.72265625 0-19.3359375-8.61328125-19.3359375-19.33593751V249.47070312c0-10.72265625 8.61328125-19.3359375 19.3359375-19.33593749s19.3359375 8.61328125 19.3359375 19.3359375v248.90624999h248.90625c10.72265625 0 19.3359375 8.61328125 19.3359375 19.33593751 0 10.63476563-8.70117188 19.3359375-19.3359375 19.3359375z"\r
        p-id="1603"></path>\r
    <path\r
        d="M530.36914063 889.75390625c-10.72265625 0-19.3359375-8.61328125-19.33593751-19.3359375s8.61328125-19.3359375 19.33593751-19.3359375C716.9609375 851.08203125 868.8359375 699.20703125 868.8359375 512.61523438s-151.78710938-338.37890625-338.46679688-338.37890626c-186.59179688 0-338.46679688 151.875-338.46679687 338.46679688 0 10.63476563-8.61328125 19.3359375-19.3359375 19.3359375s-19.3359375-8.70117188-19.3359375-19.3359375c0-50.88867188 9.93164063-100.28320313 29.61914063-146.77734375 18.984375-44.91210938 46.14257813-85.25390625 80.77148437-119.8828125 34.62890625-34.62890625 74.97070313-61.78710938 119.8828125-80.77148438C430.0859375 145.49609375 479.48046875 135.56445312 530.36914063 135.56445312S630.74023438 145.49609375 677.234375 165.18359375c44.91210938 18.984375 85.25390625 46.14257813 119.8828125 80.77148438 34.62890625 34.62890625 61.78710938 74.97070313 80.77148438 119.88281249 19.6875 46.49414063 29.61914063 95.88867188 29.61914062 146.77734376 0 50.88867188-9.93164063 100.28320313-29.61914063 146.77734374-18.984375 44.91210938-46.14257813 85.25390625-80.77148437 119.88281251S722.14648438 841.0625 677.234375 860.046875c-46.49414063 19.77539063-95.88867188 29.70703125-146.86523438 29.70703125z"\r
        p-id="1604"></path>\r
</svg>`,R1=`<svg t="1734426662684" class="icon" viewBox="0 0 1024 1024" version="1.1"\r
    xmlns="http://www.w3.org/2000/svg" p-id="1134" width="30" height="30">\r
    <path\r
        d="M593.67189854 730.06030621c-15.08915755 0-27.24838256-12.15922415-27.24838256-27.24838256L566.42351598 402.93322317c0-15.08915755 12.15922415-27.24838256 27.24838256-27.24838255s27.24838256 12.15922415 27.24838256 27.24838255l0 299.7322039C620.92028024 717.75458462 608.76105608 730.06030621 593.67189854 730.06030621z"\r
        p-id="1135"></path>\r
    <path\r
        d="M430.18160487 730.06030621c-15.08915755 0-27.24838256-12.15922415-27.24838254-27.24838256L402.93322317 402.93322317c0-15.08915755 12.15922415-27.24838256 27.24838256-27.24838255 15.08915755 0 27.24838256 12.15922415 27.24838256 27.24838255l0 299.7322039C457.42998744 717.75458462 445.27076328 730.06030621 430.18160487 730.06030621z"\r
        p-id="1136"></path>\r
    <path\r
        d="M866.30221645 266.69131209l-136.2419111 0L730.06030621 212.1945478c0-45.12097691-36.33117589-81.74514682-81.15915964-81.74514682L375.68484061 130.44940098c-45.12097691 0-81.74514682 36.62416991-81.74514682 81.74514682l0 54.49676429-136.24191109 0c-15.08915755 0-27.24838256 12.15922415-27.24838256 27.24838256s12.15922415 27.24838256 27.24838256 27.24838255l708.60443376 0c15.08915755 0 27.24838256-12.15922415 27.24838256-27.24838255S881.39137485 266.69131209 866.30221645 266.69131209zM348.43645891 212.1945478c0-14.94266096 12.30572075-27.24838256 27.24838256-27.24838255l273.2163051 0c14.94266096 0 26.66239537 12.01272758 26.66239537 27.24838255l0 54.49676429L348.43645891 266.69131209 348.43645891 212.1945478 348.43645891 212.1945478z"\r
        p-id="1137"></path>\r
    <path\r
        d="M702.81192365 893.55059902L321.33457293 893.55059902c-45.12097691 0-81.74514682-36.62416991-81.74514683-81.74514682L239.5894261 402.64022915c0-15.08915755 12.15922415-27.24838256 27.24838256-27.24838255s27.24838256 12.15922415 27.24838256 27.24838255l0 409.16522305c0 15.08915755 12.30572075 27.24838256 27.24838256 27.24838254l381.62384731 0c15.08915755 0 27.24838256-12.15922415 27.24838255-27.24838254L730.2068028 403.6657061c0-15.08915755 12.15922415-27.24838256 27.24838256-27.24838256s27.24838256 12.15922415 27.24838256 27.24838256l0 408.1397461C784.55707048 856.77993252 747.93290056 893.55059902 702.81192365 893.55059902z"\r
        p-id="1138"></path>\r
</svg>`,E1=`<svg t="1734426869943" class="icon" viewBox="0 0 1024 1024" version="1.1"\r
    xmlns="http://www.w3.org/2000/svg" p-id="2221" width="30" height="30">\r
    <path\r
        d="M850.72880046 416.58868408v-50.09353638c0-48.32858277-32.80737305-87.62475586-73.08984375-87.62475585-18.01290894 0-34.26086426 8.14993287-46.97891236 21.07562256v-42.67034912c0-48.32858277-32.80737305-87.62475586-73.08984374-87.62475586-18.84347535 0-35.92199707 8.82476807-48.89959717 22.94439697-8.04611207-37.89459229-36.54492188-66.1857605-70.65005493-66.1857605-37.53121949 0-68.15835572 34.20895386-72.25927735 77.91751099-12.9256897-16.50750732-30.00421143-26.73385621-49.21105957-26.73385621-41.00921631 0-73.08984375 45.31777955-73.08984375 103.14596558V521.08432007c0 7.05981445-0.83056641 13.44479371-1.81686401 19.46640014l-40.2305603-73.76467896a96.91671753 96.91671753 0 0 0-47.08273315-43.65664672c-20.34887695-8.46139527-41.32067871-7.89038086-58.97021485 1.66113281-17.59762574 9.60342408-29.48510742 26.8895874-33.48220825 48.64004517a97.07244873 97.07244873 0 0 0 11.16073608 63.27877808l87.62475586 160.92224121c5.29486084 12.9256897 88.61105347 210.49667359 234.99838257 199.0763855 28.08352662-2.12832642 55.85559082-1.09011841 82.64135742-0.15573121 14.06771851 0.519104 28.08352662 1.03820801 41.89169312 1.03820801 86.89801025 0 164.40023804-19.77786255 200.0107727-182.93225098l6.12542725-27.97970581c11.47219849-52.42950439 24.29406738-113.00894166 24.39788818-113.57995605 0.83056641-1.86877441 1.86877441-21.49090576 1.86877441-21.49090576a2728.09918213 2728.09918213 0 0 0-1.86877441-135.01895142z m-25.799469 153.13568115c-4.41238404 21.23135376-12.5104065 59.17785645-23.98260497 111.39971924l-6.07351685 27.92779541c-36.64874268 167.93014527-111.91882324 165.12698365-215.58389283 161.59707642-27.56442261-1.03820801-56.01132203-2.02450562-85.44451903 0.2076416-108.54464722 7.37127686-183.29562378-129.30880738-203.59259034-171.35623169l0.83056641-0.46719361-95.20367431-174.7304077a70.59814453 70.59814453 0 0 1-8.40948487-46.25216676c2.49169922-13.86007691 9.70724488-24.65744019 20.29696655-30.41949462 10.53781128-5.76205445 23.61923218-5.91778564 36.59683228-0.57101441 14.01580811 5.81396484 26.1628418 17.23425293 34.26086426 32.18444824l59.43740844 106.88351441a12.9776001 12.9776001 0 0 0 17.59762574 5.19104004c5.13912964-2.85507203 13.7043457-57.10144043 13.7043457-70.23477174V280.73916625c0-41.83978271 21.59472656-77.19076539 47.13464356-77.19076537s47.13464355 35.35098267 47.13464355 77.19076538l0.4152832 231.31274414c0 6.95599365 5.81396484 12.56231689 12.9776001 12.5623169s12.9776001-5.60632324 12.9776001-12.56231689l0.8824768-298.01760865c0-34.00131226 21.12753296-61.66955566 47.08273316-61.66955567 26.0071106 0 47.13464355 27.66824341 47.13464356 61.66955567l-0.62292481 298.01760865c0 6.95599365 5.76205445 12.56231689 12.9776001 12.56231688s12.9776001-5.60632324 12.9776001-12.56231689V413.00686645l0.6748352-159.98785399c1.76495361-31.92489625 21.64663697-57.36099244 46.45980835-57.36099244 26.0071106 0 47.13464355 27.66824341 47.13464356 61.66955566V365.35311889l-0.10382081 1.19393922v198.9725647h1.29776001c1.55731201 5.29486084 5.71014404 9.49960328 11.67984009 9.49960326s12.9776001-9.49960328 12.9776001-9.49960327v-3.11462403l0.1038208-196.53277586c0.25955201-33.68984986 21.23135376-60.99472046 46.97891235-60.99472047 26.0071106 0 47.13464355 27.66824341 47.13464355 61.66955567 0-0.05191041 4.56811523 181.94595337 0.15573121 203.17730712z"\r
        p-id="2222"></path>\r
</svg>`,O1=`<svg t="1734426857646" class="icon" viewBox="0 0 1024 1024" version="1.1"\r
    xmlns="http://www.w3.org/2000/svg" p-id="2070" width="30" height="30">\r
    <path\r
        d="M849.99512741 688.07230929l-155.49076773-362.81128524c25.91563411-4.32003157 43.1927235-25.91563411 43.19272351-56.14978134S711.78144908 212.96222061 681.54654262 212.96222061c-25.91563411 0-47.51123664 17.27633017-51.83050898 43.19120506l-393.04619171 82.06541545c-4.31927236-25.91563411-25.91487488-43.1927235-51.82974975-43.19272353C154.60594496 295.02611759 128.69107008 316.62323859 128.69107008 346.85662657s17.2770894 51.83050898 43.19196429 56.14978136v246.19320942C145.96815949 653.51964894 128.69107008 675.11525145 128.69107008 705.35015792s25.91487488 56.14902211 56.14978133 56.1490221c25.91487488 0 47.5104774-17.27633017 51.82974976-43.19120505l548.53771865 38.87269193c4.31851312 25.91487488 25.91411564 43.19120505 51.82974977 43.19120506 21.59560253 4.32003157 43.19196429-4.31851312 56.14902211-21.59560253 12.95781705-17.2770894 12.95781705-38.87269193 4.32003158-60.46829446-4.32003157-17.2770894-25.91563411-30.23490646-47.51199586-30.23490645z m-634.92012876-30.23414724V394.36862245l8.6385447-8.63854471 414.64179423-77.74538385 8.63854469 8.63854469L802.48465001 701.03012634c-4.32003157 4.31927236-8.63854469 8.63854469-8.63854469 12.95781705l-565.81404885-43.19272352-12.95705782-12.95705782z m0 0"\r
        p-id="2071"></path>\r
</svg>`,I1=`<svg t="1734426699626" class="icon" viewBox="0 0 1024 1024" version="1.1"\r
    xmlns="http://www.w3.org/2000/svg" p-id="1292" width="30" height="30">\r
    <path\r
        d="M846.79482682 753.94656383V267.26903988c27.6903393-9.27142764 47.64895993-35.40110898 47.64896079-66.21101902 0-38.56519548-31.25942881-69.82724291-69.82811551-69.82724293-30.46949835 0-56.36787332 19.52481362-65.90290255 46.74119481H268.17811431c-9.53415664-27.21638119-35.43078558-46.7420674-65.90290254-46.74206739-38.56606808 0-69.82811551 31.26292001-69.8281155 69.82811551 0 30.30627534 19.30921985 56.09292549 46.29167689 65.75277181v487.59489181c-26.98245706 9.65984717-46.29167605 35.44562388-46.29167689 65.75102579 0 38.56519548 31.26379261 69.82811551 69.8281155 69.82811551 29.42382217 0 54.5750364-18.20418962 64.85722637-43.95592593h492.62862622c10.28306257 25.7517363 35.43776885 43.95592592 64.85635291 43.95592593 38.56955928 0 69.82811551-31.26292001 69.82811553-69.82811551-0.00174605-30.80991006-19.96036667-56.93871795-47.65070598-66.21014644z m-89.71778103 48.43976382H269.81383808c-6.16495002-23.49803353-24.26526984-42.14999589-47.43336616-49.10574894V267.935025c22.24374603-6.67818663 39.819483-24.1395793 46.6425631-46.32135265H757.86872229c6.68342388 21.72789078 23.68569675 38.92481014 45.28440579 45.89714754V753.70478467c-22.51433005 7.26648817-40.03071296 25.64524788-46.07608229 48.68154298z"\r
        p-id="1293"></path>\r
</svg>`,M1=`<svg t="1734426724976" class="icon" viewBox="0 0 1024 1024" version="1.1"\r
    xmlns="http://www.w3.org/2000/svg" p-id="1447" width="30" height="30">\r
    <path\r
        d="M875.20625 375.70625l-226.9125-226.9125a56.25 56.25 0 0 0-39.76875-16.48125H188.5625a56.25 56.25 0 0 0-56.25 56.25v646.875a56.25 56.25 0 0 0 56.25 56.25h646.875a56.25 56.25 0 0 0 56.25-56.25V415.475a56.25 56.25 0 0 0-16.48125-39.76875zM315.125 188.5625h168.75V287H315.125V188.5625z m393.75 646.875H315.125V708.875h393.75v126.5625z m126.5625 0H765.125V680.75a28.125 28.125 0 0 0-28.125-28.125H287a28.125 28.125 0 0 0-28.125 28.125v154.6875H188.5625v-646.875H258.875V315.125a28.125 28.125 0 0 0 28.125 28.125h225a28.125 28.125 0 0 0 28.125-28.125V188.5625h68.4l226.9125 226.9125V835.4375z"\r
        p-id="1448"></path>\r
</svg>`,A1=`<svg t="1734426901916" class="icon" viewBox="0 0 1024 1024" version="1.1"\r
    xmlns="http://www.w3.org/2000/svg" p-id="2372" width="30" height="30">\r
    <path\r
        d="M648.05442202 892.95238121h-4.08163265c-8.16326531-1.36054448-14.96598613-8.16326531-16.32653061-16.32653061l-55.78231344-280.27210936c-1.36054448-6.80272082 1.36054448-13.60544244 5.44217713-19.04761879 5.44217713-5.44217713 12.24489796-6.80272082 19.04761879-5.44217713l280.27210936 55.78231344c8.16326531 1.36054448 14.96598613 8.16326531 16.32653061 16.32653061 1.36054448 8.16326531-1.36054448 16.32653061-8.1632653 20.40816326l-63.94557876 42.17687023 66.66666693 66.66666693c4.08163266 4.08163266 5.44217713 9.52380979 5.44217713 14.96598614s-2.72108817 10.88435348-5.44217713 14.96598691l-84.35374124 84.35374124c-8.16326531 8.16326531-21.76870774 8.16326531-28.57142856 0l-66.66666693-66.66666693-42.17687101 63.94557876c-4.08163266 5.44217713-10.88435348 8.16326531-17.68707432 8.1632653z m55.78231267-125.17006854c5.44217713 0 10.88435348 2.72108817 14.96598614 5.44217712l69.3877551 69.38775511 55.78231344-55.78231267-69.38775509-69.38775509c-4.08163266-4.08163266-6.80272082-10.88435348-5.44217713-16.32653062s4.08163266-12.24489796 9.52380977-14.96598692l43.53741472-28.57142857-202.72108818-40.81632653 40.81632653 202.72108895 28.57142857-43.53741547c2.72108817-5.44217713 9.52380979-8.16326531 14.96598613-9.52380901-1.36054448 1.36054448 0 1.36054448 0 1.3605437z"\r
        p-id="2373"></path>\r
    <path\r
        d="M452.13605468 892.95238121H204.51700655c-40.81632653 0-73.46938775-32.65306122-73.46938776-73.46938776V204.51700655C131.04761879 163.70068002 163.70068002 131.04761879 204.51700655 131.04761879h613.60544244c40.81632653 0 73.46938775 32.65306122 73.46938775 73.46938776V471.18367347c0 10.88435348-9.52380979 20.40816327-20.40816327 20.40816327s-19.04761879-8.16326531-19.04761879-19.04761879V204.51700655C852.13605468 186.82993223 837.17006777 171.86394532 819.48299345 171.86394532H204.51700655C186.82993223 171.86394532 171.86394532 186.82993223 171.86394532 204.51700655v613.60544244C171.86394532 837.17006777 186.82993223 852.13605468 204.51700655 852.13605468h247.61904813c10.88435348 0 20.40816327 9.52380979 20.40816327 20.40816327s-9.52380979 20.40816327-20.40816327 20.40816326z"\r
        p-id="2374"></path>\r
</svg>`,D1=`<svg t="1734574603380" class="icon" viewBox="0 0 1024 1024" version="1.1"\r
    xmlns="http://www.w3.org/2000/svg" p-id="1414" width="30" height="30">\r
    <path\r
        d="M512 130.45855713C301.47088242 130.45855713 130.45855713 301.47088242 130.45855713 512s171.01232529 381.54144287 381.54144287 381.54144287 381.54144287-171.01232529 381.54144287-381.54144287S722.52911758 130.45855713 512 130.45855713zM440.46097946 687.78159332l-38.83546829 38.83546829-38.83546829-38.83546829-98.79198074-100.15462875 38.83546828-38.83546829L402.30683518 648.26480103l312.72771835-312.72771836 38.83546829 38.83546829-313.40904236 313.40904236z"></path>\r
</svg>`,L1=`<svg t="1734426805074" class="icon" viewBox="0 0 1024 1024" version="1.1"\r
    xmlns="http://www.w3.org/2000/svg" p-id="1758" width="30" height="30">\r
    <path\r
        d="M470.89582081 285.9270144h-68.50696533v116.46184108h-116.46184108v68.50696532h116.46184108v119.88718933h68.50696533v-119.88718933h116.46184108v-68.50696532h-116.46184108z"\r
        p-id="1759"></path>\r
    <path\r
        d="M875.08691627 775.75181653l-174.69276161-174.6927616c30.8281344-47.95487573 47.95487573-106.18579627 47.95487575-164.41671682 0-171.26741332-137.01393067-308.281344-308.28134401-308.28134398s-308.281344 137.01393067-308.281344 308.28134398 137.01393067 308.281344 308.281344 308.28134401c61.6562688 0 116.46184108-17.12674133 164.4167168-47.95487572l174.6927616 174.6927616c13.70139307 13.70139307 30.8281344 20.5520896 47.95487574 20.5520896s34.25348267-6.85069653 47.95487573-20.5520896c27.40278614-23.97743787 27.40278614-68.50696532 0-95.90975146z m-438.44457816-99.33509973c-133.5885824 0-239.77437867-106.18579627-239.77437865-239.77437869s106.18579627-239.77437867 239.77437865-239.77437865 239.77437867 106.18579627 239.77437869 239.77437865-106.18579627 239.77437867-239.77437869 239.77437869z"\r
        p-id="1760"></path>\r
</svg>`,W1=`<svg t="1734426828210" class="icon" viewBox="0 0 1024 1024" version="1.1"\r
    xmlns="http://www.w3.org/2000/svg" p-id="1914" width="30" height="30">\r
    <path d="M285.9270144 402.38885548h301.43064749v68.50696533h-301.43064749z"\r
        p-id="1915"></path>\r
    <path\r
        d="M875.08691627 775.75181653l-174.69276161-174.6927616c30.8281344-47.95487573 47.95487573-106.18579627 47.95487575-164.41671682 0-171.26741332-137.01393067-308.281344-308.28134401-308.28134398s-308.281344 137.01393067-308.281344 308.28134398 137.01393067 308.281344 308.281344 308.28134401c61.6562688 0 116.46184108-17.12674133 164.4167168-47.95487572l174.6927616 174.6927616c13.70139307 13.70139307 30.8281344 20.5520896 47.95487574 20.5520896s34.25348267-6.85069653 47.95487573-20.5520896c27.40278614-23.97743787 27.40278614-68.50696532 0-95.90975146z m-438.44457816-99.33509973c-133.5885824 0-239.77437867-106.18579627-239.77437865-239.77437869s106.18579627-239.77437867 239.77437865-239.77437865 239.77437867 106.18579627 239.77437869 239.77437865-106.18579627 239.77437867-239.77437869 239.77437869z"\r
        p-id="1916"></path>\r
</svg>`,z1=`<svg t="1734430033373" class="icon" viewBox="0 0 1024 1024" version="1.1"\r
    xmlns="http://www.w3.org/2000/svg" p-id="1165" width="30" height="30">\r
    <path\r
        d="M831.00217883 668.25094343a28.69886001 28.69886001 0 0 0-39.41310162 10.01271299A326.97567836 326.97567836 0 0 1 511.99840586 837.2553412a325.82772366 325.82772366 0 0 1-315.55990961-246.29999403l41.70900954 41.70900953a28.69886001 28.69886001 0 0 0 40.56105558-40.62483084L178.32632658 491.72106634A28.69886001 28.69886001 0 0 0 129.34693878 512.00159414c0 210.96850835 171.68295799 382.65146708 382.65146708 382.65146708a384.81982522 384.81982522 0 0 0 328.95271071-186.9890169 28.76263528 28.76263528 0 0 0-9.94893774-39.41310088zM511.99840586 129.35012781A380.22800792 380.22800792 0 0 0 167.93096201 344.40025211a28.69886001 28.69886001 0 1 0 51.59417276 25.12744615A323.27671397 323.27671397 0 0 1 511.99840586 186.74784783a325.82772366 325.82772366 0 0 1 315.55990961 246.23621875l-51.02019541-50.89264489a28.69886001 28.69886001 0 0 0-40.49728032 40.56105485l109.62964466 109.62964541A28.69886001 28.69886001 0 0 0 894.64987219 512.00159414c0-210.96850835-171.68295799-382.65146708-382.65146633-382.65146633z"\r
        p-id="1166"></path>\r
    <path\r
        d="M511.99840586 512.00159414m-85.01240134 0a85.0124006 85.0124006 0 1 0 170.02480194 0 85.0124006 85.0124006 0 1 0-170.02480194 0Z"\r
        p-id="1167"></path>\r
</svg>`,$1=`<svg t="1734574574196" class="icon" viewBox="0 0 1024 1024" version="1.1"\r
    xmlns="http://www.w3.org/2000/svg" p-id="1258" width="30" height="30">\r
    <path\r
        d="M512 130.45855713C301.47088242 130.45855713 130.45855713 301.47088242 130.45855713 512s171.01232529 381.54144287 381.54144287 381.54144287 381.54144287-171.01232529 381.54144287-381.54144287S722.52911758 130.45855713 512 130.45855713z m0 708.57696533c-180.55086136 0-327.03552246-146.4846611-327.03552246-327.03552246s146.4846611-327.03552246 327.03552246-327.03552246 327.03552246 146.4846611 327.03552246 327.03552246-146.4846611 327.03552246-327.03552246 327.03552246z"></path>\r
</svg>`,U1=`<svg t="1734662490815" class="icon" viewBox="0 0 1024 1024" version="1.1"\r
    xmlns="http://www.w3.org/2000/svg" p-id="2108" width="30" height="30">\r
    <path\r
        d="M512 756.89795918c-56.21768708 0-109.11564626-21.17006803-155.31972789-51.10204082l80.76190476-80.76190475A132.87074829 132.87074829 0 0 0 512 648.05442177c75.02040817 0 136.05442177-61.0340136 136.05442177-136.05442177a132.87074829 132.87074829 0 0 0-23.02040817-74.55782313l86.34013606-86.34013605C788.59863946 415.59183674 838.53061225 496.13605442 838.53061225 512c0 27.21088436-146.20408164 244.89795918-326.53061225 244.89795918m81.63265306-244.89795918a81.63265306 81.63265306 0 0 1-81.63265306 81.63265306c-12.57142858 0-24.35374149-3.07482994-34.93877551-8.21768708l108.3537415-108.35374149c5.14285714 10.58503402 8.21768708 22.36734695 8.21768707 34.93877551M185.46938775 512c0-27.21088436 146.20408164-244.89795918 326.53061225-244.89795918 56.21768708 0 109.11564626 21.17006803 155.31972789 51.10204082L312.62585034 672.89795918C235.40136054 608.40816326 185.46938775 527.86394558 185.46938775 512m564.68027212-199.67346939l77.65986395-77.65986394-38.47619049-38.47619049-83.02040815 83.02040818C649.30612245 240.48979591 582.9659864 212.68027211 512 212.68027211 302.17687076 212.68027211 131.04761905 453.33333333 131.04761905 512c0 33.49659863 55.89115647 126.20408164 142.80272108 199.67346939l-77.65986395 77.65986394 38.47619049 38.47619049 83.02040815-83.02040818C374.69387755 783.51020409 441.0340136 811.31972789 512 811.31972789c209.82312924 0 380.95238095-240.65306122 380.95238095-299.31972789 0-33.49659863-55.89115647-126.20408164-142.80272108-199.67346939"\r
    ></path>\r
    <path\r
        d="M512 375.94557823c-75.02040817 0-136.05442177 61.0340136-136.05442177 136.05442177 0 13.0340136 2.42176871 25.3877551 5.85034013 37.30612244l49.82312927-49.82312924a81.30612245 81.30612245 0 0 1 67.86394557-67.86394559l49.82312924-49.82312925A134.14965987 134.14965987 0 0 0 512 375.94557823"\r
    ></path>\r
</svg>`,F1=`<svg t="1734662466549" class="icon" viewBox="0 0 1024 1024" version="1.1"\r
    xmlns="http://www.w3.org/2000/svg" p-id="1803" width="30" height="30">\r
    <path\r
        d="M512 593.75888062a81.75888062 81.75888062 0 1 1 0-163.51776124 81.75888062 81.75888062 0 0 1 0 163.51776124m0-218.02368165c-75.13641129 0-136.26480103 61.12838974-136.26480103 136.26480103s61.12838974 136.26480103 136.26480103 136.26480103 136.26480103-61.12838974 136.26480103-136.26480103-61.12838974-136.26480103-136.26480103-136.26480103"\r
    ></path>\r
    <path\r
        d="M512 757.27664185c-180.60536727 0-327.03552247-218.02368164-327.03552247-245.27664185s146.43015518-245.27664185 327.03552247-245.27664185 327.03552247 218.02368164 327.03552247 245.27664185-146.43015518 245.27664185-327.03552247 245.27664185m0-545.05920411C301.85242385 212.21743774 130.45855713 453.24261779 130.45855713 512c0 58.75738221 171.39386673 299.78256226 381.54144287 299.78256226s381.54144287-241.02518006 381.54144287-299.78256226c0-58.75738221-171.39386673-299.78256226-381.54144287-299.78256226"\r
    ></path>\r
</svg>`,N1=`<svg t="1734662446529" class="icon" viewBox="0 0 1024 1024" version="1.1"\r
    xmlns="http://www.w3.org/2000/svg" p-id="1648" width="30" height="30">\r
    <path\r
        d="M512.90439453 698.38209636c-22.70214844 0.00922852-44.52758789-9.51459961-60.97280273-26.59658203L143.63457031 389.26373698c-16.3621582-14.99633789-18.50317383-41.6390625-4.77114258-59.51469726 13.73203125-17.86640625 38.13222656-20.2012207 54.50361329-5.20488282l311.86845703 285.8625c2.02104492 2.25175781 4.78037109 3.51606445 7.65966797 3.51606446 2.87929687 0 5.64785156-1.26430664 7.65966796-3.51606446l2.55629883-2.41787109L832.4140625 324.5441569c16.37138672-14.99633789 40.77158203-12.66152344 54.50361328 5.20488282 13.73203125 17.87563477 11.60024414 44.51835938-4.77114258 59.51469726L573.87719727 671.78551433c-16.44521484 17.08198242-38.2706543 26.60581055-60.97280274 26.59658203z m0 0"></path>\r
</svg>`;function G1(i,t){let e;return/fill=".*?"/.test(i)?e=i.replace(/fill=".*?"/g,`fill="${t}"`):e=i.replace(/<svg /g,`<svg fill="${t}" `),e}const wt={cancel:B1,del:R1,drag:E1,polygon:O1,rect:I1,save:M1,select:A1,select1:D1,unselect:$1,zoom_in:L1,zoom_out:W1,reset:z1,changeColor:G1,hide:U1,show:F1,down:N1},Y={};Y.MARKUP_NO_SELECT_TAG_TIPS="标注框必须关联一个标签";Y.DEFAULT_SELECT_TIPS="左键选取标注框";Y.DEFAULT_DRAG_TIPS="拖动画布";Y.DRAG_ING_TIPS="拖拽调整标注框";Y.RECT_START_TIPS="左键单击开始绘制，V键切换到选择模式";Y.RECT_END_TIPS="再次单击完成绘制，ESC取消绘制";Y.POLYGON_START_TIPS="左键单击开始绘制，V键切换到选择模式";Y.POLYGON_DRAWING_TIPS="左键单击添加点，ESC取消绘制，ENTER完成绘制";Y.MARKUP_OUT_OF_SAFE_ZONE_TIPS="标注框不可超出图片的有效区域";Y.MARKUP_MIN_SIZE_TIPS="标注框最小外接矩形不可小于10px*10px";Y.POLYGON_MIN_POINTS_TIPS="标注框必须大于三个点位";Y.POLYGON_QUICK_CLOSE_TIPS="左键单击快速闭合标注框";class pr extends Bt{constructor(e){super({id:e.data.id});x(this,"mark");x(this,"serial");x(this,"data");x(this,"color","red");x(this,"tagId",0);x(this,"tagName","");x(this,"tagText","");x(this,"tagTextUI");x(this,"delBtnUI");x(this,"tagBoxUI");x(this,"maskUI");x(this,"polygonUI");x(this,"ellipseGroupUI");x(this,"ellipseUI",[]);x(this,"isSelect",!1);x(this,"isComplete",!0);x(this,"isMoveing",!1);x(this,"isMovein",!1);x(this,"isEditing",!1);x(this,"__lastPoint",[]);x(this,"__fixedPoint",[]);x(this,"__editIndex",-1);x(this,"tipsText","");x(this,"tipsTextType","info");x(this,"isChange",!1);this.mark=e.app,this.data=e.data,this.serial=e.serial,this.isComplete=e.data.completed,this.visible;const s=this.mark.strokeWidth/this.mark.currentZoom;let n=this.mark.tags.find(d=>d.name===this.data.tagText);n&&(this.color=n.color,this.tagId=n.id,this.tagName=n.name,this.tagText=n.label),this.on(b.DOWN,d=>{if(this.mark.optStatus!=="drag"&&d.buttons===1){d.stop();let u=this.mark.convertPointToImage({x:d.x,y:d.y});this.mark.lastOriginPointDown={x:d.x,y:d.y},this.mark.lastPointDown=u,this.__lastPoint=[...this.data.points],this.isEditing||(this.isMoveing=!0),this.select()}}),this.on(b.MOVE,()=>{this.isMovein=!0,this.mark.optStatus==="select"&&(this.cursor="move",this.polygonUI.fill="rgba(0, 0, 0, 0.2)")}),this.on(b.LEAVE,()=>{this.isMovein=!1,this.polygonUI.fill="rgba(0, 0, 0, 0)"}),this.on(b.UP,()=>{this.isMoveing=!1,this.__editIndex=-1,this.__fixedPoint=[],this.tipsText="",this.tipsTextType="info",(!this.mark.isPointsInSafeZone(this.data.points)||!this.mark.checkOuterRectSize(this.data.points))&&(this.setPoints(this.__lastPoint),this.isChange=!1),this.isChange&&this.mark.saveCurrendData(),this.isChange=!1}),this.tagTextUI=new X({id:"tagText",text:this.tagText,fill:"white",fontSize:10/this.mark.currentZoom}),this.delBtnUI=new ri({id:"delBtn",url:S.toURL(wt.changeColor(wt.del,"#fff"),"svg"),width:18/this.mark.currentZoom,height:18/this.mark.currentZoom,cursor:"pointer",visible:0}),this.delBtnUI.on(b.CLICK,()=>{this.mark.deleteMark(this.id)}),this.tagBoxUI=new Ei({id:"tag",flow:"x",flowAlign:"center",visible:this.tagText?!0:0,gap:5/this.mark.currentZoom,fill:this.color,x:this.data.points[0].x,y:this.data.points[0].y-25/this.mark.currentZoom,padding:[5/this.mark.currentZoom,10/this.mark.currentZoom],around:"top-left",children:[this.tagTextUI,this.delBtnUI]}),this.add(this.tagBoxUI),this.tagBoxUI.on(b.DOWN,d=>{this.mark.optStatus!=="drag"&&d.buttons===1&&(d.stop(),this.select())}),this.polygonUI=new se({id:"polygon",points:this.data.points,fill:"rgba(0, 0, 0, 0)",strokeWidth:s,stroke:this.color}),this.add(this.polygonUI),this.maskUI=new se({id:"mask",points:this.data.points,fill:"rgba(0, 0, 0, 0.5)",strokeWidth:s,stroke:this.color,visible:0}),this.add(this.maskUI),this.ellipseGroupUI=new Bt({id:"ellipseGroup",opacity:0}),this.data.points.forEach((d,u)=>{const y=this.genEllipse(`ellipse-${u}`,s,d,this.color,u===0?"tl":u===1?"tr":u===2?"br":"bl");this.ellipseUI.push(y),this.ellipseGroupUI.add(y)});let r={x:this.data.points[0].x+(this.data.points[1].x-this.data.points[0].x)/2,y:this.data.points[0].y},o=this.genEllipse("ellipse-4",s,r,this.color,"t");this.ellipseUI.push(o),this.ellipseGroupUI.add(o);let a={x:this.data.points[2].x+(this.data.points[3].x-this.data.points[2].x)/2,y:this.data.points[2].y},h=this.genEllipse("ellipse-5",s,a,this.color,"b");this.ellipseUI.push(h),this.ellipseGroupUI.add(h);let l={x:this.data.points[0].x,y:this.data.points[1].y+(this.data.points[2].y-this.data.points[1].y)/2},c=this.genEllipse("ellipse-6",s,l,this.color,"l");this.ellipseUI.push(c),this.ellipseGroupUI.add(c);let p={x:this.data.points[1].x,y:this.data.points[0].y+(this.data.points[3].y-this.data.points[0].y)/2},f=this.genEllipse("ellipse-7",s,p,this.color,"r");this.ellipseUI.push(f),this.ellipseGroupUI.add(f),this.ellipseGroupUI.on(b.DOWN,d=>{if(d.buttons===1){this.isMoveing=!1,this.isEditing=!0;let u=Number(d.target.id.split("-")[1]),y=this.mark.convertPointToImage({x:d.x,y:d.y});this.mark.lastPointDown=y,this.__editIndex=u,this.__lastPoint=[...this.data.points],u<4?u===0?this.__fixedPoint=[this.data.points[2]]:u===1?this.__fixedPoint=[this.data.points[3]]:u===2?this.__fixedPoint=[this.data.points[0]]:u===3&&(this.__fixedPoint=[this.data.points[1]]):u===4?this.__fixedPoint=[this.data.points[2],this.data.points[3]]:u===5?this.__fixedPoint=[this.data.points[0],this.data.points[1]]:u===6?this.__fixedPoint=[this.data.points[1],this.data.points[2]]:u===7&&(this.__fixedPoint=[this.data.points[0],this.data.points[3]])}}),this.ellipseGroupUI.on(b.UP,()=>{this.isMoveing=!1,this.isEditing=!1}),this.add(this.ellipseGroupUI),this.mark.tree.add(this),this.isComplete||(this.__editIndex=3,this.__lastPoint=[...this.data.points],this.__fixedPoint=[this.data.points[0]],this.unCompleted())}genEllipse(e,s,n,r,o){return new Se({id:e,x:n.x,y:n.y,around:"center",width:s*4,height:s*4,fill:"white",strokeWidth:s*.5,stroke:r,cursor:o==="tr"||o==="bl"?"sw-resize":o==="tl"||o==="br"?"nw-resize":o==="t"||o==="b"?"n-resize":"e-resize"})}select(){if(this.mark.tipsErrorText){this.mark.emit("tips-error-text",{message:this.mark.tipsErrorText});return}if(!(this.mark.optStatus!=="select"&&this.mark.optStatus!=="rect")){for(let e of this.mark.markData)e.unSelect();this.isSelect=!0,this.delBtnUI.visible=!0,this.ellipseGroupUI.opacity=1,this.maskUI.visible=!0,this.mark.setSelect(this),this.showEllipse(),this.mark.emit("on-select",this)}}unSelect(){this.isSelect&&this.mark.emit("on-select",{}),this.isSelect=!1,this.ellipseGroupUI.opacity=0,this.maskUI.visible=0,this.tipsText="",this.tipsTextType="info",this.delBtnUI.visible=0}hideEllipse(){for(let e of this.ellipseUI)e.opacity=0}showEllipse(){for(let e of this.ellipseUI)e.opacity=1}unCompleted(){if(this.hideEllipse(),this.__fixedPoint[0]){let e=this.data.points.findIndex(n=>n.x===this.__fixedPoint[0].x&&n.y===this.__fixedPoint[0].y);this.ellipseUI[e].opacity=1;let s=e===0?2:e===1?3:e===2?0:1;this.ellipseUI[s].opacity=1}}hideTag(){this.tagBoxUI.visible=0}showTag(){this.tagBoxUI.visible=this.tagText?!0:0,this.tagTextUI.text=this.tagText}setTag(e){this.tagName=e.name,this.tagText=e.label,this.color=e.color,this.updateColor(),this.showTag()}updateColor(){this.tagBoxUI.fill=this.color,this.polygonUI.stroke=this.color,this.maskUI.stroke=this.color;for(let e of this.ellipseUI)e.stroke=this.color}onEditPoint(e){this.tipsText="",this.tipsTextType="info";let s=e;if(this.__fixedPoint.length===1){let n=[...this.__fixedPoint,s];n=[{x:n[0].x,y:n[0].y},{x:n[1].x,y:n[0].y},{x:n[1].x,y:n[1].y},{x:n[0].x,y:n[1].y}],this.setPoints(n)}else if(this.__fixedPoint.length===2){let n=[...this.__fixedPoint];this.__editIndex===4||this.__editIndex===5?(n.push({x:n[0].x,y:s.y}),n.push({x:n[1].x,y:s.y})):(n.push({x:s.x,y:n[0].y}),n.push({x:s.x,y:n[1].y})),this.setPoints(n)}}static twoPointToRect(e){return[{x:e[0].x,y:e[0].y},{x:e[1].x,y:e[0].y},{x:e[1].x,y:e[1].y},{x:e[0].x,y:e[1].y}]}movePoint(e){this.tipsText="",this.tipsTextType="info";let s=[];this.data.points.forEach((n,r)=>{s[r]={x:n.x+e.x,y:n.y+e.y}}),this.setPoints(s)}setPoints(e){this.isChange=!0,this.mark.isPointsInSafeZone(e)||(this.tipsText=Y.MARKUP_OUT_OF_SAFE_ZONE_TIPS,this.tipsTextType="warn"),this.data.points=e,this.data.points.sort((u,y)=>u.x-y.x);const s=this.data.points.slice(0,2),n=this.data.points.slice(2,4);s.sort((u,y)=>u.y-y.y),n.sort((u,y)=>u.y-y.y),this.data.points=[s[0],n[0],n[1],s[1]],this.mark.checkOuterRectSize(this.data.points)||(this.tipsText=Y.MARKUP_MIN_SIZE_TIPS,this.tipsTextType="error"),this.tagBoxUI.x=this.data.points[0].x,this.tagBoxUI.y=this.data.points[0].y-24/this.mark.currentZoom,this.polygonUI.points=this.data.points,this.maskUI.points=this.data.points;const r=this.mark.strokeWidth/this.mark.currentZoom;this.ellipseGroupUI.clear(),this.ellipseUI=[],this.data.points.forEach((u,y)=>{const v=this.genEllipse(`ellipse-${y}`,r,u,this.color,y===0?"tl":y===1?"tr":y===2?"br":"bl");this.ellipseUI.push(v),this.ellipseGroupUI.add(v)});let o={x:this.data.points[0].x+(this.data.points[1].x-this.data.points[0].x)/2,y:this.data.points[0].y},a=this.genEllipse("ellipse-4",r,o,this.color,"t");this.ellipseUI.push(a),this.ellipseGroupUI.add(a);let h={x:this.data.points[2].x+(this.data.points[3].x-this.data.points[2].x)/2,y:this.data.points[2].y},l=this.genEllipse("ellipse-5",r,h,this.color,"b");this.ellipseUI.push(l),this.ellipseGroupUI.add(l);let c={x:this.data.points[0].x,y:this.data.points[1].y+(this.data.points[2].y-this.data.points[1].y)/2},p=this.genEllipse("ellipse-6",r,c,this.color,"l");this.ellipseUI.push(p),this.ellipseGroupUI.add(p);let f={x:this.data.points[1].x,y:this.data.points[0].y+(this.data.points[3].y-this.data.points[0].y)/2},d=this.genEllipse("ellipse-7",r,f,this.color,"r");this.ellipseUI.push(d),this.ellipseGroupUI.add(d),this.isComplete||this.unCompleted()}setZoom(){const e=this.mark.strokeWidth/this.mark.currentZoom;this.tagTextUI.fontSize=10/this.mark.currentZoom,this.delBtnUI.width=12/this.mark.currentZoom,this.delBtnUI.height=12/this.mark.currentZoom,this.tagBoxUI.gap=5/this.mark.currentZoom,this.tagBoxUI.y=this.data.points[0].y-24/this.mark.currentZoom,this.tagBoxUI.padding=[5/this.mark.currentZoom,10/this.mark.currentZoom],this.polygonUI.strokeWidth=e,this.maskUI.strokeWidth=e,this.ellipseUI.forEach(s=>{s.width=e*4,s.height=e*4,s.strokeWidth=e*.5})}toData(){return{id:this.id,type:this.data.type,points:this.data.points,completed:this.isComplete,color:this.color,tagText:this.tagName}}toJsonData(){return{id:this.data.id,serial:this.serial,markup_type:this.data.type,markup_points:[...this.data.points],tag_category_id:this.tagId}}}class gr extends Bt{constructor(e){super({id:e.data.id});x(this,"mark");x(this,"data");x(this,"serial");x(this,"color","red");x(this,"tagId",0);x(this,"tagName","");x(this,"tagText","");x(this,"tagTextUI");x(this,"delBtnUI");x(this,"tagBoxUI");x(this,"maskUI");x(this,"polygonUI");x(this,"ellipseGroupUI");x(this,"ellipseUI",[]);x(this,"isSelect",!1);x(this,"isComplete",!0);x(this,"isMoveing",!1);x(this,"isMovein",!1);x(this,"isEditing",!1);x(this,"__lastPoint",[]);x(this,"__fixedPoint",[]);x(this,"__editIndex",-1);x(this,"tipsText","");x(this,"tipsTextType","info");x(this,"isChange",!1);this.mark=e.app,this.data=e.data,this.serial=e.serial,this.isComplete=e.data.completed;const s=this.mark.strokeWidth/this.mark.currentZoom;let n=this.mark.tags.find(r=>r.name===this.data.tagText);n&&(this.color=n.color,this.tagId=n.id,this.tagName=n.name,this.tagText=n.label),this.on(b.DOWN,r=>{if(this.mark.optStatus!=="drag"&&r.buttons===1){r.stop();let o=this.mark.convertPointToImage({x:r.x,y:r.y});this.mark.lastOriginPointDown={x:r.x,y:r.y},this.mark.lastPointDown=o,this.__lastPoint=[...this.data.points],this.isEditing||(this.isMoveing=!0),this.select()}}),this.on(b.MOVE,()=>{this.isMovein=!0,this.mark.optStatus==="select"&&(this.cursor="move",this.polygonUI.fill="rgba(0, 0, 0, 0.2)")}),this.on(b.LEAVE,()=>{this.isMovein=!1,this.polygonUI.fill="rgba(0, 0, 0, 0)"}),this.on(b.UP,()=>{this.isMoveing=!1,this.__editIndex=-1,this.__fixedPoint=[],this.tipsText="",this.tipsTextType="info",(!this.mark.isPointsInSafeZone(this.data.points)||!this.mark.checkOuterRectSize(this.data.points))&&(this.setPoints(this.__lastPoint),this.isChange=!1),this.isChange&&this.mark.saveCurrendData(),this.isChange=!1}),this.tagTextUI=new X({id:"tagText",text:this.tagText,fill:"white",fontSize:10/this.mark.currentZoom}),this.delBtnUI=new ri({id:"delBtn",url:S.toURL(wt.changeColor(wt.del,"#fff"),"svg"),width:18/this.mark.currentZoom,height:18/this.mark.currentZoom,cursor:"pointer",visible:0}),this.delBtnUI.on(b.CLICK,()=>{this.mark.deleteMark(this.id)}),this.tagBoxUI=new Ei({id:"tag",flow:"x",flowAlign:"center",visible:this.tagText?!0:0,gap:5/this.mark.currentZoom,fill:this.color,x:this.data.points[0].x,y:this.data.points[0].y-25/this.mark.currentZoom,padding:[5/this.mark.currentZoom,10/this.mark.currentZoom],around:"top-left",children:[this.tagTextUI,this.delBtnUI]}),this.tagBoxUI.on(b.DOWN,r=>{this.mark.optStatus!=="drag"&&r.buttons===1&&(r.stop(),this.select())}),this.polygonUI=new Fe({id:"polygon",path:this.data.points.reduce((r,o,a)=>r+(a===0?`M ${o.x} ${o.y}`:` L ${o.x} ${o.y}`),"")+(this.isComplete?" Z":""),fill:"rgba(0, 0, 0, 0)",strokeWidth:s,stroke:this.color}),this.add(this.polygonUI),this.maskUI=new Fe({id:"mask",path:this.data.points.reduce((r,o,a)=>r+(a===0?`M ${o.x} ${o.y}`:` L ${o.x} ${o.y}`),"")+(this.isComplete?" Z":""),fill:"rgba(0, 0, 0, 0.5)",strokeWidth:s,stroke:this.color,visible:0}),this.add(this.maskUI),this.ellipseGroupUI=new Bt({id:"ellipseGroup",opacity:0}),this.data.points.forEach((r,o)=>{const a=this.genEllipse(`ellipse-${o}`,s,r,this.color);this.ellipseUI.push(a),this.ellipseGroupUI.add(a)}),this.ellipseGroupUI.on(b.DOWN,r=>{if(r.buttons===1){this.isMoveing=!1,this.isEditing=!0;let o=Number(r.target.id.split("-")[1]),a=this.mark.convertPointToImage({x:r.x,y:r.y});this.mark.lastPointDown=a,this.__editIndex=o,this.__lastPoint=[...this.data.points]}}),this.ellipseGroupUI.on(b.UP,()=>{this.isMoveing=!1,this.isEditing=!1}),this.add(this.tagBoxUI),this.add(this.ellipseGroupUI),this.mark.tree.add(this),this.isComplete||(this.__editIndex=3,this.__lastPoint=[...this.data.points],this.__fixedPoint=[this.data.points[0]],this.unCompleted())}genEllipse(e,s,n,r){return new Se({id:e,x:n.x,y:n.y,around:"center",width:s*4,height:s*4,fill:"white",strokeWidth:s*.5,stroke:r,cursor:"alias"})}select(){if(this.mark.tipsErrorText){this.mark.emit("tips-error-text",{message:this.mark.tipsErrorText});return}if(!(this.mark.optStatus!=="select"&&this.mark.optStatus!=="polygon")){for(let e of this.mark.markData)e.unSelect();this.isSelect=!0,this.delBtnUI.visible=!0,this.ellipseGroupUI.opacity=1,this.maskUI.visible=!0,this.mark.setSelect(this),this.showEllipse(),this.mark.emit("on-select",this)}}unSelect(){this.isSelect&&this.mark.emit("on-select",{}),this.isSelect=!1,this.ellipseGroupUI.opacity=0,this.maskUI.visible=0,this.tipsText="",this.tipsTextType="info",this.delBtnUI.visible=0}hideEllipse(){for(let e of this.ellipseUI)e.opacity=0}showEllipse(){for(let e of this.ellipseUI)e.opacity=1}unCompleted(){}hideTag(){this.tagBoxUI.visible=0}showTag(){this.tagBoxUI.visible=this.tagText?!0:0,this.tagTextUI.text=this.tagText}setTag(e){this.tagName=e.name,this.tagText=e.label,this.color=e.color,this.updateColor(),this.showTag()}updateColor(){this.tagBoxUI.fill=this.color,this.polygonUI.stroke=this.color,this.maskUI.stroke=this.color;for(let e of this.ellipseUI)e.stroke=this.color}onEditPoint(e){this.tipsText="",this.tipsTextType="info";let s=e,n=[...this.data.points];n[this.__editIndex]=s,this.setPoints(n)}movePoint(e){this.tipsText="",this.tipsTextType="info";let s=[];this.data.points.forEach((n,r)=>{s[r]={x:n.x+e.x,y:n.y+e.y}}),this.setPoints(s)}addPoint(e){let s=[...this.data.points];s.push(e),this.setPoints(s)}closePath(){return this.mark.isPointsInSafeZone(this.data.points)?this.data.points.length<3?"标注框必须大于三个点位":this.mark.checkOuterRectSize(this.data.points)?(this.setPoints(this.data.points,!0),this.__editIndex=-1,""):"标注框最小外接矩形不可小于10px*10px":"标注框不可超出图片的有效区域"}setPoints(e,s=!1){this.isChange=!0,this.mark.isPointsInSafeZone(e)||(this.tipsText=Y.MARKUP_OUT_OF_SAFE_ZONE_TIPS,this.tipsTextType="warn"),this.data.points=e,e.length<3?(this.tipsText=Y.POLYGON_MIN_POINTS_TIPS,this.tipsTextType="warn"):this.mark.checkOuterRectSize(e)||(this.tipsText=Y.MARKUP_MIN_SIZE_TIPS,this.tipsTextType="error"),this.tagBoxUI.x=this.data.points[0].x,this.tagBoxUI.y=this.data.points[0].y-24/this.mark.currentZoom;const n=this.mark.strokeWidth/this.mark.currentZoom;if(this.ellipseGroupUI.clear(),this.ellipseUI=[],this.data.points.forEach((r,o)=>{const a=this.genEllipse(`ellipse-${o}`,n,r,this.color);this.ellipseUI.push(a),this.ellipseGroupUI.add(a)}),e.length>=3&&!this.isComplete){let r=e[0],o=e[e.length-1],a=Math.abs(o.x-r.x)*this.mark.currentZoom,h=Math.abs(o.y-r.y)*this.mark.currentZoom;a<10&&h<10&&(this.ellipseUI[0].scale=1.5,this.ellipseUI[e.length-1].opacity=0,this.tipsText=Y.POLYGON_QUICK_CLOSE_TIPS,this.tipsTextType="info",this.data.points[e.length-1]=this.data.points[0])}this.polygonUI.path=this.data.points.reduce((r,o,a)=>r+(a===0?`M ${o.x} ${o.y}`:` L ${o.x} ${o.y}`),"")+(this.isComplete||s?" Z":""),this.maskUI.path=this.polygonUI.path,this.isComplete||this.unCompleted()}setZoom(){const e=this.mark.strokeWidth/this.mark.currentZoom;this.tagTextUI.fontSize=10/this.mark.currentZoom,this.delBtnUI.width=12/this.mark.currentZoom,this.delBtnUI.height=12/this.mark.currentZoom,this.tagBoxUI.gap=5/this.mark.currentZoom,this.tagBoxUI.y=this.data.points[0].y-24/this.mark.currentZoom,this.tagBoxUI.padding=[5/this.mark.currentZoom,10/this.mark.currentZoom],this.polygonUI.strokeWidth=e,this.maskUI.strokeWidth=e,this.ellipseUI.forEach(s=>{s.width=e*4,s.height=e*4,s.strokeWidth=e*.5})}toData(){return{id:this.id,type:this.data.type,points:this.data.points,completed:this.isComplete,color:this.color,tagText:this.tagText}}toJsonData(){return{id:this.data.id,serial:this.serial,markup_type:this.data.type,markup_points:[...this.data.points],tag_category_id:this.tagId}}}const H1=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-8][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/i;function j1(i){return typeof i=="string"&&H1.test(i)}function V1(i){if(!j1(i))throw TypeError("Invalid UUID");let t;return Uint8Array.of((t=parseInt(i.slice(0,8),16))>>>24,t>>>16&255,t>>>8&255,t&255,(t=parseInt(i.slice(9,13),16))>>>8,t&255,(t=parseInt(i.slice(14,18),16))>>>8,t&255,(t=parseInt(i.slice(19,23),16))>>>8,t&255,(t=parseInt(i.slice(24,36),16))/1099511627776&255,t/4294967296&255,t>>>24&255,t>>>16&255,t>>>8&255,t&255)}const xt=[];for(let i=0;i<256;++i)xt.push((i+256).toString(16).slice(1));function eo(i,t=0){return(xt[i[t+0]]+xt[i[t+1]]+xt[i[t+2]]+xt[i[t+3]]+"-"+xt[i[t+4]]+xt[i[t+5]]+"-"+xt[i[t+6]]+xt[i[t+7]]+"-"+xt[i[t+8]]+xt[i[t+9]]+"-"+xt[i[t+10]]+xt[i[t+11]]+xt[i[t+12]]+xt[i[t+13]]+xt[i[t+14]]+xt[i[t+15]]).toLowerCase()}let yr;const Y1=new Uint8Array(16);function lh(){if(!yr){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");yr=crypto.getRandomValues.bind(crypto)}return yr(Y1)}const Ki={};function Z1(i,t,e){var r;let s;const n=(i==null?void 0:i._v6)??!1;if(i){const o=Object.keys(i);o.length===1&&o[0]==="_v6"&&(i=void 0)}if(i)s=ch(i.random??((r=i.rng)==null?void 0:r.call(i))??lh(),i.msecs,i.nsecs,i.clockseq,i.node,t,e);else{const o=Date.now(),a=lh();K1(Ki,o,a),s=ch(a,Ki.msecs,Ki.nsecs,n?void 0:Ki.clockseq,n?void 0:Ki.node,t,e)}return t?s:eo(s)}function K1(i,t,e){return i.msecs??(i.msecs=-1/0),i.nsecs??(i.nsecs=0),t===i.msecs?(i.nsecs++,i.nsecs>=1e4&&(i.node=void 0,i.nsecs=0)):t>i.msecs?i.nsecs=0:t<i.msecs&&(i.node=void 0),i.node||(i.node=e.slice(10,16),i.node[0]|=1,i.clockseq=(e[8]<<8|e[9])&16383),i.msecs=t,i}function ch(i,t,e,s,n,r,o=0){r||(r=new Uint8Array(16),o=0),t??(t=Date.now()),e??(e=0),s??(s=(i[8]<<8|i[9])&16383),n??(n=i.slice(10,16)),t+=122192928e5;const a=((t&268435455)*1e4+e)%4294967296;r[o++]=a>>>24&255,r[o++]=a>>>16&255,r[o++]=a>>>8&255,r[o++]=a&255;const h=t/4294967296*1e4&268435455;r[o++]=h>>>8&255,r[o++]=h&255,r[o++]=h>>>24&15|16,r[o++]=h>>>16&255,r[o++]=s>>>8|128,r[o++]=s&255;for(let l=0;l<6;++l)r[o++]=n[l];return r}function X1(i){const t=typeof i=="string"?V1(i):i,e=q1(t);return typeof i=="string"?eo(e):e}function q1(i){return Uint8Array.of((i[6]&15)<<4|i[7]>>4&15,(i[7]&15)<<4|(i[4]&240)>>4,(i[4]&15)<<4|(i[5]&240)>>4,(i[5]&15)<<4|(i[0]&240)>>4,(i[0]&15)<<4|(i[1]&240)>>4,(i[1]&15)<<4|(i[2]&240)>>4,96|i[2]&15,i[3],i[8],i[9],i[10],i[11],i[12],i[13],i[14],i[15])}function dh(i,t,e){i??(i={});let s=Z1({...i,_v6:!0},new Uint8Array(16));return s=X1(s),eo(s)}class Q1{constructor(t){x(this,"id");x(this,"type");x(this,"points");x(this,"completed");x(this,"color");x(this,"tagText");this.id=t.id,this.type=t.type,this.points=t.points,this.completed=!!t.completed,this.color=t.color||"red",this.tagText=t.tag_name||""}}let J1=class extends Sr{constructor(e){const s="custom";super({view:e.view,ground:{type:s},tree:{type:s},sky:{type:s,usePartRender:!1}});x(this,"backgroundSize",{width:1280,height:720});x(this,"backgroundUrl");x(this,"background");x(this,"data");x(this,"markData",[]);x(this,"markSerial",0);x(this,"tags");x(this,"selectMark");x(this,"optStatus");x(this,"drawStatus");x(this,"initZoom");x(this,"currentZoom");x(this,"initOffset");x(this,"currentOffset");x(this,"lastOriginPointDown");x(this,"lastPointMove");x(this,"lastPointDown");x(this,"lastTapUI");x(this,"isMoving",!1);x(this,"strokeWidth",3);x(this,"verticalLine");x(this,"horizontalLine");x(this,"tipsTextBox");x(this,"tipsText");x(this,"tipsErrorText","");x(this,"tipsTimeer",0);x(this,"activeTagName");x(this,"maxHistoryRecords",20);x(this,"maxFutureRecords",20);x(this,"currentData");x(this,"historyRecords",[]);x(this,"futureRecords",[]);this.backgroundUrl=e.image,this.data=e.data,this.tags=e.tags,this.optStatus="select",this.drawStatus="none",this.initZoom=1,this.currentZoom=1,this.initOffset={x:0,y:0},this.currentOffset={x:0,y:0},this.background=new ri,this.verticalLine=new dt({x:-2,y:-2,width:this.width*10,height:this.height+4,stroke:"#000",strokeWidth:.5,opacity:1,dashPattern:[5,2],hittable:!1}),this.horizontalLine=new dt({x:-2,y:-2,width:this.width+4,height:this.height*10,stroke:"#000",strokeWidth:.5,opacity:1,dashPattern:[5,2],hittable:!1}),this.tipsTextBox=new dt({x:this.width,y:this.height,fill:"#fff"}),this.tipsText=new X({id:"tipsText",text:Y.DEFAULT_SELECT_TIPS,fill:"#000",fontSize:12,padding:[2,5]}),this.sky.add(this.verticalLine),this.sky.add(this.horizontalLine),this.tipsTextBox.add(this.tipsText),this.sky.add(this.tipsTextBox),this.tipsTimeer=setInterval(()=>{this.updateTipsText()},1e3/30),this.on(jt.ZOOM,n=>{let r=.1,o=n.scale>1?this.currentZoom+r:this.currentZoom-r;this.setZoom(o,{x:n.x,y:n.y})}),this.on(yt.START,()=>{this.setMoveingStatus(!0)}),this.on(yt.END,()=>{this.setMoveingStatus(!1)}),this.on(yt.MOVE,n=>{this.updateTipsPosition(n),this.setMoveingStatus(!0),this.ground.moveWorld(n.moveX,n.moveY),this.tree.moveWorld(n.moveX,n.moveY),this.currentOffset={x:this.ground.x,y:this.ground.y}}),this.on(b.DOWN,n=>{if(n.buttons===1){if(this.tipsErrorText){this.emit("tips-error-text",{message:this.tipsErrorText});return}this.lastOriginPointDown={x:n.x,y:n.y};let r=this.convertPointToImage({x:n.x,y:n.y});if(this.optStatus==="drag")this.cursor="grabbing";else if(this.optStatus==="rect"&&!n.spaceKey){let o=this.forcePointToValidArea(r);if(this.drawStatus==="none"){this.drawStatus="draw",this.emit("draw-start");let a=new pr({app:this,data:{id:dh(),type:"rect",points:[o,o,o,o],completed:!1,color:"",tagText:""},serial:++this.markSerial});this.markData.push(a),a.hittable=!1,a.select()}else if(this.drawStatus==="draw"&&this.selectMark&&!this.selectMark.tipsText){let a=this.selectMark;this.drawStatus="none",this.emit("draw-end"),this.compareTag(a)}}else if(this.optStatus==="polygon"&&!n.spaceKey){let o=this.forcePointToValidArea(r);if(this.drawStatus==="none"){this.drawStatus="draw",this.emit("draw-start");let a=new gr({app:this,data:{id:dh(),type:"polygon",points:[o],completed:!1,color:"",tagText:""},serial:++this.markSerial});this.markData.push(a),a.hittable=!1,a.select(),a.__editIndex=1}else if(this.drawStatus==="draw"&&this.selectMark){let a=this.selectMark.data.points[0],h=this.selectMark.data.points[this.selectMark.data.points.length-1];if(a.x===h.x&&a.y===h.y){let l=this.selectMark.closePath();l?this.emit("tips-error-text",{message:l}):(this.drawStatus="none",this.emit("draw-end"),this.compareTag(this.selectMark))}else this.selectMark.addPoint(o),this.selectMark.__editIndex=this.selectMark.data.points.length}}else n.spaceKey||this.unSelect()}}),this.on(b.MOVE,n=>{var o;if(this.lastPointMove&&this.lastPointMove.x===n.x&&this.lastPointMove.y===n.y)return;this.lastPointMove={x:n.x,y:n.y},this.updateTipsPosition(n);let r=this.convertPointToImage({x:n.x,y:n.y});if(this.optStatus==="select")if(this.cursor="move",this.lastPointDown&&((o=this.selectMark)!=null&&o.isSelect))if(this.drawStatus="edit",this.selectMark.isMoveing){let a={x:r.x-this.lastPointDown.x,y:r.y-this.lastPointDown.y};this.selectMark.movePoint(a),this.lastPointDown=r}else this.selectMark.isEditing?this.selectMark.onEditPoint(r):this.drawStatus="none";else this.drawStatus="none";else if(this.optStatus==="rect"||this.optStatus==="polygon"){this.cursor="crosshair";let a=this.forcePointToValidArea(r);this.drawStatus==="draw"&&this.optStatus==="rect"?this.selectMark.onEditPoint(a):this.drawStatus==="draw"&&this.optStatus==="polygon"&&this.selectMark.onEditPoint(a)}else if(this.optStatus==="drag"){if(this.cursor="grab",this.lastOriginPointDown){this.cursor="grabbing";let a={x:n.x-this.lastOriginPointDown.x,y:n.y-this.lastOriginPointDown.y};const{interaction:h}=this;h.move({x:this.lastOriginPointDown.x,y:this.lastOriginPointDown.y,moveX:a.x,moveY:a.y}),this.lastOriginPointDown={x:n.x,y:n.y}}}else this.drawStatus="none";this.drawStatus==="edit"&&this.hideAllTag()}),this.on(b.UP,()=>{this.lastOriginPointDown=void 0,this.showAllTag(),this.lastTapUI=void 0,this.optStatus==="drag"&&(this.cursor="grab")}),this.on(Ge.RESIZE,n=>{let r={width:n.width,height:n.height},o=r.width/this.backgroundSize.width,a=r.height/this.backgroundSize.height;this.initZoom=Math.min(o,a);let h=(r.width-this.backgroundSize.width*this.initZoom)/2,l=(r.height-this.backgroundSize.height*this.initZoom)/2;this.initOffset={x:h,y:l},this.verticalLine.height=r.height+4,this.horizontalLine.width=r.width+4,this.resetZoomOrOffset()})}saveCurrendData(e=!0){var s;if(this.drawStatus!="draw")return this.currentData&&(this.historyRecords.push(this.currentData),this.historyRecords.length>this.maxHistoryRecords&&this.historyRecords.shift()),this.currentData={datas:this.markData.map(n=>n.toData()),serials:this.markData.map(n=>n.serial),visibles:this.markData.map(n=>n.visible),selectMark:(s=this.selectMark)==null?void 0:s.id,optStatus:this.optStatus},e&&(this.futureRecords=[]),this.emit("records-change"),this.currentData}setCurrentData(){if(this.currentData){this.optStatus=this.currentData.optStatus,this.drawStatus="none",this.tree.clear(),this.markData=[],this.selectMark=void 0;for(let e=0;e<this.currentData.datas.length;e++){let s=this.currentData.datas[e],n=this.currentData.serials[e],r;s.type==="rect"?(r=new pr({app:this,data:s,serial:n}),this.markData.push(r)):s.type==="polygon"&&(r=new gr({app:this,data:s,serial:n}),this.markData.push(r)),r&&(r.visible=this.currentData.visibles[e],r.id===this.currentData.selectMark&&r.select())}}}cancelRecords(){if(this.drawStatus!=="none")return;let e=this.historyRecords.pop();e&&(this.futureRecords.unshift(this.currentData),this.futureRecords.length>this.maxHistoryRecords&&this.futureRecords.pop(),this.currentData=e,this.setCurrentData(),this.emit("records-change"))}recoverRecords(){if(this.drawStatus!=="none")return;let e=this.futureRecords.shift();e&&(this.historyRecords.push(this.currentData),this.historyRecords.length>this.maxHistoryRecords&&this.historyRecords.shift(),this.currentData=e,this.setCurrentData(),this.emit("records-change"))}clearRecords(){this.historyRecords=[],this.futureRecords=[],this.currentData=void 0,this.saveCurrendData(),this.emit("records-change")}allHittable(e){for(let s of this.markData)s.hittable=!!e}hideAllTag(){for(let e of this.markData)e.hideTag()}showAllTag(){for(let e of this.markData)e.showTag()}async initCanvas(){await new Promise((a,h)=>{this.background.url=this.backgroundUrl,this.background.once(Zt.LOADED,()=>{a(null)}),this.background.once(Zt.ERROR,l=>{h(l)}),this.ground.add(this.background)}),this.backgroundSize={width:this.background.width,height:this.background.height};let e=this.width/this.backgroundSize.width,s=this.height/this.backgroundSize.height;this.initZoom=Math.min(e,s);let n=(this.width-this.backgroundSize.width*this.initZoom)/2,r=(this.height-this.backgroundSize.height*this.initZoom)/2;this.initOffset={x:n,y:r},this.setZoom(this.initZoom,this.initOffset),this.setOffset(this.initOffset),this.markData=[],this.markSerial=0,this.data.forEach(a=>{a.type==="rect"?this.markData.push(new pr({app:this,data:a,serial:++this.markSerial})):a.type==="polygon"&&this.markData.push(new gr({app:this,data:a,serial:++this.markSerial}))});let o=this.markData[this.markData.length-1];o&&(this.activeTagName=o.tagName||""),this.saveCurrendData()}isPointsInSafeZone(e){return e.every(s=>s.x>=0&&s.y>=0&&s.x<=this.backgroundSize.width&&s.y<=this.backgroundSize.height)}checkOuterRectSize(e){let s=Math.min(...e.map(l=>l.x)),n=Math.min(...e.map(l=>l.y)),r=Math.max(...e.map(l=>l.x)),o=Math.max(...e.map(l=>l.y)),a=r-s,h=o-n;return a>10&&h>10}setDrawStatus(e){if(this.tipsErrorText){this.emit("tips-error-text",{message:this.tipsErrorText});return}return this.isMoving||this.drawStatus!=="none"?!1:(this.optStatus=e,this.cursor="crosshair",this.emit("draw-type-change",{type:e}),this.unSelect(),this.allHittable(!1),!0)}setSelectMode(){this.drawStatus!=="draw"&&(this.optStatus="select",this.cursor="move",this.allHittable(!0))}cancelDraw(){if(this.drawStatus==="draw"&&(this.optStatus==="rect"||this.optStatus==="polygon")){this.drawStatus="none",this.emit("draw-end"),this.unSelect();let e=this.markData.pop();e&&e.remove()}}enterDraw(){if(this.drawStatus==="draw"&&this.selectMark&&this.optStatus==="polygon"){let e=this.selectMark.closePath();e?this.emit("tips-error-text",{message:e}):(this.drawStatus="none",this.emit("draw-end"),this.compareTag(this.selectMark),this.saveCurrendData())}}updateMarkPoints(e,s){const n=this.strokeWidth/this.currentZoom;let r=this.markData[e];r.findOne("#tag").x=s[0].x,r.findOne("#tag").y=s[0].y-38,r.findOne("#polygon").points=s,r.findOne("#mask").points=s;let o=r.findOne("#ellipseGroup");s.forEach((a,h)=>{let l=`ellipse-${h}`,c=o.findOne(l);c?(c.x=a.x,c.y=a.y):o.add(new Se({id:l,x:a.x,y:a.y,around:"center",width:n*2,height:n*2,fill:r.findOne("#polygon").stroke}))})}setSelect(e){this.selectMark=e}unSelect(){this.selectMark&&(this.selectMark.unSelect(),this.selectMark=void 0)}updateTag(e){let s=this.tags.find(n=>n.name===e.name);if(s){s.label=e.label,s.color=e.color,s.shortcutKey=e.shortcutKey;for(let n of this.markData)n.tagName===s.name&&n.setTag(s);this.clearRecords()}else this.tags.push(e)}appendTag(e){this.tags.find(n=>n.name===e.name)||this.tags.push(e)}setCurrentTag(e,s,n=!0){if(this.drawStatus!=="draw"){if(s=s||this.selectMark,s){let r=s.tagName;s.setTag(e),this.tipsErrorText===Y.MARKUP_NO_SELECT_TAG_TIPS&&(this.tipsErrorText=""),s.isComplete=!0,this.optStatus==="rect"||this.optStatus==="polygon"?(s.isSelect&&s.select(),s.hideEllipse()):this.optStatus==="select"&&s.isSelect&&s.select(),n&&r!==e.name&&this.saveCurrendData()}this.activeTagName=e.name}}hideMark(e,s=!0){let n=this.markData.findIndex(r=>r.id===e);n!==-1&&(this.markData[n].visible=0,this.selectMark&&this.selectMark.id===e&&this.markData[n].unSelect(),s&&this.saveCurrendData())}batchHideMark(e){for(let s of e)this.hideMark(s,!1);this.saveCurrendData()}showMark(e,s=!0){let n=this.markData.findIndex(r=>r.id===e);n!==-1&&(this.markData[n].visible=!0,s&&this.saveCurrendData())}batchShowMark(e){for(let s of e)this.showMark(s,!1);this.saveCurrendData()}compareTag(e){if(e.tagText)this.tipsErrorText="";else if(this.tipsErrorText=Y.MARKUP_NO_SELECT_TAG_TIPS,this.activeTagName){let s=this.tags.find(n=>n.name===this.activeTagName);s&&(this.tipsErrorText="",this.setCurrentTag(s,e))}}deleteMark(e,s=!0){let n=this.markData.findIndex(r=>r.id===e);n!==-1&&(this.markData[n].remove(),this.markData.splice(n,1),this.selectMark&&this.selectMark.id===e&&(this.selectMark=void 0),s&&this.saveCurrendData())}selectById(e){if(this.selectMark&&this.selectMark.id===e)return;if(this.tipsErrorText){this.emit("tips-error-text",{message:this.tipsErrorText});return}let s=this.markData.find(n=>n.id===e);s&&(this.selectMark&&this.selectMark.unSelect(),s.select(),this.saveCurrendData())}batchDeleteMark(e){for(let s of e)this.deleteMark(s,!1);this.saveCurrendData()}setZoom(e,s={x:0,y:0}){if(e<.03)return;let n=e*this.backgroundSize.width,r=e*this.backgroundSize.height;if(n<20||r<20)return;let o=e/this.currentZoom;Yt.zoomOfWorld(this.ground,s,o),Yt.zoomOfWorld(this.tree,s,o),this.currentZoom=this.ground.scale,this.currentOffset={x:this.ground.x,y:this.ground.y},this.markData.forEach(a=>{a.setZoom()})}setOffset(e){this.ground.x=e.x,this.ground.y=e.y,this.tree.x=e.x,this.tree.y=e.y,this.currentOffset=e}resetZoomOrOffset(){this.setZoom(this.initZoom,this.initOffset),this.setOffset(this.initOffset)}forcePointToValidArea(e){let s={...e};return s.x<0&&(s.x=0),s.y<0&&(s.y=0),s.x>this.backgroundSize.width&&(s.x=this.backgroundSize.width),s.y>this.backgroundSize.height&&(s.y=this.backgroundSize.height),s}convertPointToImage(e){return{x:(e.x-this.currentOffset.x)/this.currentZoom,y:(e.y-this.currentOffset.y)/this.currentZoom}}convertPointToCanvas(e){return{x:e.x*this.currentZoom+this.currentOffset.x,y:e.y*this.currentZoom+this.currentOffset.y}}setMoveingStatus(e){this.isMoving=e,this.emit("move-status-change",{status:e})}updateTipsPosition(e){this.verticalLine.x=e.x,this.horizontalLine.y=e.y,this.tipsTextBox.x=e.x+15,this.tipsTextBox.y=e.y+15}updateTipsText(){if(this.isMoving)return this.tipsTextBox.opacity=0;if(this.tipsTextBox.opacity=1,this.tipsTextBox.fill="#fff",this.tipsText.fill="#000",this.tipsErrorText){this.tipsText.text=this.tipsErrorText,this.tipsTextBox.fill="#EE5850",this.tipsText.fill="#fff";return}this.optStatus==="select"?this.tipsText.text=Y.DEFAULT_SELECT_TIPS:this.optStatus==="drag"?this.tipsText.text=Y.DEFAULT_DRAG_TIPS:this.optStatus==="rect"?this.drawStatus==="none"?this.tipsText.text=Y.RECT_START_TIPS:this.drawStatus==="draw"&&(this.tipsText.text=Y.RECT_END_TIPS):this.optStatus==="polygon"&&(this.drawStatus==="none"?this.tipsText.text=Y.POLYGON_START_TIPS:this.drawStatus==="draw"&&(this.tipsText.text=Y.POLYGON_DRAWING_TIPS)),this.selectMark&&(this.selectMark.tipsText?(this.tipsText.text=this.selectMark.tipsText,this.tipsTextBox.fill={info:"#fff",warn:"#F56A4B",error:"#EE5850"}[this.selectMark.tipsTextType]||"#fff",this.tipsText.fill={info:"#000",warn:"#fff",error:"#fff"}[this.selectMark.tipsTextType]||"#000"):this.selectMark.isMoveing?this.tipsText.text=Y.DRAG_ING_TIPS:this.selectMark.isEditing?this.tipsText.text=Y.DRAG_ING_TIPS:this.selectMark.isMovein&&(this.tipsText.text=Y.DRAG_ING_TIPS))}getMarkItemSimpleList(){return this.markData.map(s=>({id:s.id,serial:s.serial,type:s.data.type,tagName:s.tagName,visible:s.visible}))}toJsonData(){if(this.tipsErrorText)throw new Error(this.tipsErrorText);let e=[];return this.markData.forEach(s=>{s.isComplete&&s.tagId&&e.push(s.toJsonData())}),e}destroy(){clearInterval(this.tipsTimeer),super.destroy()}};const tg={class:"markup-canvas"},eg={class:"canvas-box"},ig={key:0,class:"tools-box"},sg=["type","title","onClick"],ng=["innerHTML"],rg={key:1,class:"divider"},og={class:"canvas",id:"markup-canvas",ref:"leaferView"},ag={key:0,class:"markup-box"},hg={class:"markup-sub-box"},lg=["onClick"],cg={class:"text"},dg=["innerHTML"],ug=["onUpdate:modelValue","onChange"],fg=["onUpdate:modelValue","onChange"],_g={key:0,class:"key"},pg={class:"markup-sub-box markup-list"},gg=fh({__name:"index",props:{tags:{},image:{},markerData:{},algType:{},showToolsBar:{type:Boolean,default:!0},showSiderBar:{type:Boolean,default:!0}},emits:["error","save","delete"],setup(i,{emit:t}){const e=i,s=gt([{title:"矩形",name:"rect",show:!0,disabled:!1,icon:wt.rect},{title:"多边形",name:"polygon",show:!0,icon:wt.polygon},"divider",{title:"选择",name:"select",active:!0,show:!0,disabled:!1,icon:wt.select},"divider",{title:"保存",name:"save",show:!0,disabled:!1,icon:wt.save},{title:"撤销",name:"cancel",show:!0,disabled:!0,icon:wt.cancel},{title:"恢复",name:"recover",show:!0,disabled:!0,icon:wt.cancel,icon_re:!0},"divider",{title:"拖动",name:"drag",show:!0,disabled:!1,icon:wt.drag},{title:"放大",name:"zoom_in",show:!0,disabled:!1,icon:wt.zoom_in},{title:"缩小",name:"zoom_out",show:!0,disabled:!1,icon:wt.zoom_out},{title:"复位",name:"reset",show:!0,disabled:!1,icon:wt.reset},"divider",{title:"删除图片",name:"del",show:!0,disabled:!1,icon:wt.del}]);var n;const r=gt(!1);function o(g){let A=n.convertPointToCanvas({x:n.backgroundSize.width/2,y:n.backgroundSize.height/2}),P=parseInt(g.key);if(g.code==="KeyV")y("select")&&n.setSelectMode();else if(g.code==="Escape")n.cancelDraw();else if(g.ctrlKey&&(g.code==="Minus"||g.code==="NumpadSubtract"))n.setZoom(n.currentZoom-.1,A),g.preventDefault();else if(g.ctrlKey&&(g.code==="Equal"||g.code==="NumpadAdd"))n.setZoom(n.currentZoom+.1,A),g.preventDefault();else if(g.ctrlKey&&g.code==="KeyR")n.resetZoomOrOffset(),g.preventDefault();else if(g.code==="F2")v(),g.preventDefault();else if(g.code==="Enter"||g.code==="NumpadEnter")p.value&&n.enterDraw();else if(g.code==="KeyR"){let B=s.value.find($=>$!=="divider"&&$.name==="rect");B&&!B.disabled&&n.setDrawStatus("rect")}else if(g.code==="KeyP"){let B=s.value.find($=>$!=="divider"&&$.name==="polygon");B&&!B.disabled&&n.setDrawStatus("rect")}else if(g.code==="Delete")p.value?n.cancelDraw():n.selectMark&&n.deleteMark(n.selectMark.id);else if(g.ctrlKey&&g.shiftKey&&g.code==="KeyZ")n.recoverRecords();else if(g.ctrlKey&&g.code==="KeyZ")n.cancelRecords();else if(P>=0||P<=9){let B=h.value.find($=>$.shortcutKey===P.toString());B&&n.selectMark&&n.setCurrentTag(B)}}const a=t,h=gt([]),l=gt(""),c=gt(""),p=gt(!1),f=gt([]),d=gt([]);Tl(f,(g,A)=>{const P=g.reduce(($,mt)=>{const{tagName:Tt}=mt;return $[Tt]||($[Tt]=[]),$[Tt].push(mt),$},{}),B=Object.entries(P).map(([$,mt])=>({tagName:$,children:mt}));d.value=B},{immediate:!0}),Sl(async()=>{s.value[0].disabled=e.algType!=="obj_detect",s.value[1].disabled=e.algType!=="obj_seg",h.value=JSON.parse(JSON.stringify(e.tags)),n=new J1({view:"markup-canvas",image:e.image,data:e.markerData.map(g=>{let A=JSON.parse(JSON.stringify(g));return A.completed=A.completed===void 0?!0:A.completed,new Q1(A)}),tags:JSON.parse(JSON.stringify(e.tags))}),await n.initCanvas(),f.value=n.getMarkItemSimpleList(),n.on("move-status-change",g=>{r.value=g.status}),n.on("draw-type-change",g=>{y(g.type)}),n.on("tips-error-text",g=>{a("error",g.message)}),n.on("on-select",g=>{l.value=g.id||"",c.value=g.tagName||""}),n.on("draw-start",()=>{p.value=!0}),n.on("draw-end",()=>{p.value=!1,f.value=n.getMarkItemSimpleList()}),n.on("records-change",()=>{var P,B;let g=s.value.find($=>$!=="divider"&&$.name==="cancel"),A=s.value.find($=>$!=="divider"&&$.name==="recover");g.disabled=n.historyRecords.length===0,A.disabled=n.futureRecords.length===0,l.value=((P=n.selectMark)==null?void 0:P.id)||"",c.value=((B=n.selectMark)==null?void 0:B.tagName)||"",f.value=n.getMarkItemSimpleList()}),window.addEventListener("keydown",o)}),Cl(()=>{n.destroy(),window.removeEventListener("keydown",o)});function u(g){if(g.disabled)return;let A=n.convertPointToCanvas({x:n.backgroundSize.width/2,y:n.backgroundSize.height/2});switch(g.name){case"reset":{n.resetZoomOrOffset();break}case"zoom_in":{n.setZoom(n.currentZoom+.1,A);break}case"zoom_out":{n.setZoom(n.currentZoom-.1,A);break}case"drag":{y("drag")&&(n.optStatus="drag");break}case"select":{y("select")&&n.setSelectMode();break}case"del":{a("delete");break}case"rect":{g.disabled||n.setDrawStatus("rect");break}case"polygon":{g.disabled||n.setDrawStatus("polygon");break}case"save":{v();break}case"cancel":{n.cancelRecords();break}case"recover":{n.recoverRecords();break}}}function y(g){return n.tipsErrorText?(a("error",n.tipsErrorText),!1):p.value?!1:(s.value.forEach(A=>{A!=="divider"&&(A.name==g?A.active=!0:A.active=!1)}),!0)}function v(){let g=n.toJsonData();a("save",g)}function C(g){l.value&&(p.value||n.setCurrentTag(g))}function m(g){let A=JSON.parse(JSON.stringify(g)),P=h.value.findIndex(B=>B.name===A.name);P!==-1&&(h.value[P]=A,n.updateTag(A))}function I(g){let A=JSON.parse(JSON.stringify(g));h.value.find(B=>B.name===A.name)||(h.value.push(A),n.appendTag(A))}function T(g){g.visible||g.visible===void 0?n.hideMark(g.id):n.showMark(g.id)}function L(g){g.visible?g.visible=0:g.visible=!0}function W(g){n.deleteMark(g.id)}function M(g){n.selectById(g.id)}return(g,A)=>(H(),tt("div",tg,[k("div",eg,[g.showToolsBar||g.showToolsBar===void 0?(H(),tt("div",ig,[k("div",{class:Qe(["btn-group",{move:r.value,draw:p.value}])},[dn(g.$slots,"tools",{draw:p.value,move:r.value,toolsList:s.value,itemClick:u},()=>[(H(!0),tt(ve,null,De(s.value,(P,B)=>(H(),tt(ve,{key:B},[P!=="divider"?un((H(),tt("div",{key:0,class:Qe(["btn-item",{disabled:P.disabled,active:P.active}]),type:P.name,title:P.title,onClick:$=>u(P)},[k("div",{class:Qe(["icon",{re:P.icon_re}]),innerHTML:P.icon},null,10,ng)],10,sg)),[[Pl,P.show]]):(H(),tt("div",rg))],64))),128))])],2)])):Xi("",!0),k("div",og,null,512)]),g.showSiderBar||g.showSiderBar===void 0?(H(),tt("div",ag,[k("div",hg,[dn(g.$slots,"category",{title:"检测标签",selectTag:C,appendTag:I,updateTag:m,tagList:h.value,currentSelectId:l.value,currentSelectTag:c.value,draw:p.value},()=>[A[0]||(A[0]=k("div",{class:"title"},[k("b",null,"检测标签")],-1)),k("div",{class:Qe(["list",{select:!!l.value,draw:p.value}])},[(H(!0),tt(ve,null,De(h.value,P=>(H(),tt("div",{class:"item",onClick:B=>C(P)},[k("div",cg,[k("div",{class:"select",innerHTML:c.value===P.name?ft(wt).select1:ft(wt).unselect},null,8,dg),k("div",{class:"color",style:Bl({backgroundColor:P.color})},[un(k("input",{type:"color","onUpdate:modelValue":B=>P.color=B,onChange:B=>m(P)},null,40,ug),[[io,P.color]])],4),k("kbd",null,we(P.name),1),un(k("input",{type:"text","onUpdate:modelValue":B=>P.label=B,onChange:B=>m(P)},null,40,fg),[[io,P.label]])]),P.shortcutKey?(H(),tt("div",_g," 快捷键 "+we(P.shortcutKey),1)):Xi("",!0)],8,lg))),256))],2)])]),k("div",pg,[dn(g.$slots,"markup",{title:"标注记录",selectId:l.value,toggleMark:T,selectMark:M,deleteMark:W,selectGroupMark:L,markItemList:f.value,markGroupItem:d.value},void 0)])])):Xi("",!0)]))}}),yg=_h(gg,[["__scopeId","data-v-f1cde443"]]),As="create-company";class mg{constructor(){x(this,"component");x(this,"vnode");x(this,"node");x(this,"props");this.component=Rl(()=>Ol(()=>import("./index-B_6PaG0t.js"),__vite__mapDeps([0,1,2,3,4,5]))),this.vnode=null,this.node=null,this.props={}}install(){if(!this.vnode){const t=J(this.component,this.props),e=document.createElement("div");El(t,e),this.vnode=t,this.node=e,document.body.appendChild(this.node)}}uninstall(){this.vnode&&setTimeout(()=>{this.node&&document.body.removeChild(this.node),this.vnode=null,this.node=null},300)}async show(){this.vnode||await new Promise(e=>{document.addEventListener(`${As}-popup-dialog-ready`,e,{once:!0}),this.install()});const t=new CustomEvent(`${As}-popup-dialog-show`,{detail:{show:!0}});return document.dispatchEvent(t),new Promise(e=>{const s=n=>{e(n.detail.text),this.uninstall(),document.removeEventListener(`${As}-popup-dialog-confirm`,s)};document.addEventListener(`${As}-popup-dialog-confirm`,s)})}}const xg=new mg,wg="/assets/plg-DqQ2JRPG.jpg",uh="/assets/plg1-QevxnFXY.jpg",vg={class:"content-box"},kg={class:"mark-header"},bg={class:"mark-header-half"},Tg={class:"mark-header-half"},Sg={class:"btn-link"},Cg={class:"mark-content"},Pg={class:"image-content"},Bg={class:"image-title"},Rg={style:{display:"flex"}},Eg={class:"image-btn"},Og={class:"image-btn"},Ig={class:"image-tab"},Mg=["onClick"],Ag={class:"image-filter"},Dg={class:"image-btn max-size"},Lg={class:"image-btn max-size"},Wg={class:"image-btn max-size"},zg={class:"image-list"},$g=["onClick"],Ug=["src"],Fg={class:"test-box"},Ng={class:"label-box"},Gg={class:"search-add"},Hg={class:"label-event-wrap"},jg=["onClick"],Vg={class:"label-event-flex"},Yg={class:"name"},Zg={class:"label-event-flex"},Kg={key:0,class:"short-cut"},Xg={class:"label-event-flex"},qg={class:"keyboard-popup"},Qg={class:"keyboard-list"},Jg={class:"keyboard-edit-operate"},t2=["onClick"],e2={class:"label-box"},i2={class:"label-event-wrap"},s2={class:"label-group-item-title"},n2={class:"label-group-item-flex"},r2={class:"name"},o2={class:"label-group-item-flex"},a2={key:0,class:"item-inner-wrap"},h2=["onClick"],l2={class:"name"},c2={class:"item-inner-flex"},d2={key:1,class:"loading-box"},u2={class:"modal-text"},f2=fh({__name:"index",setup(i){const t=zl(),e=()=>{t.go(-1)},[s,n]=Il.useMessage(),r=gt(0),o=[{id:1,name:"pig",label:"猪",color:"#FF7BA1",shortcutKey:"1"},{id:2,name:"egg",label:"鸡蛋",color:"#00C2B7",shortcutKey:"2"}],a=gt([{image_url:wg,marker_data:[{id:"11111",type:"rect",points:[{x:100,y:100},{x:400,y:100},{x:400,y:400},{x:100,y:400}],tag_name:"pig"},{id:"22222",type:"rect",points:[{x:200,y:200},{x:500,y:200},{x:500,y:500},{x:200,y:500}],tag_name:"egg"}]},{image_url:uh,marker_data:[]},{image_url:uh,marker_data:[]}]);var h=gt(!1);const l=async M=>{r.value===M||h.value||(r.value=M,h.value=!0,await new Promise(g=>setTimeout(g,1e3)),h.value=!1)};function c(M){console.error("标注组件错误:",M)}function p(M){console.log("保存数据:",M)}function f(){console.log("删除数据")}const d=gt("1"),u=gt([{key:"1",name:"未标注"},{key:"2",name:"已标注"},{key:"3",name:"待确认"}]);function y(){xg.show()}gt("1");const v=gt(["1","2","3","4","5","6","7","8","9","0"]),C=gt(!1),m=gt(!1),I=gt(),T=M=>{I.value=M,C.value=!0},L=()=>{m.value=!0,setTimeout(()=>{m.value=!1,C.value=!1,s.success("删除成功！")},2e3)},W=()=>{C.value=!1};return(M,g)=>{const A=Oe("a-input-search"),P=Oe("a-checkbox"),B=Oe("a-menu-item"),$=Oe("a-menu"),mt=Oe("a-dropdown"),Tt=Oe("a-spin"),$t=Oe("a-button"),re=Oe("a-modal");return H(),tt("div",vg,[k("div",kg,[k("div",bg,[J(ft(Ml),{class:"arrow-icon",onClick:e}),g[1]||(g[1]=k("div",{class:"name"},"测试训练集",-1)),g[2]||(g[2]=k("div",{class:"ver-box"},"V1",-1)),g[3]||(g[3]=k("div",{class:"btn-link primary",style:{"margin-left":"10px"}},"更多信息",-1))]),k("div",Tg,[k("div",Sg,[J(ft(Al)),g[4]||(g[4]=fn(" 标注帮助 "))])])]),k("div",Cg,[k("div",Pg,[k("div",Bg,[g[5]||(g[5]=k("p",null,"图片列表",-1)),k("div",Rg,[k("div",Eg,[J(ft(Dl),{class:"icon"})]),k("div",Og,[J(ft(Hl),{class:"icon"})])])]),k("div",Ig,[(H(!0),tt(ve,null,De(u.value,(rt,j)=>(H(),tt("div",{class:Qe(["image-tab-item",{active:rt.key===d.value}]),onClick:Dt=>d.value=rt.key,key:j},we(rt.name)+"(0) ",11,Mg))),128))]),k("div",Ag,[k("div",Dg,[J(ft(Ll),{class:"icon"})]),k("div",Lg,[J(ft(jl),{class:"icon"})]),k("div",Wg,[J(ft(Wl),{class:"icon"})])]),k("div",zg,[(H(!0),tt(ve,null,De(a.value,(rt,j)=>(H(),tt("div",{class:Qe(["image-item",{active:r.value===j}]),key:j,onClick:Dt=>l(j)},[k("img",{src:rt.image_url,alt:""},null,8,Ug)],10,$g))),128))])]),k("div",Fg,[ft(h)?(H(),tt("div",d2,[J(Tt,{size:"large"}),g[15]||(g[15]=k("p",null,"处理中...",-1))])):(H(),Di(yg,{key:0,"alg-type":"obj_detect",onError:c,onSave:p,onDelete:f,tags:o,image:a.value[r.value].image_url,"marker-data":a.value[r.value].marker_data},{category:Et(({selectTag:rt,updateTag:j,appendTag:Dt,tagList:Ee,currentSelectId:Lt,currentSelectTag:li,draw:_s})=>[k("div",Ng,[g[11]||(g[11]=k("div",{class:"label-title"},"检测标签",-1)),k("div",Gg,[J(A,{placeholder:"搜索图片名称",style:{width:"240px"}}),J(ft(Or),{class:"icon",onClick:y})]),k("div",Hg,[(H(!0),tt(ve,null,De(Ee,(St,hn)=>(H(),tt("div",{key:hn,onClick:Wt=>rt(St),class:"label-event-item"},[k("div",Vg,[g[6]||(g[6]=k("div",{class:"label-bar"},null,-1)),J(P),k("div",Yg,we(St.name),1)]),k("div",Zg,[St.shortcutKey?(H(),tt("span",Kg,"快捷键："+we(St.shortcutKey),1)):Xi("",!0),k("div",Xg,[J(mt,{trigger:["click"],arrow:!0},{overlay:Et(()=>[J($,{class:"keyboard-dropdown"},{default:Et(()=>[J(B,{key:"0"},{default:Et(()=>[k("div",qg,[g[7]||(g[7]=k("p",null,"快捷键",-1)),k("div",Qg,[(H(!0),tt(ve,null,De(v.value,(Wt,ln)=>(H(),tt("div",{class:"short-cut-box",key:ln},we(Wt),1))),128))]),g[8]||(g[8]=k("div",{class:"keyboard-confirm"},[k("button",{class:"confirm"},"确定"),k("button",null,"取消")],-1))])]),_:2},1024)]),_:2},1024)]),default:Et(()=>[g[9]||(g[9]=k("img",{src:Zl,class:"key-img",alt:""},null,-1))]),_:2},1024),J(mt,{trigger:["click"],arrow:!0},{overlay:Et(()=>[J($,{class:"keyboard-dropdown"},{default:Et(()=>[J(B,{key:"0"},{default:Et(()=>[k("div",Jg,[g[10]||(g[10]=k("div",{class:"keyboard-edit-operate-item"}," 编辑 ",-1)),k("div",{class:"keyboard-edit-operate-item",onClick:Wt=>T(St)}," 删除 ",8,t2)])]),_:2},1024)]),_:2},1024)]),default:Et(()=>[J(ft($l),{class:"icon"})]),_:2},1024)])])],8,jg))),128))])])]),markup:Et(({selectId:rt,toggleMark:j,selectMark:Dt,deleteMark:Ee,selectGroupMark:Lt,markItemList:li,markGroupItem:_s})=>[k("div",e2,[g[14]||(g[14]=k("div",{class:"label-title"},"标注记录",-1)),k("div",i2,[(H(!0),tt(ve,null,De(_s,(St,hn)=>(H(),tt("div",{class:"label-group-item",key:hn},[k("div",s2,[k("div",n2,[St.visible?(H(),Di(ft(Fl),{key:1,class:"icon",onClick:Wt=>Lt(St)},null,8,["onClick"])):(H(),Di(ft(Ul),{key:0,class:"icon",onClick:Wt=>Lt(St)},null,8,["onClick"])),g[12]||(g[12]=k("img",{src:Kl,alt:""},null,-1)),k("div",r2,we(St.tagName),1)]),k("div",o2,[J(ft(so),{class:"icon del-img",style:{"font-size":"15px"}}),g[13]||(g[13]=k("img",{src:Xl,alt:""},null,-1))])]),St.visible?(H(),tt("div",a2,[(H(!0),tt(ve,null,De(St.children,(Wt,ln)=>(H(),tt("div",{class:Qe(["item-inner",{innerSelect:rt===Wt.id}]),key:ln,onClick:cn=>Dt(Wt)},[k("div",l2,"目标ID："+we(Wt.id),1),k("div",c2,[J(ft(so),{class:"icon del-img",onClick:_n(cn=>Ee(Wt),["stop"])},null,8,["onClick"]),Wt.visible?(H(),Di(ft(Nl),{key:0,class:"icon",onClick:_n(cn=>j(Wt),["stop"])},null,8,["onClick"])):(H(),Di(ft(Gl),{key:1,class:"icon",onClick:_n(cn=>j(Wt),["stop"])},null,8,["onClick"]))])],10,h2))),128))])):Xi("",!0)]))),128))])])]),_:1},8,["image","marker-data"]))]),J(ft(n)),J(re,{open:C.value,"onUpdate:open":g[0]||(g[0]=rt=>C.value=rt),title:"提示",onOk:L},{footer:Et(()=>[J($t,{key:"back",onClick:W},{default:Et(()=>g[16]||(g[16]=[fn("取消")])),_:1}),J($t,{key:"submit",type:"primary",loading:m.value,onClick:L},{default:Et(()=>g[17]||(g[17]=[fn("确认")])),_:1},8,["loading"])]),default:Et(()=>{var rt;return[k("div",u2,"确定删除标签 "+we((rt=I.value)==null?void 0:rt.name)+" ?",1),g[18]||(g[18]=k("div",{class:"modal-desc"},"确定后，该标签下的已标注信息将同时被删除。",-1))]}),_:1},8,["open"])])])}}}),_2=_h(f2,[["__scopeId","data-v-c1e8ec18"]]),Z2=Object.freeze(Object.defineProperty({__proto__:null,default:_2},Symbol.toStringTag,{value:"Module"}));export{Z2 as a,wg as i};
