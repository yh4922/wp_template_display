import{s as k}from"./index-DpR8vo3Y.js";import{c as s,I as P,a as S,h as A,a1 as C,i as p,o as z,b as B,f as l,u as v,w as i,n as H,a2 as N,s as d,a3 as R,l as w,g as U}from"./index-eTN858IF.js";var q={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 464h-68V240c0-70.7-57.3-128-128-128H388c-70.7 0-128 57.3-128 128v224h-68c-17.7 0-32 14.3-32 32v384c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V496c0-17.7-14.3-32-32-32zM332 240c0-30.9 25.1-56 56-56h248c30.9 0 56 25.1 56 56v224H332V240zm460 600H232V536h560v304zM484 701v53c0 4.4 3.6 8 8 8h40c4.4 0 8-3.6 8-8v-53a48.01 48.01 0 10-56 0z"}}]},name:"lock",theme:"outlined"};function y(n){for(var t=1;t<arguments.length;t++){var o=arguments[t]!=null?Object(arguments[t]):{},c=Object.keys(o);typeof Object.getOwnPropertySymbols=="function"&&(c=c.concat(Object.getOwnPropertySymbols(o).filter(function(e){return Object.getOwnPropertyDescriptor(o,e).enumerable}))),c.forEach(function(e){E(n,e,o[e])})}return n}function E(n,t,o){return t in n?Object.defineProperty(n,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):n[t]=o,n}var _=function(t,o){var c=y({},t,o.attrs);return s(P,y({},c,{icon:q}),null)};_.displayName="LockOutlined";_.inheritAttrs=!1;function I(n){return k({url:"/api/v1/user/login",method:"post",data:n})}function T(){return k({url:"/api/v1/user/login-pwd-key",method:"get"})}const D={class:"content-box"},K={class:"login-card"},F={class:"login-form"},$=S({__name:"index",setup(n){const t=H(),[o,c]=A.useMessage(),e=C({username:"admin",password:"123456",password_key:"",remember:!0}),x=p(!1),g=p(),b=p(""),h=p("");async function O(){x.value||(await L(),g.value.validate().then(async()=>{let r=EncryptRSA(h.value,e.password),a={username:e.username,password_key:b.value,password:r};I(a).then(u=>{u&&u.code===0&&(N("token",u.data.token),o.success("登录成功！"),setTimeout(()=>{t.push({path:"/home"})},1e3))})}).catch(r=>{console.log("error",r)}))}async function L(){await T().then(r=>{r&&(r==null?void 0:r.code)===0&&(b.value=r.data.key,h.value=r.data.value)})}return(r,a)=>{const u=d("a-input"),f=d("a-form-item"),V=d("a-input-password"),j=d("a-checkbox"),M=d("a-form");return z(),B("div",D,[l("div",K,[s(v(c)),a[4]||(a[4]=l("div",{class:"login-title"},"CivicTank 开放训练平台",-1)),l("div",F,[s(M,{ref_key:"formRef",ref:g,model:e,name:"basic","label-col":{span:24},"wrapper-col":{span:24},autocomplete:"off"},{default:i(()=>[s(f,{name:"username",rules:[{required:!0,message:"请输入账户名/手机号"}]},{default:i(()=>[s(u,{value:e.username,"onUpdate:value":a[0]||(a[0]=m=>e.username=m),valueModifiers:{trim:!0},placeholder:"请输入账户名/手机号"},{prefix:i(()=>[s(v(R),{class:"site-form-item-icon"})]),_:1},8,["value"])]),_:1}),s(f,{style:{"margin-top":"30px"},name:"password",rules:[{required:!0,message:"请输入密码"}]},{default:i(()=>[s(V,{value:e.password,"onUpdate:value":a[1]||(a[1]=m=>e.password=m),valueModifiers:{trim:!0},placeholder:"请输入密码"},{prefix:i(()=>[s(v(_),{class:"site-form-item-icon"})]),_:1},8,["value"])]),_:1}),s(f,{name:"remember",style:{"margin-top":"40px"},"wrapper-col":{span:24},rules:[{required:!0,message:"请勾选协议"}]},{default:i(()=>[s(j,{checked:e.remember,"onUpdate:checked":a[2]||(a[2]=m=>e.remember=m)},{default:i(()=>a[3]||(a[3]=[w("我已阅读并遵守 "),l("span",null,"《隐私政策》",-1),w(" 和 "),l("span",null,"《服务协议》",-1)])),_:1},8,["checked"])]),_:1})]),_:1},8,["model"]),l("div",{class:"common-btn confirm",onClick:O},"登录")])])])}}}),Q=U($,[["__scopeId","data-v-bc6faa20"]]);export{Q as default};
